<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="mysql安装mysql1MySQL是一种关系数据库管理系统，关系数据库将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性. 由于MYSQL是一款开放源码软件,因此可以大大降低总体拥有成本.现在我们来介绍下MYSQL的SQL原生态语句 linux mysql数据库安装如何安装数据库123456先下载mysql将下载好的文件解压到指定文件将bin绝对路径放入系统">
<meta name="keywords" content="mysql">
<meta property="og:type" content="article">
<meta property="og:title" content="数据库笔记2">
<meta property="og:url" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/index.html">
<meta property="og:site_name" content="择墅居:李江洋">
<meta property="og:description" content="mysql安装mysql1MySQL是一种关系数据库管理系统，关系数据库将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性. 由于MYSQL是一款开放源码软件,因此可以大大降低总体拥有成本.现在我们来介绍下MYSQL的SQL原生态语句 linux mysql数据库安装如何安装数据库123456先下载mysql将下载好的文件解压到指定文件将bin绝对路径放入系统">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553158125334.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553158668557.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553158709865.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553158727305.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553158742067.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553158824495.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553158838749.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553158874771.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553159072394.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553159108805.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553159119304.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553161619658.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553161969018.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553162538854.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553162646852.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553161149276.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553162959359.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553163448508.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553163633944.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553163693858.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553163711210.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553163944717.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553163959431.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553163967151.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553164228333.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553165055967.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553165063303.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553164641671.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553165885606.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553165981228.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553166173976.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553166187928.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553166377983.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553166493892.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553166656249.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553166829738.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553172129044.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553172147156.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553172157453.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553172175393.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553172744768.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/877318-20170731215314052-428578611.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553228331508.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553189172349.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553189217089.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553176568981.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553190683630.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553191558675.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553192221910.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553192419145.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553224301567.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553224315213.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553241983517.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553229877558.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553238138427.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553238271498.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553239843193.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553240354720.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553240612030.png">
<meta property="og:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553240753508.png">
<meta property="og:image" content="https://images2015.cnblogs.com/blog/425762/201608/425762-20160803224643778-2071849037.png">
<meta property="og:updated_time" content="2025-04-08T14:38:20.226Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="数据库笔记2">
<meta name="twitter:description" content="mysql安装mysql1MySQL是一种关系数据库管理系统，关系数据库将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性. 由于MYSQL是一款开放源码软件,因此可以大大降低总体拥有成本.现在我们来介绍下MYSQL的SQL原生态语句 linux mysql数据库安装如何安装数据库123456先下载mysql将下载好的文件解压到指定文件将bin绝对路径放入系统">
<meta name="twitter:image" content="https://ljyabc.github.io/2019/03/19/数据库笔记2/1553158125334.png">






  <link rel="canonical" href="https://ljyabc.github.io/2019/03/19/数据库笔记2/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>数据库笔记2 | 择墅居:李江洋</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">择墅居:李江洋</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">争做长沙别墅豪装第一品牌</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-schedule">

    
    
    
      
    

    

    <a href="/schedule/" rel="section"><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>日程表</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-sitemap">

    
    
    
      
    

    

    <a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>站点地图</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-commonweal">

    
    
    
      
    

    

    <a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>公益 404</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-book">

    
    
    
      
    

    

    <a href="/book" rel="section"><i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>book</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://ljyabc.github.io/2019/03/19/数据库笔记2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李江洋">
      <meta itemprop="description" content="记录学习的技能和遇到的问题">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="择墅居:李江洋">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">数据库笔记2

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-03-19 17:28:43" itemprop="dateCreated datePublished" datetime="2019-03-19T17:28:43+08:00">2019-03-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2025-04-08 22:38:20" itemprop="dateModified" datetime="2025-04-08T22:38:20+08:00">2025-04-08</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据库/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/03/19/数据库笔记2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/03/19/数据库笔记2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="mysql安装"><a href="#mysql安装" class="headerlink" title="mysql安装"></a>mysql安装</h1><h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MySQL是一种关系数据库管理系统，关系数据库将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性. 由于MYSQL是一款开放源码软件,因此可以大大降低总体拥有成本.现在我们来介绍下MYSQL的SQL原生态语句</span><br></pre></td></tr></table></figure>
<h2 id="linux-mysql数据库安装"><a href="#linux-mysql数据库安装" class="headerlink" title="linux mysql数据库安装"></a>linux mysql数据库安装</h2><h3 id="如何安装数据库"><a href="#如何安装数据库" class="headerlink" title="如何安装数据库"></a>如何安装数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">先下载mysql</span><br><span class="line">将下载好的文件解压到指定文件</span><br><span class="line">将bin绝对路径放入系统环境变量中，并保存</span><br><span class="line">初始化mysql，mysqld --install添加到系统服务</span><br><span class="line">服务端：mysqld</span><br><span class="line">客户端：mysql -uroot -p（开始默认没有密码）-u 用户名  -p 密码  -h 服务器的ip  -P端口号   在本机上执行客户端不需要指的 -h -P</span><br></pre></td></tr></table></figure>
<h3 id="编译安装MySQL"><a href="#编译安装MySQL" class="headerlink" title="编译安装MySQL"></a>编译安装MySQL</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#cmake</span></span><br><span class="line"><span class="comment">#定制功能：存储引擎、字符集、压缩</span></span><br><span class="line"><span class="comment">#定制安装位置、数据存放位置、文件位置（socket）</span></span><br><span class="line"><span class="comment">#克隆一个模板机（使用CentOS6），克隆完做快照</span></span><br><span class="line"><span class="comment">#IP 10.0.0.52 主机名db02</span></span><br><span class="line"><span class="comment">#下载5.6.36包</span></span><br><span class="line">[root@db02 ~]<span class="comment"># wget -q https://mirrors.sohu.com/mysql/MySQL-5.6/mysql-5.6.36.tar.gz</span></span><br><span class="line"><span class="comment">#安装epel源</span></span><br><span class="line">[root@db02 ~]<span class="comment"># wget -O /etc/yum.repos.d/epel.repo https://mirrors.aliyun.com/repo/epel-6.repo</span></span><br><span class="line"><span class="comment">#安装依赖包</span></span><br><span class="line">[root@db02 ~]<span class="comment"># yum install -y ncurses-devel libaio-devel</span></span><br><span class="line"><span class="comment">#安装cmake</span></span><br><span class="line">[root@db02 ~]<span class="comment"># yum install -y cmake</span></span><br><span class="line"><span class="comment">#创建用户</span></span><br><span class="line">[root@db02 ~]<span class="comment"># useradd mysql -s /sbin/nologin -M</span></span><br><span class="line"><span class="comment">#修改hosts</span></span><br><span class="line">[root@db02 ~]<span class="comment"># vim /etc/hosts</span></span><br><span class="line">127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1 localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">172.16.1.52 db02</span><br><span class="line"><span class="comment">#解压MySQL源码包</span></span><br><span class="line">[root@db02 tools]<span class="comment"># tar xf mysql-5.6.36.tar.gz</span></span><br><span class="line"><span class="comment">#进入MySQL目录</span></span><br><span class="line">[root@db02 tools]<span class="comment"># cd mysql-5.6.36</span></span><br><span class="line"><span class="comment">#生成</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment">#</span></span><br><span class="line"><span class="comment">#程序存放位置</span></span><br><span class="line">cmake . -DCMAKE_INSTALL_PREFIX=/application/mysql-5.6.38 \</span><br><span class="line"><span class="comment">#数据存放位置</span></span><br><span class="line">-DMYSQL_DATADIR=/application/mysql-5.6.38/data \</span><br><span class="line"><span class="comment">#socket文件存放位置</span></span><br><span class="line">-DMYSQL_UNIX_ADDR=/application/mysql-5.6.38/tmp/mysql.sock \</span><br><span class="line"><span class="comment">#使用utf8字符集</span></span><br><span class="line">-DDEFAULT_CHARSET=utf8 \</span><br><span class="line"><span class="comment">#校验规则</span></span><br><span class="line">-DDEFAULT_COLLATION=utf8_general_ci \</span><br><span class="line"><span class="comment">#使用其他额外的字符集</span></span><br><span class="line">-DWITH_EXTRA_CHARSETS=all \</span><br><span class="line"><span class="comment">#支持的存储引擎</span></span><br><span class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_FEDERATED_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \</span><br><span class="line"><span class="comment">#禁用的存储引擎</span></span><br><span class="line">-DWITHOUT_EXAMPLE_STORAGE_ENGINE=1 \</span><br><span class="line"><span class="comment">#启用zlib库支持（zib、gzib相关）</span></span><br><span class="line">-DWITH_ZLIB=bundled \</span><br><span class="line"><span class="comment">#启用SSL库支持（安全套接层）</span></span><br><span class="line">-DWITH_SSL=bundled \</span><br><span class="line"><span class="comment">#启用本地数据导入支持</span></span><br><span class="line">-DENABLED_LOCAL_INFILE=1 \</span><br><span class="line"><span class="comment">#编译嵌入式服务器支持</span></span><br><span class="line">-DWITH_EMBEDDED_SERVER=1 \</span><br><span class="line"><span class="comment"># mysql5.6支持了google的c++mock框架了，允许下载，否则会安装报错。</span></span><br><span class="line">-DENABLE_DOWNLOADS=1 \</span><br><span class="line"><span class="comment">#禁用debug（默认为禁用）</span></span><br><span class="line">-DWITH_DEBUG=0</span><br><span class="line"><span class="comment">#编译</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># make</span></span><br><span class="line"><span class="comment">#安装</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># make install</span></span><br><span class="line"><span class="comment">#做软链接</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># ln -s /application/mysql-5.6.38/ /application/mysql</span></span><br><span class="line"><span class="comment">#拷贝配置文件</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># cp support-files/my*.cnf /etc/my.cnf</span></span><br><span class="line"><span class="comment">#拷贝mysql启动脚本</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># cp support-files/mysql.server /etc/init.d/mysqld</span></span><br><span class="line"><span class="comment">#进入MySQL初始化脚本目录</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># cd /application/mysql/scripts/</span></span><br><span class="line"><span class="comment">#初始化MySQL</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># ./mysql_install_db --basedir=/application/mysql/ --datadir=/application/mysql/data --user=mysql</span></span><br><span class="line"><span class="comment">#授权</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># chown -R mysql.mysql /application/mysql/</span></span><br><span class="line"><span class="comment">#给启动脚本授权700</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># chmod 700 /etc/init.d/mysqld</span></span><br><span class="line"><span class="comment">#systemd管理mysql启动</span></span><br><span class="line">[root@db02 mysql-5.6.36]<span class="comment"># vim /usr/lib/systemd/system/mysqld.service</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=MySQL Server</span><br><span class="line">Documentation=man:mysqld(8)</span><br><span class="line">Documentation=https://dev.mysql.com/doc/refman/en/using-systemd.html</span><br><span class="line">After=network.target</span><br><span class="line">After=syslog.target</span><br><span class="line">[<span class="keyword">Install</span>]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">[Service]</span><br><span class="line"><span class="keyword">User</span>=mysql</span><br><span class="line"><span class="keyword">Group</span>=mysql</span><br><span class="line">ExecStart=/usr/<span class="keyword">local</span>/mysql/<span class="keyword">bin</span>/mysqld <span class="comment">--defaults-file=/etc/my.cnf</span></span><br><span class="line">LimitNOFILE = <span class="number">5000</span></span><br><span class="line"><span class="comment">#设置开机自启动C6</span></span><br><span class="line">[root@db02 mysql<span class="number">-5.6</span><span class="number">.36</span>]<span class="comment"># chkconfig mysqld on</span></span><br><span class="line"><span class="comment">#设置开机自启动C7</span></span><br><span class="line">[root@db02 mysql<span class="number">-5.6</span><span class="number">.36</span>]<span class="comment"># systemctl enable mysqld</span></span><br><span class="line"><span class="comment">#启动MySQLC6</span></span><br><span class="line">[root@db02 mysql<span class="number">-5.6</span><span class="number">.36</span>]<span class="comment"># /etc/init.d/mysqld start</span></span><br><span class="line"><span class="comment">#启动MySQLC7</span></span><br><span class="line">[root@db02 mysql<span class="number">-5.6</span><span class="number">.36</span>]<span class="comment"># systemctl start mysqld</span></span><br><span class="line"><span class="comment">#创建tmp目录（5.6.36版本不会自动创建tmp目录）</span></span><br><span class="line">[root@db02 mysql<span class="number">-5.6</span><span class="number">.36</span>]<span class="comment"># mkdir /application/mysql-5.6.36/tmp</span></span><br><span class="line"><span class="comment">#添加环境变量</span></span><br><span class="line">[root@db02 ~]<span class="comment"># echo 'PATH=/application/mysql/bin/:$PATH' &gt;&gt;/etc/profile</span></span><br><span class="line"><span class="comment">#个人推荐</span></span><br><span class="line">[root@db02 ~]<span class="comment"># echo 'PATH=/application/mysql/bin/:$PATH' &gt;/etc/profile.d/mysql.sh</span></span><br><span class="line">[root@db02 ~]<span class="comment"># source /etc/profile.d/mysql.sh</span></span><br><span class="line"><span class="comment">#设置MySQL密码</span></span><br><span class="line">[root@db02 ~]<span class="comment"># mysqladmin -uroot password 'oldboy123'</span></span><br><span class="line"><span class="comment">#MySQL登陆</span></span><br><span class="line">[root@db02 ~]<span class="comment"># mysql -uuser -ppassword -Ssocket -hhost</span></span><br><span class="line"><span class="comment">#MySQL基本操作及基本优化</span></span><br><span class="line"><span class="comment">#查看库</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="comment">#删库</span></span><br><span class="line">mysql&gt; drop database test;</span><br><span class="line"><span class="comment">#使用库</span></span><br><span class="line">mysql&gt; use mysql</span><br><span class="line"><span class="comment">#查看表</span></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line"><span class="comment">#查看当前所在库</span></span><br><span class="line">mysql&gt; select database();</span><br><span class="line"><span class="comment">#查看mysql用户</span></span><br><span class="line">mysql&gt; select user,host from user;</span><br><span class="line">mysql&gt; select user,host,password from user;</span><br><span class="line"><span class="comment">#删除用户</span></span><br><span class="line">mysql&gt; select user,host from user;</span><br><span class="line">mysql&gt; drop user ''@'db02';</span><br><span class="line">mysql&gt; drop user root@db02;</span><br><span class="line">mysql&gt; drop user root@'::1';</span><br><span class="line">mysql&gt; drop user root@'127.0.0.1';</span><br></pre></td></tr></table></figure>
<h3 id="MySQL二进制安装"><a href="#MySQL二进制安装" class="headerlink" title="MySQL二进制安装"></a>MySQL二进制安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">1.解压安装包</span><br><span class="line">[root@db02 ~]# tar xf mysql-5.6.40-linux-glibc2.12-x86_64.tar.gz </span><br><span class="line"></span><br><span class="line">2.创建MySQL安装目录</span><br><span class="line">[root@db02 ~]# mkdir /application</span><br><span class="line"></span><br><span class="line">3.移动MySQL程序到安装目录下并改名</span><br><span class="line">[root@db02 ~]# mv mysql-5.6.40-linux-glibc2.12-x86_64 /application/mysql-5.6.40</span><br><span class="line"></span><br><span class="line">4.做软连接</span><br><span class="line">[root@db02 ~]# ln -s /application/mysql-5.6.40 /application/mysql</span><br><span class="line"></span><br><span class="line">5.进入其他文件目录</span><br><span class="line">[root@db02 ~]# cd /application/mysql/support-files</span><br><span class="line"></span><br><span class="line">6.拷贝配置文件</span><br><span class="line">[root@db02 support-files]# cp my-default.cnf /etc/my.cnf		##覆盖</span><br><span class="line"></span><br><span class="line">7.拷贝启动脚本</span><br><span class="line">[root@db02 support-files]# cp mysql.server /etc/init.d/mysqld</span><br><span class="line"></span><br><span class="line">8.进入初始化目录</span><br><span class="line">[root@db02 support-files]# cd ../scripts/</span><br><span class="line"></span><br><span class="line">9.创建MySQL用户</span><br><span class="line">[root@db02 scripts]# useradd mysql -s /sbin/nologin -M</span><br><span class="line"></span><br><span class="line">10.安装初始化依赖包</span><br><span class="line">[root@db02 scripts]# yum install -y autoconf libaio-devel</span><br><span class="line"></span><br><span class="line">11.初始化</span><br><span class="line">[root@db02 scripts]# ./mysql_install_db --user=mysql --basedir=/application/mysql --datadir=/application/mysql/data</span><br><span class="line"></span><br><span class="line">12.修改文件路径</span><br><span class="line">[root@db02 scripts]# sed -i &apos;s#/usr/local#/application#g&apos; /etc/init.d/mysqld /application/mysql/bin/mysqld_safe</span><br><span class="line"></span><br><span class="line">13.启动MySQL</span><br><span class="line">[root@db02 scripts]# /etc/init.d/mysqld start</span><br><span class="line"></span><br><span class="line">14.添加环境变量</span><br><span class="line">[root@db02 scripts]# vim /etc/profile.d/mysql.sh</span><br><span class="line">export PATH=&quot;/application/mysql/bin:$PATH&quot;</span><br><span class="line"></span><br><span class="line">15.给root用户设置密码</span><br><span class="line">[root@db02 scripts]# mysqladmin -uroot -p password &apos;123&apos;</span><br><span class="line"></span><br><span class="line">16.连接MySQL</span><br><span class="line">[root@db01 ~]# mysql -uroot -p123</span><br><span class="line"></span><br><span class="line">17.查看MySQL中所有用户</span><br><span class="line">mysql&gt; select user,host from mysql.user;</span><br><span class="line"></span><br><span class="line">18.删除用户</span><br><span class="line">mysql&gt; drop user root@&apos;db01&apos;;</span><br><span class="line">mysql&gt; drop user root@&apos;::1&apos;;</span><br><span class="line">mysql&gt; drop user &apos;&apos;@&apos;db01&apos;;</span><br><span class="line">mysql&gt; drop user &apos;&apos;@&apos;localhost&apos;;</span><br><span class="line">mysql&gt; drop user root@&apos;localhost&apos;;</span><br><span class="line">mysql&gt; drop user root@&apos;127.0.0.1&apos;;</span><br></pre></td></tr></table></figure>
<h3 id="使用systemd管理MySQL"><a href="#使用systemd管理MySQL" class="headerlink" title="使用systemd管理MySQL"></a>使用systemd管理MySQL</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">使用systemd管理MySQL</span><br><span class="line">[root@db01 ~]# vim /usr/lib/systemd/system/mysqld.service</span><br><span class="line">[Unit]</span><br><span class="line">Description=MySQL Server</span><br><span class="line">Documentation=man:mysqld(8)</span><br><span class="line">Documentation=https://dev.mysql.com/doc/refman/en/using-systemd.html</span><br><span class="line">After=network.target</span><br><span class="line">After=syslog.target</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">[Service]</span><br><span class="line">User=mysql</span><br><span class="line">Group=mysql</span><br><span class="line">ExecStart=/application/mysql/bin/mysqld --defaults-file=/etc/my.cnf</span><br><span class="line">LimitNOFILE = 5000</span><br><span class="line"></span><br><span class="line">[root@db01 ~]# /etc/init.d/mysqld stop</span><br><span class="line">Shutting down MySQL.. SUCCESS! </span><br><span class="line">[root@db01 ~]# systemctl start mysqld</span><br><span class="line"></span><br><span class="line">[root@db01 ~]# systemctl enable mysqld</span><br><span class="line"></span><br><span class="line">[root@db01 ~]# vim /etc/my.cnf</span><br><span class="line">basedir = /application/mysql</span><br><span class="line">datadir = /application/mysql/data</span><br></pre></td></tr></table></figure>
<h3 id="给root用户设置密码"><a href="#给root用户设置密码" class="headerlink" title="给root用户设置密码"></a>给root用户设置密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">###给root用户设置密码</span><br><span class="line">[root@db02 scripts]# mysqladmin -uroot -p password &apos;123&apos;</span><br><span class="line"></span><br><span class="line">###连接MySQL</span><br><span class="line">[root@db02 scripts]# mysql -uroot -p123</span><br><span class="line"></span><br><span class="line">###查看MySQL中用户</span><br><span class="line">mysql&gt; select user,host from mysql.user;</span><br><span class="line"></span><br><span class="line">###删除用户</span><br><span class="line">mysql&gt; drop user root@&apos;db01&apos;;</span><br><span class="line">mysql&gt; drop user root@&apos;::1&apos;;</span><br><span class="line"></span><br><span class="line">mysql&gt; drop user &apos;&apos;@&apos;db01&apos;;</span><br><span class="line">msyql&gt; drop user &apos;&apos;@&apos;localhost&apos;;</span><br></pre></td></tr></table></figure>
<h3 id="01-误删除root用户解决方法"><a href="#01-误删除root用户解决方法" class="headerlink" title="01.误删除root用户解决方法"></a>01.误删除root用户解决方法</h3><p>​    方法一：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">1.停止数据库</span><br><span class="line">[root@db02 scripts]# /etc/init.d/mysqld stop</span><br><span class="line"></span><br><span class="line">2.跳过授权表，跳过网络启动数据库</span><br><span class="line">[root@db02 scripts]# mysqld_safe --skip-grant-tables --skip-networking &amp;</span><br><span class="line"></span><br><span class="line">3.连接数据库</span><br><span class="line">[root@db02 scripts]# mysql</span><br><span class="line"></span><br><span class="line">4.插入新root用户</span><br><span class="line">insert into mysql.user values (&apos;localhost&apos;,&apos;root&apos;,PASSWORD(&apos;123&apos;),</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;Y&apos;,</span><br><span class="line">&apos;&apos;,</span><br><span class="line">&apos;&apos;,</span><br><span class="line">&apos;&apos;,</span><br><span class="line">&apos;&apos;,0,0,0,0,&apos;mysql_native_password&apos;,&apos;&apos;,&apos;N&apos;);</span><br><span class="line"></span><br><span class="line">5.重启MySQL</span><br><span class="line">[root@db01 ~]# mysqladmin shutdown </span><br><span class="line">[root@db01 ~]# /etc/init.d/mysqld start</span><br></pre></td></tr></table></figure>
<p>​    方法二：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1.停止数据库</span><br><span class="line">[root@db02 ~]# /etc/init.d/mysqld stop</span><br><span class="line"></span><br><span class="line">2.跳过授权表，跳过网络启动数据库</span><br><span class="line">[root@db02 ~]# mysql_safe --skip-grant-tables --skip-networking &amp;</span><br><span class="line"></span><br><span class="line">3.连接数据库</span><br><span class="line">[root@db02 ~]# mysql</span><br><span class="line"></span><br><span class="line">4.刷新授权表</span><br><span class="line">mysql&gt; flush pribileges;</span><br><span class="line"></span><br><span class="line">5.创建root超级用户</span><br><span class="line">mysql&gt; grant all on *.* to root@&apos;localhost&apos; identfied by &apos;123&apos; with grant option;</span><br></pre></td></tr></table></figure>
<h3 id="02-客户端与服务器模型"><a href="#02-客户端与服务器模型" class="headerlink" title="02.客户端与服务器模型"></a>02.客户端与服务器模型</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1.mysql是一个典型的C/S服务结构</span><br><span class="line">	mysql自带的客户端程序(/application/mysql/bin)</span><br><span class="line">		mysql</span><br><span class="line">		mysqladmin</span><br><span class="line">		mysqldump</span><br><span class="line">		</span><br><span class="line">2.mysqld是一个二进制程序，后台的守护进程</span><br><span class="line">		单进程</span><br><span class="line">		多线程</span><br><span class="line"></span><br><span class="line">3.应用程序连接MySQL的方式</span><br><span class="line">	a.TCP/IP连接</span><br><span class="line">		mysql -uroot -p123 -h127.0.0.1（TCP/IP）</span><br><span class="line">		1）并不是所有的-h都是TCP/IP连接</span><br><span class="line">		2）所有的远程连接都是TCP/IP连接</span><br><span class="line">	b.socket连接</span><br><span class="line">		mysql -uroot -p123 -s /tmp/mysql.sock</span><br><span class="line">		mysql -uroot -p123</span><br><span class="line">		mysql -uroot -p123 -hlocalhost</span><br><span class="line">		1）MySQL默认连接方式是socket连接</span><br><span class="line">		2）socket连接速度快，因为不需要建立三次握手</span><br></pre></td></tr></table></figure>
<h3 id="03-MySQL服务器构成"><a href="#03-MySQL服务器构成" class="headerlink" title="03.MySQL服务器构成"></a>03.MySQL服务器构成</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">什么是实例</span><br><span class="line">	1.MySQL的后台进程+线程+与分配的内存结构</span><br><span class="line">	2.MySQL在启动的过程中会启动后台守护进程，并生成工作线程，与分配内存结构供MySQL处理数据使用</span><br><span class="line">	</span><br><span class="line">mysqld服务器程序结构</span><br><span class="line">	1.连接层做的：</span><br><span class="line">		a.验证用户的合法性(ip,端口,用户名,密码)</span><br><span class="line">		b.提供两种连接方式(socket,TCP/IP)</span><br><span class="line">		c.提供一个与SQL层交互的专用线程</span><br><span class="line">	</span><br><span class="line">	2.SQL层做的：</span><br><span class="line">		a.接收连接层传来的SQL语句</span><br><span class="line">		b.检查语法</span><br><span class="line">		c.检查语义。（DDL，DML）DQL，DCL</span><br><span class="line">		  检查：show，select，grant</span><br><span class="line">		d.解释器，解析SQL语句，生成多种执行计划</span><br><span class="line">		e.优化器，根据多种执行计划，选择最优方式</span><br><span class="line">		f.执行器，执行优化器传来的最优方式SQL</span><br><span class="line">			提供跟存储引擎层交互的线程</span><br><span class="line">			接收返回数据，优化成表的形式返回SQL</span><br><span class="line">		g.将数据存入缓存</span><br><span class="line">		h.记录日志，binlog</span><br><span class="line">	</span><br><span class="line">	3.存储引擎层做的：</span><br><span class="line">		a.接收SQL层传来的SQL语句</span><br><span class="line">		b.去磁盘找到要找的数据</span><br><span class="line">		c.提供一个与SQL交互的线程，返回SQL层，结构化成表的形式</span><br></pre></td></tr></table></figure>
<h3 id="04-MySQL的结构"><a href="#04-MySQL的结构" class="headerlink" title="04.MySQL的结构"></a>04.MySQL的结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">	1.库</span><br><span class="line">	2.表：元数据+真实数据行</span><br><span class="line">	3.元数据：列+其它属性（行数+占用空间大小+权限）</span><br><span class="line">	4.列：列名字+数据类型+其他约束（非空、唯一、主键、非负数、自增长、默认值）</span><br><span class="line">	</span><br><span class="line">MySQL逻辑结构与Linux系统对比</span><br><span class="line">MySQL						 Linux</span><br><span class="line">库							目录</span><br><span class="line">show databases;				 ls -l /</span><br><span class="line">use mysql					 cd /mysql</span><br><span class="line">表							文件</span><br><span class="line">show tables;				 ls</span><br><span class="line">二维表=元数据+真实数据行		  文件=文件名+文件属性</span><br></pre></td></tr></table></figure>
<h2 id="windows-mysql数据库安装"><a href="#windows-mysql数据库安装" class="headerlink" title="windows mysql数据库安装"></a>windows mysql数据库安装</h2><h3 id="直接解压"><a href="#直接解压" class="headerlink" title="直接解压"></a>直接解压</h3><h2 id="在本地设置MYSQL账号"><a href="#在本地设置MYSQL账号" class="headerlink" title="在本地设置MYSQL账号"></a>在本地设置MYSQL账号</h2><h3 id="创建my-ini文件"><a href="#创建my-ini文件" class="headerlink" title="创建my.ini文件"></a>创建my.ini文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">character-set-server=utf8 #库的编码模式设置为utf8</span><br><span class="line">collation-server=utf8_general_ci</span><br><span class="line">[client]</span><br><span class="line">default-character-set=utf8</span><br><span class="line">user=root # 账号名为root</span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8 # 每创建一个库,默认的编码为utf8</span><br><span class="line">将MYSQL安装的目标文件添加到环境变量中,在CMD中直接操作MYSQL数据库.打开MYSQL时无需输入账号密码,默认从配置文件my.ini中读取</span><br></pre></td></tr></table></figure>
<h2 id="将模式设置为严格模式"><a href="#将模式设置为严格模式" class="headerlink" title="将模式设置为严格模式"></a>将模式设置为严格模式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set global sql_mode= &quot;strict_trans_tables,only_full_group_by&quot;; #修改为严格模式,只能查看到分组后的字段,配合聚合函数.其余操作会报错</span><br><span class="line">例如:</span><br><span class="line">select * from emo group by post;  #会报错,原因是分组之后在去查看某一条数据毫无意义</span><br><span class="line">强调: 模式设置为严格模式需要重新启动MYSQL</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps：修改sql_mode为严格模式，必须重启客户端才能生效</span><br><span class="line">    set global sql_mode=&quot;strict_trans_tables&quot;;</span><br><span class="line">    select @@sql_mode;</span><br></pre></td></tr></table></figure>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p><img src="/2019/03/19/数据库笔记2/1553158125334.png" alt="1553158125334"></p>
<h2 id="将MYSQL设置为后台自动运行"><a href="#将MYSQL设置为后台自动运行" class="headerlink" title="将MYSQL设置为后台自动运行"></a>将MYSQL设置为后台自动运行</h2><p><img src="/2019/03/19/数据库笔记2/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="img"> </p>
<h2 id="数据库服务器中存放的是"><a href="#数据库服务器中存放的是" class="headerlink" title="数据库服务器中存放的是"></a>数据库服务器中存放的是</h2><p> 库(文件加) 表(文件) 表里面是记录(一行数据)</p>
<h2 id="破解mysql密码-跳过配置文件"><a href="#破解mysql密码-跳过配置文件" class="headerlink" title="破解mysql密码,跳过配置文件"></a>破解mysql密码,跳过配置文件</h2>

	<div class="row">
    <embed src="开启mysqld.pdf" width="100%" height="550" type="application/pdf">
	</div>



<h3 id="1-关闭mysql"><a href="#1-关闭mysql" class="headerlink" title="1 关闭mysql"></a>1 关闭mysql</h3><p><img src="/2019/03/19/数据库笔记2/1553158668557.png" alt="1553158668557"></p>
<h3 id="2-重新启动"><a href="#2-重新启动" class="headerlink" title="2 重新启动"></a>2 重新启动</h3><p><img src="/2019/03/19/数据库笔记2/1553158709865.png" alt="1553158709865"></p>
<h3 id="3-输入命令"><a href="#3-输入命令" class="headerlink" title="3 输入命令"></a>3 输入命令</h3><p><img src="/2019/03/19/数据库笔记2/1553158727305.png" alt="1553158727305">    </p>
<h3 id="4-关闭MySQL-正常启动"><a href="#4-关闭MySQL-正常启动" class="headerlink" title="4 关闭MySQL,正常启动"></a>4 关闭MySQL,正常启动</h3><p><img src="/2019/03/19/数据库笔记2/1553158742067.png" alt="1553158742067">    </p>
<h2 id="账号的创建-了解知识点"><a href="#账号的创建-了解知识点" class="headerlink" title="账号的创建(了解知识点)"></a>账号的创建(了解知识点)</h2><h3 id="跟权限有关的几张表"><a href="#跟权限有关的几张表" class="headerlink" title="跟权限有关的几张表"></a>跟权限有关的几张表</h3><p>user,db,table_priv,columns_priv</p>
<h3 id="只创建账号"><a href="#只创建账号" class="headerlink" title="只创建账号"></a>只创建账号</h3><p><img src="/2019/03/19/数据库笔记2/1553158824495.png" alt="1553158824495"></p>
<h3 id="创建账号并且授权（只有root账号才能为其他账号授权grant）"><a href="#创建账号并且授权（只有root账号才能为其他账号授权grant）" class="headerlink" title="创建账号并且授权（只有root账号才能为其他账号授权grant）"></a>创建账号并且授权（只有root账号才能为其他账号授权grant）</h3><p><img src="/2019/03/19/数据库笔记2/1553158838749.png" alt="1553158838749"></p>
<h3 id="删除账号"><a href="#删除账号" class="headerlink" title="删除账号"></a>删除账号</h3><p><img src="/2019/03/19/数据库笔记2/1553158874771.png" alt="1553158874771">    </p>
<h1 id="MYSQL原生态SQL语句"><a href="#MYSQL原生态SQL语句" class="headerlink" title="MYSQL原生态SQL语句"></a>MYSQL原生态SQL语句</h1><h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><p>commnt</p>
<h6 id="SQL语句规范第一条"><a href="#SQL语句规范第一条" class="headerlink" title="SQL语句规范第一条:"></a>SQL语句规范第一条:</h6><blockquote>
<p>CREATE DATABASE oldboy CHARSET utf8mb4;</p>
</blockquote>
<p>1.关键字大写(非必须),字面量小写(必须)</p>
<p>2.库名字,只能是小写,不能有数字开头,不能是预留关键字</p>
<p>3.库名字必须和业务名有关,例如his_user;</p>
<p>4.必须加字符集.</p>
<p>​    表<br>    CREATE TABLE<br>    DROP   TABLE<br>    ALTER  TABLE</p>
<blockquote>
<p>CREATE TABLE t1 (<br>id  INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT ‘用户ID’,<br>sname  VARCHAR(20) NOT NULL COMMENT ‘用户姓名’,<br>gender ENUM(‘f’,’m’,’u’) NOT NULL DEFAULT ‘u’ COMMENT ‘用户性别’,<br>telnum CHAR(11) NOT NULL UNIQUE COMMENT ‘手机号’,<br>tmdate DATETIME NOT NULL DEFAULT NOW() COMMENT ‘录入时间’<br>)ENGINE INNODB CHARSET utf8mb4;</p>
</blockquote>
<p>DDL数据定义语言(创建)   DCL数据控制语言    DML数据操作语言(增,删,改)     DQL数据查询</p>
<h2 id="库-create-drop-alter-show"><a href="#库-create-drop-alter-show" class="headerlink" title="库(create/drop/alter/show)"></a>库(create/drop/alter/show)</h2><p>就是一个文件夹</p>
<h3 id="创建规则"><a href="#创建规则" class="headerlink" title="创建规则"></a>创建规则</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">可以由字母、数字、下划线、＠、＃、＄</span><br><span class="line">区分大小写</span><br><span class="line">唯一性</span><br><span class="line">不能使用关键字如 create select</span><br><span class="line">不能单独使用数字</span><br><span class="line">最长128位</span><br></pre></td></tr></table></figure>
<h3 id="增"><a href="#增" class="headerlink" title="增"></a>增</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create database 数据库名字 charset 编码格式（不需要加引号）;</span><br><span class="line">实例：</span><br><span class="line">mysql&gt; create database zhang charset utf8;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553159072394.png" alt="1553159072394"></p>
<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">删：</span><br><span class="line">drop database 数据库名;</span><br><span class="line">实例：</span><br><span class="line">mysql&gt; drop database vv;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553159108805.png" alt="1553159108805"></p>
<h3 id="改"><a href="#改" class="headerlink" title="改"></a>改</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">改：</span><br><span class="line">alter database 需要修改的数据库名字 charset 字符编码;</span><br><span class="line">实例：</span><br><span class="line">mysql&gt; alter database zhang charset utf8;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553159119304.png" alt="1553159119304"></p>
<h3 id="查"><a href="#查" class="headerlink" title="查"></a>查</h3><h4 id="查所有库"><a href="#查所有库" class="headerlink" title="查所有库"></a>查所有库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">show datebases; </span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; show databases;</span><br><span class="line">		+--------------------+</span><br><span class="line">		| Database           |</span><br><span class="line">		+--------------------+</span><br><span class="line">		| information_schema |</span><br><span class="line">		| mysql              |</span><br><span class="line">		| performance_schema |</span><br><span class="line">		| test               |</span><br><span class="line">		| zhang              |</span><br><span class="line">		+--------------------+</span><br><span class="line">		5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h4 id="查已经创建的库"><a href="#查已经创建的库" class="headerlink" title="查已经创建的库"></a>查已经创建的库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">show create database 创建的数据库名字;</span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; show create database zhang;</span><br><span class="line">		+----------+---------------------------------------------------------------+</span><br><span class="line">		| Database | Create Database                                               |</span><br><span class="line">		+----------+---------------------------------------------------------------+</span><br><span class="line">		| zhang    | CREATE DATABASE `zhang` /*!40100 DEFAULT CHARACTER SET gbk */ |</span><br><span class="line">		+----------+---------------------------------------------------------------+</span><br><span class="line">		1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h2 id="表的操作首先要选择库文件"><a href="#表的操作首先要选择库文件" class="headerlink" title="表的操作首先要选择库文件"></a>表的操作首先要选择库文件</h2><h6 id="进入库中"><a href="#进入库中" class="headerlink" title="进入库中"></a>进入库中</h6><p>选择当前所在的库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use db1;</span><br><span class="line"></span><br><span class="line">select database(); 选择当前所在的库</span><br></pre></td></tr></table></figure>
<h2 id="表-create-drop-truncate-alter-show-desc"><a href="#表-create-drop-truncate-alter-show-desc" class="headerlink" title="表(create/drop;truncate/alter/show;desc)"></a>表(create/drop;truncate/alter/show;desc)</h2><h3 id="增："><a href="#增：" class="headerlink" title="增："></a>增：</h3><h4 id="不需要切换"><a href="#不需要切换" class="headerlink" title="不需要切换"></a>不需要切换</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">creat table db1.t1(id int,name char);</span><br></pre></td></tr></table></figure>
<h4 id="需要切换use"><a href="#需要切换use" class="headerlink" title="需要切换use"></a>需要切换use</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table 表名（attr1 type,attr2 type......）;</span><br><span class="line">实例：</span><br><span class="line">mysql&gt; use zhang</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; create table f1(id int(11),name char(4));</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553161619658.png" alt="1553161619658"></p>
<h3 id="删：-彻底"><a href="#删：-彻底" class="headerlink" title="删：(彻底)"></a>删：(彻底)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">drop table 表名;</span><br><span class="line">实例：</span><br><span class="line">mysql&gt; drop table f2;</span><br></pre></td></tr></table></figure>
<h3 id="删-注意：只是清空表内内容，表结构还在"><a href="#删-注意：只是清空表内内容，表结构还在" class="headerlink" title="删:( 注意：只是清空表内内容，表结构还在)"></a>删:( 注意：只是清空表内内容，表结构还在)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">truncate table 表名; </span><br><span class="line">实例：</span><br><span class="line">mysql&gt; truncate table f2;</span><br></pre></td></tr></table></figure>
<p>清空表的时候应该用truncate，不会保留id字段</p>
<h3 id="改："><a href="#改：" class="headerlink" title="改："></a>改：</h3><h4 id="1-添加属性-字段"><a href="#1-添加属性-字段" class="headerlink" title="1.添加属性(字段)"></a>1.添加属性(字段)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add 属性 类型;  </span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; alter table f1 add sex char(11);</span><br></pre></td></tr></table></figure>
<h4 id="2-删除属性-字段"><a href="#2-删除属性-字段" class="headerlink" title="2.删除属性(字段)"></a>2.删除属性(字段)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop 属性;     </span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; alter table f1 drop age;</span><br></pre></td></tr></table></figure>
<h4 id="3-改表属性的数据类型-字段"><a href="#3-改表属性的数据类型-字段" class="headerlink" title="3.改表属性的数据类型(字段)"></a>3.改表属性的数据类型(字段)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify addr 新类型; </span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; alter table f1 modify name char(5);</span><br></pre></td></tr></table></figure>
<h4 id="4-覆盖修改表中的某个属性-字段"><a href="#4-覆盖修改表中的某个属性-字段" class="headerlink" title="4.覆盖修改表中的某个属性(字段)"></a>4.覆盖修改表中的某个属性(字段)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 change 老属性 新属性 新属性的类型;   </span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; alter table f1 change sex mysex char(4);</span><br></pre></td></tr></table></figure>
<h4 id="5-改表的字符编码"><a href="#5-改表的字符编码" class="headerlink" title="5.改表的字符编码"></a>5.改表的字符编码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 charset utf8;</span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; alter table f1 charset gbk;</span><br></pre></td></tr></table></figure>
<h4 id="6-修改表名"><a href="#6-修改表名" class="headerlink" title="6.修改表名"></a>6.修改表名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rename table 表名 to 新表名; </span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; rename table f1 to f2;</span><br></pre></td></tr></table></figure>
<h3 id="查："><a href="#查：" class="headerlink" title="查："></a>查：</h3><h4 id="1-查所有的表"><a href="#1-查所有的表" class="headerlink" title="1.查所有的表"></a>1.查所有的表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1.show tables;</span><br><span class="line">	实例：</span><br><span class="line">	mysql&gt; show tables</span><br><span class="line">	-&gt; ;</span><br><span class="line">	+-----------------+</span><br><span class="line">	| Tables_in_zhang |</span><br><span class="line">	+-----------------+</span><br><span class="line">	| f1              |</span><br><span class="line">	+-----------------+</span><br><span class="line">	1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h4 id="2-查创建的表"><a href="#2-查创建的表" class="headerlink" title="2.查创建的表"></a>2.查创建的表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">2.show create table 表名;</span><br><span class="line">	实例：</span><br><span class="line">	mysql&gt; show create table f1;</span><br><span class="line">	+-------+----------------------------------------------------------------------+</span><br><span class="line">	| Table | Create Table                                                                                                                                                                          |</span><br><span class="line">	+-------+----------------------------------------------------------------------+</span><br><span class="line">	| f1    | CREATE TABLE `f1` (</span><br><span class="line">	  `id` int(11) DEFAULT NULL,</span><br><span class="line">	  `name` char(5) CHARACTER SET utf8 DEFAULT NULL,</span><br><span class="line">	  `mysex` char(4) CHARACTER SET utf8 DEFAULT NULL</span><br><span class="line">	) ENGINE=InnoDB DEFAULT CHARSET=gbk |</span><br><span class="line">	+-------+----------------------------------------------------------------------+</span><br><span class="line">	1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h4 id="3-查表结构"><a href="#3-查表结构" class="headerlink" title="3.查表结构"></a>3.查表结构</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">3.desc 表名;</span><br><span class="line">	实例：</span><br><span class="line">	mysql&gt; desc f1</span><br><span class="line">		-&gt; ;</span><br><span class="line">	+-------+---------+------+-----+---------+-------+</span><br><span class="line">	| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">	+-------+---------+------+-----+---------+-------+</span><br><span class="line">	| id    | int(11) | YES  |     | NULL    |       |</span><br><span class="line">	| name  | char(5) | YES  |     | NULL    |       |</span><br><span class="line">	| mysex | char(4) | YES  |     | NULL    |       |</span><br><span class="line">	+-------+---------+------+-----+---------+-------+</span><br><span class="line">	3 rows in set (0.02 sec)</span><br></pre></td></tr></table></figure>
<h3 id="拷贝"><a href="#拷贝" class="headerlink" title="拷贝"></a>拷贝</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table copy_table select *from customer ;</span><br><span class="line">拷贝结构 与数据</span><br><span class="line">create table copy_table select *from customer where 0 &gt; 1;</span><br><span class="line">仅拷贝结构</span><br><span class="line"></span><br><span class="line">共同点： 索引 不能拷贝   描述不能拷贝（自增）</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553161969018.png" alt="1553161969018"></p>
<h3 id="查看当前所在库"><a href="#查看当前所在库" class="headerlink" title="查看当前所在库"></a>查看当前所在库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select batabase;</span><br></pre></td></tr></table></figure>
<h2 id="记录-insert-delete-update-select"><a href="#记录-insert-delete-update-select" class="headerlink" title="记录(insert/delete/update/select)"></a>记录(insert/delete/update/select)</h2><h3 id="增：-1"><a href="#增：-1" class="headerlink" title="增："></a>增：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">添加多个记录，记录的类型必须和表属性一致</span><br><span class="line">insert into 表名 value（rec1 , rec2 ......）</span><br><span class="line">insert into 表名 values（rec1 , rec2 ......），（rec1 , rec2 ......）</span><br><span class="line"></span><br><span class="line">实例：</span><br><span class="line">mysql&gt; insert into f2 values(1,&apos;zcg&apos;,&apos;male&apos;);</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553162538854.png" alt="1553162538854"></p>
<h3 id="删：use"><a href="#删：use" class="headerlink" title="删：use"></a>删：use</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">delete from 表名 （where 条件）;没有条件就全删</span><br><span class="line"></span><br><span class="line">实例：</span><br><span class="line">mysql&gt; delete from f2;</span><br><span class="line">Query OK, 2 rows affected (0.35 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from f2;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h4 id="不use"><a href="#不use" class="headerlink" title="不use"></a>不use</h4><p><img src="/2019/03/19/数据库笔记2/1553162646852.png" alt="1553162646852"></p>
<h3 id="改-没有条件就全删"><a href="#改-没有条件就全删" class="headerlink" title="改: 没有条件就全删"></a>改: 没有条件就全删</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">update 表名 set addr=rec (where 条件）; 没有条件就全删</span><br><span class="line"></span><br><span class="line">实例:</span><br><span class="line">mysql&gt; update f2 set name=&apos;ljy&apos; where id=1;</span><br></pre></td></tr></table></figure>
<h3 id="查：-1"><a href="#查：-1" class="headerlink" title="查："></a>查：</h3><h4 id="查所有"><a href="#查所有" class="headerlink" title="查所有"></a>查所有</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1.select * from 表名;</span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; select * from f2;</span><br><span class="line">		+------+------+-------+</span><br><span class="line">		| id   | name | mysex |</span><br><span class="line">		+------+------+-------+</span><br><span class="line">		|    1 | zcg  | male  |</span><br><span class="line">		|    2 | wjs  | fema  |</span><br><span class="line">		+------+------+-------+</span><br><span class="line">		2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h4 id="查一个单个属性"><a href="#查一个单个属性" class="headerlink" title="查一个单个属性"></a>查一个单个属性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">2.select 表属性 from 表名;</span><br><span class="line">		实例：</span><br><span class="line">		mysql&gt; select id from f2;</span><br><span class="line">		+------+</span><br><span class="line">		| id   |</span><br><span class="line">		+------+</span><br><span class="line">		|    1 |</span><br><span class="line">		|    2 |</span><br><span class="line">		+------+</span><br><span class="line">		2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553161149276.png" alt="1553161149276"></p>
<h1 id="创建表的完整语法"><a href="#创建表的完整语法" class="headerlink" title="创建表的完整语法"></a>创建表的完整语法</h1><p><img src="/2019/03/19/数据库笔记2/1553162959359.png" alt="1553162959359"></p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2>

	<div class="row">
    <embed src="mysqld数据类型.pdf" width="100%" height="550" type="application/pdf">
	</div>



<h3 id="1-整形"><a href="#1-整形" class="headerlink" title="1 整形"></a>1 整形</h3><h4 id="默认为有符号，即数字前有正负号"><a href="#默认为有符号，即数字前有正负号" class="headerlink" title="默认为有符号，即数字前有正负号"></a>默认为有符号，即数字前有正负号</h4><p>可以设置create table t4(x tinyint unsigned);无符号类型</p>
<h4 id="强调："><a href="#强调：" class="headerlink" title="强调："></a>强调：</h4><p>整型类型后面的宽度限制的根本不是存储宽度，限制的是显示宽度</p>
<p>create table t5(id int(1));<br>create table t6(id int(5));</p>
<h3 id="2-浮点型"><a href="#2-浮点型" class="headerlink" title="2.浮点型"></a>2.浮点型</h3><h4 id="三种格式的精度不一样"><a href="#三种格式的精度不一样" class="headerlink" title="三种格式的精度不一样"></a>三种格式的精度不一样</h4><p>float(255,30)<br>double(255,30)<br>decimal(65,30)</p>
<h4 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create table t8(x float(255,30));</span><br><span class="line">create table t9(x double(255,30));</span><br><span class="line">create table t10(x decimal(65,30));</span><br></pre></td></tr></table></figure>
<h3 id="3-日期类型"><a href="#3-日期类型" class="headerlink" title="3 日期类型"></a>3 日期类型</h3><h4 id="year"><a href="#year" class="headerlink" title="year"></a>year</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">============year===================</span><br><span class="line"></span><br><span class="line">create table t_year(born_year year);</span><br><span class="line">insert into  t_year values (1901),</span><br><span class="line">                           (2155);</span><br><span class="line"></span><br><span class="line">select * from t_year;</span><br><span class="line">+-----------+</span><br><span class="line">| born_year |</span><br><span class="line">+-----------+</span><br><span class="line">|      1901 |</span><br><span class="line">|      2155 |</span><br><span class="line">+-----------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h4 id="date-time-datetime"><a href="#date-time-datetime" class="headerlink" title="date time datetime"></a>date time datetime</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">============date,time,datetime===========</span><br><span class="line"></span><br><span class="line">create table t_mul(d date,t time,dt datetime);</span><br><span class="line"></span><br><span class="line">insert into t_mul values(now(),now(),now());</span><br><span class="line"></span><br><span class="line">select * from t_mul;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from t_mul;</span><br><span class="line">+------------+----------+---------------------+</span><br><span class="line">| d          | t        | dt                  |</span><br><span class="line">+------------+----------+---------------------+</span><br><span class="line">| 2017-08-01 | 19:42:22 | 2017-08-01 19:42:22 |</span><br><span class="line">+------------+----------+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h4 id="timestamp"><a href="#timestamp" class="headerlink" title="timestamp"></a>timestamp</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">create table t_stamp(t TIMESTAMP);</span><br><span class="line"></span><br><span class="line">insert into t_stamp values();</span><br><span class="line">insert into t_stamp values(NULL );</span><br><span class="line"></span><br><span class="line">select * from t_stamp;</span><br><span class="line"></span><br><span class="line">+---------------------+</span><br><span class="line">| t                   |</span><br><span class="line">+---------------------+</span><br><span class="line">| 2017-08-01 19:46:24 |</span><br><span class="line">| 2017-08-01 19:46:24 |</span><br><span class="line">+---------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h4 id="实际场景"><a href="#实际场景" class="headerlink" title="实际场景"></a>实际场景</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/*  </span><br><span class="line">    在实际应用的很多场景中，MySQL的这两种日期类型都能够满足我们的需要，存储精度都为秒，</span><br><span class="line">    但在某些情况下，会展现出他们各自的优劣。下面就来总结一下两种日期类型的区别。</span><br><span class="line"></span><br><span class="line">1.DATETIME的日期范围是1001——9999年，TIMESTAMP的时间范围是1970——2038年。</span><br><span class="line"></span><br><span class="line">2.DATETIME存储时间与时区无关，TIMESTAMP存储时间与时区有关，显示的值也依赖于时区。</span><br><span class="line">  在mysql服务器，操作系统以及客户端连接都有时区的设置。</span><br><span class="line"></span><br><span class="line">3.DATETIME使用8字节的存储空间，TIMESTAMP的存储空间为4字节。因此，TIMESTAMP比DATETIME的</span><br><span class="line">  空间利用率更高。</span><br><span class="line"></span><br><span class="line">4.DATETIME的默认值为null；TIMESTAMP的字段默认不为空（not null）,默认值为当前时间</span><br><span class="line"> （CURRENT_TIMESTAMP），如果不做特殊处理，并且update语句中没有指定该列的更新值，则默</span><br><span class="line">  认更新为当前时间。</span><br><span class="line">  </span><br><span class="line">  */</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">year 1999  #年</span><br><span class="line">date 1999-11-11#年月日</span><br><span class="line">time 08:30:00#时分秒</span><br><span class="line">datetime/timestamp 1999-11-11 08:30:00#年月日时分秒</span><br></pre></td></tr></table></figure>
<h4 id="实列"><a href="#实列" class="headerlink" title="实列"></a>实列</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">create table student(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    name char(16),</span><br><span class="line">    born_year year,</span><br><span class="line">    birth date,</span><br><span class="line">    class_time time,</span><br><span class="line">    reg_time datetime</span><br><span class="line">);</span><br><span class="line">insert into student(name,born_year,birth,class_time,reg_time) values</span><br><span class="line">(&apos;egon1&apos;,now(),now(),now(),now());</span><br><span class="line"></span><br><span class="line">insert into student(name,born_year,birth,class_time,reg_time) values</span><br><span class="line">(&apos;egon1&apos;,2000,20001111,now(),now());</span><br><span class="line"></span><br><span class="line">insert into student(name,born_year,birth,class_time,reg_time) values</span><br><span class="line">(&apos;egon1&apos;,2000,&apos;2000-11-11&apos;,083000,now());</span><br><span class="line"></span><br><span class="line">insert into student(name,born_year,birth,class_time,reg_time) values</span><br><span class="line">(&apos;egon1&apos;,2000,&apos;2000-11-11&apos;,&quot;08:30:00&quot;,20171111111111);</span><br><span class="line"></span><br><span class="line">insert into student(name,born_year,birth,class_time,reg_time) values</span><br><span class="line">(&apos;egon1&apos;,2000,&apos;2000-11-11&apos;,&quot;08:30:00&quot;,&quot;2017-11-11 11:11:11&quot;);</span><br><span class="line"></span><br><span class="line">create table t11(x timestamp);</span><br><span class="line">create table t12(x datetime not null default now());</span><br></pre></td></tr></table></figure>
<h4 id="timestamp与datetime的区别"><a href="#timestamp与datetime的区别" class="headerlink" title="timestamp与datetime的区别"></a>timestamp与datetime的区别</h4><p><img src="/2019/03/19/数据库笔记2/1553163448508.png" alt="1553163448508"></p>
<h3 id="4-字符类型"><a href="#4-字符类型" class="headerlink" title="4.字符类型"></a>4.字符类型</h3><p>注意：宽度指限制的是字符个数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">char：定长</span><br><span class="line">    char(5)</span><br><span class="line">varchar：变长</span><br><span class="line">    varchar(5) #一般用变长</span><br></pre></td></tr></table></figure>
<p>相同点宽度指的都是最大存储的字符个数，超过了都无法正常存储</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">如何选择</span><br><span class="line">    char</span><br><span class="line">        存取效率高</span><br><span class="line">        浪费存储空间</span><br><span class="line">    varchar</span><br><span class="line">        存取效率低于char</span><br><span class="line">        节省存储空间</span><br><span class="line">    使用起来感受不到区别 通常用的是char</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553163633944.png" alt="1553163633944"></p>
<h4 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h4><p><img src="/2019/03/19/数据库笔记2/1553163693858.png" alt="1553163693858"></p>
<h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><p><img src="/2019/03/19/数据库笔记2/1553163711210.png" alt="1553163711210"></p>
<h3 id="5-枚举与集合类型"><a href="#5-枚举与集合类型" class="headerlink" title="5 枚举与集合类型"></a>5 枚举与集合类型</h3><p>字段的值只能在给定范围中选择，如单选框，多选框 enum 单选    只能在给定的范围内选一个值，如性别 sex 男male/女female set 多选 在给定的范围内可以选择一个或一个以上的值（爱好1,爱好2,爱好3…） </p>
<h4 id="先创建"><a href="#先创建" class="headerlink" title="先创建"></a>先创建</h4><p><img src="/2019/03/19/数据库笔记2/1553163944717.png" alt="1553163944717"></p>
<h4 id="枚举enum-多选一"><a href="#枚举enum-多选一" class="headerlink" title="枚举enum:多选一"></a>枚举enum:多选一</h4><p><img src="/2019/03/19/数据库笔记2/1553163959431.png" alt="1553163959431"></p>
<h4 id="集合set-多选多"><a href="#集合set-多选多" class="headerlink" title="集合set: 多选多"></a>集合set: 多选多</h4><p><img src="/2019/03/19/数据库笔记2/1553163967151.png" alt="1553163967151"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">枚举类型（enum）</span><br><span class="line">An ENUM column can have a maximum of 65,535 distinct elements. </span><br><span class="line">(The practical limit is less than 3000.)</span><br><span class="line">示例：</span><br><span class="line">    CREATE TABLE shirts (</span><br><span class="line">        name VARCHAR(40),</span><br><span class="line">        size ENUM(&apos;x-small&apos;, &apos;small&apos;, &apos;medium&apos;, &apos;large&apos;, &apos;x-large&apos;)</span><br><span class="line">    );</span><br><span class="line">    INSERT INTO shirts (name, size) VALUES (&apos;dress shirt&apos;,&apos;large&apos;), </span><br><span class="line">                                            (&apos;t-shirt&apos;,&apos;medium&apos;),</span><br><span class="line">                                            (&apos;polo shirt&apos;,&apos;small&apos;);</span><br><span class="line"></span><br><span class="line">集合类型（set）</span><br><span class="line">A SET column can have a maximum of 64 distinct members.</span><br><span class="line">示例：</span><br><span class="line">    CREATE TABLE myset (col SET(&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;));</span><br><span class="line">    INSERT INTO myset (col) VALUES  (&apos;a,d&apos;),</span><br><span class="line">                                    (&apos;d,a&apos;), </span><br><span class="line">                                    (&apos;a,d,a&apos;), </span><br><span class="line">                                    (&apos;a,d,d&apos;),</span><br><span class="line">                                    (&apos;d,a,d&apos;);</span><br><span class="line">                                    </span><br><span class="line">                                    </span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<h4 id="concat-字符串相加"><a href="#concat-字符串相加" class="headerlink" title="concat(字符串相加)"></a>concat(字符串相加)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert into s1 values(n,concat(&apos;egon&apos;,n),</span><br><span class="line">       &apos;male&apos;,concat(&apos;egon&apos;,n,&apos;@163.com&apos;));请看存储过程</span><br></pre></td></tr></table></figure>
<h2 id="表的约束"><a href="#表的约束" class="headerlink" title="表的约束"></a>表的约束</h2><h3 id="not-null与default"><a href="#not-null与default" class="headerlink" title="not null与default"></a>not null与default</h3><p><img src="/2019/03/19/数据库笔记2/1553164228333.png" alt="1553164228333"></p>
<h3 id="unique-key唯一"><a href="#unique-key唯一" class="headerlink" title="unique key唯一"></a>unique key唯一</h3><h4 id="创建方法"><a href="#创建方法" class="headerlink" title="创建方法"></a>创建方法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">方法一：</span><br><span class="line">create table t2(x int unique); #设置x的值唯一，不能重复</span><br><span class="line">方法二：</span><br><span class="line">create table t3(</span><br><span class="line">    x int,</span><br><span class="line">    y varchar(5),</span><br><span class="line">    unique key(x)</span><br><span class="line">);</span><br><span class="line">方法三</span><br><span class="line">create table t4(</span><br><span class="line">    x int,</span><br><span class="line">    y varchar(5),</span><br><span class="line">    constraint uni_x unique key(x)#可以设置唯一的键为uni_x但没什么用，只是表内部的一种表现方式</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="联合唯一"><a href="#联合唯一" class="headerlink" title="联合唯一"></a>联合唯一</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">联合唯一</span><br><span class="line">create table service(</span><br><span class="line">    ip varchar(15),</span><br><span class="line">    port int,</span><br><span class="line">    unique key(ip,port)#两者联合起来唯一就可以</span><br><span class="line">);</span><br><span class="line">insert into service values</span><br><span class="line">(&apos;1.1.1.1&apos;,3306),</span><br><span class="line">(&apos;1.1.1.1&apos;,3306);</span><br></pre></td></tr></table></figure>
<h3 id="primary-key-主键"><a href="#primary-key-主键" class="headerlink" title="primary key(主键)"></a>primary key(主键)</h3><p>站在约束角度看primary key=not null unique不为空且唯一 ，另外还有索引优化</p>
<h4 id="注意点-1"><a href="#注意点-1" class="headerlink" title="注意点"></a>注意点</h4><p>以后但凡建表，必须注意：<br>1、必须有且只有一个主键<br>2、通常是id字段被设置为主键</p>
<h4 id="写法"><a href="#写法" class="headerlink" title="写法"></a>写法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create table t5(</span><br><span class="line">    id int primary key auto_increment</span><br><span class="line">	#一般表的固定写法，设置id为主键，且自增长</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="foreign-key"><a href="#foreign-key" class="headerlink" title="foreign key"></a>foreign key</h3><p>外键：用来在表与表之间建立关系的。限制关联表某一个字段的值必是来自于被关联表的一个字段的</p>
<h4 id="注意-1"><a href="#注意-1" class="headerlink" title="注意"></a>注意</h4><p>1、被关联的字段必须是一个key，通常是id字段</p>
<p>2、创建表时：必须先建立被关联的表，才能建立关联表</p>
<p>3、插入记录时：必须先往被关联的表插入记录，才能往关联表中插入记录</p>
<h4 id="创建表2个相互关联的表"><a href="#创建表2个相互关联的表" class="headerlink" title="创建表2个相互关联的表"></a>创建表2个相互关联的表</h4><p>references是指向的意思</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">创建表时：必须先建立被关联的表，才能建立关联表</span><br><span class="line">create table dep(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    dname varchar(20),</span><br><span class="line">    info varchar(50)</span><br><span class="line">);</span><br><span class="line">create table emp(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    name varchar(15),</span><br><span class="line">    age int,</span><br><span class="line">    dep_id int,</span><br><span class="line">    foreign key(dep_id) references dep(id)</span><br><span class="line">    on update cascade</span><br><span class="line">    on delete cascade</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="插入2个相互关联表的数据"><a href="#插入2个相互关联表的数据" class="headerlink" title="插入2个相互关联表的数据"></a>插入2个相互关联表的数据</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">insert into dep(dname,info) values</span><br><span class="line">(&apos;IT&apos;,&apos;技术能力有限部门xxx&apos;),</span><br><span class="line">(&apos;Sale&apos;,&apos;文化程度不高&apos;),</span><br><span class="line">(&apos;HR&apos;,&apos;招不到人部门&apos;);</span><br><span class="line">insert into emp(name,age,dep_id) values</span><br><span class="line">(&apos;egon&apos;,18,1),</span><br><span class="line">(&apos;alex&apos;,28,2),</span><br><span class="line">(&apos;wsj&apos;,38,2),</span><br><span class="line">(&apos;lxx&apos;,30,1),</span><br><span class="line">(&apos;xiaohou&apos;,18,3);</span><br></pre></td></tr></table></figure>
<h4 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h4><p>ps:删除时：应该先删除关联表emp中的记录，再删除被关联表对应的记录</p>
<h4 id="找两张表的关系的窍门"><a href="#找两张表的关系的窍门" class="headerlink" title="找两张表的关系的窍门"></a>找两张表的关系的窍门</h4><p><img src="/2019/03/19/数据库笔记2/1553165055967.png" alt="1553165055967"></p>
<p><img src="/2019/03/19/数据库笔记2/1553165063303.png" alt="1553165063303"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">create table author(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    name varchar(16),</span><br><span class="line">    age int</span><br><span class="line">);</span><br><span class="line">create table book(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    bname varchar(20),</span><br><span class="line">    price int</span><br><span class="line">);</span><br><span class="line">create table author2book(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    author_id int,</span><br><span class="line">    book_id int,</span><br><span class="line">    foreign key(author_id) references author(id) on update cascade on delete cascade,</span><br><span class="line">    foreign key(book_id) references book(id) on update cascade on delete cascade</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="一对一"><a href="#一对一" class="headerlink" title="一对一:"></a>一对一:</h4><p>无需参考窍门，左表的一条数据唯一对应右表的一条记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">一对一 ******</span><br><span class="line">生活中的一对一</span><br><span class="line">    客户表， 学员表</span><br><span class="line">    通过分析</span><br><span class="line">    一个客户只对应一个学员</span><br><span class="line">    一个学员只对应一个客户</span><br><span class="line">    所以确定关系为一对一</span><br><span class="line"></span><br><span class="line">    在mysql中通过外键来建立一对一</span><br><span class="line"></span><br><span class="line">    create table customer(id int primary key auto_increment,name char(10),phone char(11),sex char(1));</span><br><span class="line">    create table student(id int primary key auto_increment,name char(10),class char(11),sex char(1),c_id int,</span><br><span class="line">    foreign key(c_id) references  customer(id) on update cascade on delete cascade</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>
<h3 id="补充存储引擎"><a href="#补充存储引擎" class="headerlink" title="补充存储引擎"></a>补充存储引擎</h3><p><img src="/2019/03/19/数据库笔记2/1553164641671.png" alt="1553164641671"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 补充存储引擎：</span><br><span class="line">create table t12(x int)engine=&apos;myisam&apos;;</span><br><span class="line">#不支持事务、表锁设计、支持全文索引,主要面向一些 OLAP 数 据库应用</span><br><span class="line">create table t13(x int)engine=&apos;innodb&apos;;#一般常用</span><br><span class="line">create table t14(x int)engine=&apos;memory&apos;;</span><br><span class="line">#存储在内存当中，服务器断开或者断电丢失，无法保存</span><br><span class="line">create table t15(x int)engine=&apos;blackhole&apos;;</span><br><span class="line">#这个是黑洞模式，无法保存数据</span><br></pre></td></tr></table></figure>
<h1 id="单表查询"><a href="#单表查询" class="headerlink" title="单表查询"></a>单表查询</h1><h2 id="准备的表和数据"><a href="#准备的表和数据" class="headerlink" title="准备的表和数据"></a>准备的表和数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE emp(</span><br><span class="line">    id       INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    name     VARCHAR(20),</span><br><span class="line">    gender   ENUM(&quot;male&quot;,&quot;female&quot;,&quot;other&quot;),</span><br><span class="line">    age      TINYINT,</span><br><span class="line">    dep      VARCHAR(20),</span><br><span class="line">    city     VARCHAR(20),</span><br><span class="line">   salary    DOUBLE(7,2)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INSERT INTO emp (name,gender,age,dep,city,salary) VALUES</span><br><span class="line">                (&quot;yuan&quot;,&quot;male&quot;,24,&quot;教学部&quot;,&quot;河北省&quot;,8000),</span><br><span class="line">                (&quot;egon&quot;,&quot;male&quot;,34,&quot;保安部&quot;,&quot;山东省&quot;,8000),</span><br><span class="line">                (&quot;alex&quot;,&quot;male&quot;,28,&quot;保洁部&quot;,&quot;山东省&quot;,10000),</span><br><span class="line">                (&quot;景丽阳&quot;,&quot;female&quot;,22,&quot;教学部&quot;,&quot;北京&quot;,9000),</span><br><span class="line">                (&quot;张三&quot;, &quot;male&quot;,24,&quot;教学部&quot;,&quot;河北省&quot;,6000),</span><br><span class="line">                (&quot;李四&quot;, &quot;male&quot;,32,&quot;保安部&quot;,&quot;北京&quot;,12000),</span><br><span class="line">                (&quot;王五&quot;, &quot;male&quot;,38,&quot;教学部&quot;,&quot;河北省&quot;,7000),</span><br><span class="line">                (&quot;赵六&quot;, &quot;male&quot;,19,&quot;保安部&quot;,&quot;河北省&quot;,9000),</span><br><span class="line">                (&quot;猪七&quot;, &quot;female&quot;,24,&quot;保洁部&quot;,&quot;北京&quot;,9000);</span><br><span class="line"></span><br><span class="line">SELECT  * FROM emp;</span><br></pre></td></tr></table></figure>
<h3 id="产生"><a href="#产生" class="headerlink" title="产生"></a>产生</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT  * FROM emp;</span><br><span class="line">+----+-----------+--------+------+-----------+-----------+----------+</span><br><span class="line">| id | name      | gender | age  | dep       | city      | salary   |</span><br><span class="line">+----+-----------+--------+------+-----------+-----------+----------+</span><br><span class="line">|  1 | yuan      | male   |   24 | 教学部    | 河北省    |  8000.00 |</span><br><span class="line">|  2 | egon      | male   |   34 | 保安部    | 山东省    |  8000.00 |</span><br><span class="line">|  3 | alex      | male   |   28 | 保洁部    | 山东省    | 10000.00 |</span><br><span class="line">|  4 | 景丽阳    | female |   22 | 教学部    | 北京      |  9000.00 |</span><br><span class="line">|  5 | 张三      | male   |   24 | 教学部    | 河北省    |  6000.00 |</span><br><span class="line">|  6 | 李四      | male   |   32 | 保安部    | 北京      | 12000.00 |</span><br><span class="line">|  7 | 王五      | male   |   38 | 教学部    | 河北省    |  7000.00 |</span><br><span class="line">|  8 | 赵六      | male   |   19 | 保安部    | 河北省    |  9000.00 |</span><br><span class="line">|  9 | 猪七      | female |   24 | 保洁部    | 北京      |  9000.00 |</span><br><span class="line">+----+-----------+--------+------+-----------+-----------+----------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="练习单表查询"><a href="#练习单表查询" class="headerlink" title="练习单表查询"></a>练习单表查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">-- 查询男女员工各有多少人</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT gender 性别,count(*) 人数 FROM emp5 GROUP BY gender;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">-- 查询各个部门的人数</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT dep 部门,count(*) 人数 FROM emp5 GROUP BY dep;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">-- 查询每个部门最大的年龄</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT dep 部门,max(age) 最大年纪 FROM emp5 GROUP BY dep;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">-- 查询每个部门年龄最大的员工姓名</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT * FROM emp5 WHERE age in (SELECT max(age) FROM emp5 GROUP BY dep);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">-- 查询每个部门的平均工资</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT dep 部门,avg(salary) 最大年纪 FROM emp GROUP BY dep;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">--  查询教学部的员工最高工资:</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT dep,max(salary) FROM emp11 GROUP BY dep HAVING dep=&quot;教学部&quot;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">-- 查询平均薪水超过8000的部门</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT dep,AVG(salary) FROM  emp GROUP BY dep HAVING avg(salary)&gt;8000;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">--  查询每个组的员工姓名</span><br><span class="line"></span><br><span class="line">SELECT dep,group_concat(name) FROM emp GROUP BY dep;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">-- 查询公司一共有多少员工(可以将所有记录看成一个组)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT COUNT(*) 员工总人数 FROM emp;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">　　　　　　　　　　　　      -- KEY: 查询条件中的每个后的词就是分组的字段</span><br></pre></td></tr></table></figure>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.找到表:from</span><br><span class="line">2.拿着where指定的约束条件，去文件/表中取出一条条记录</span><br><span class="line">3.将取出的一条条记录进行分组group by，如果没有group by，则整体作为一组</span><br><span class="line">4.将分组的结果进行having过滤</span><br><span class="line">5.执行select</span><br><span class="line">6.去重</span><br><span class="line">7.将结果按条件排序：order by</span><br><span class="line">8.限制结果的显示条数</span><br></pre></td></tr></table></figure>
<h2 id="单表查询的完整语法"><a href="#单表查询的完整语法" class="headerlink" title="单表查询的完整语法"></a>单表查询的完整语法</h2><h3 id="语法级别关键字排序"><a href="#语法级别关键字排序" class="headerlink" title="语法级别关键字排序"></a>语法级别关键字排序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">select distinct 字段1,字段2,字段3,... from 库名.表名</span><br><span class="line">                    where 约束条件</span><br><span class="line">                    group by 分组依据</span><br><span class="line">                    having 过滤条件</span><br><span class="line">                    order by 排序的字段</span><br><span class="line">                    limit 限制显示的条数</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 必须要有的关键字如下：</span><br><span class="line">select * from t1;</span><br></pre></td></tr></table></figure>
<h3 id="关键字的执行顺序"><a href="#关键字的执行顺序" class="headerlink" title="关键字的执行顺序"></a>关键字的执行顺序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 关键字执行的优先级</span><br><span class="line">from 打开文件</span><br><span class="line">where #表的全局帅选</span><br><span class="line">group by#分组</span><br><span class="line">having  #分组之后的过滤</span><br><span class="line">distinct  #去重</span><br><span class="line">order by # 排序</span><br><span class="line">limit  #限制条目</span><br></pre></td></tr></table></figure>
<h2 id="单表简单的查询语法"><a href="#单表简单的查询语法" class="headerlink" title="单表简单的查询语法"></a>单表简单的查询语法</h2><p><img src="/2019/03/19/数据库笔记2/1553165885606.png" alt="1553165885606"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select * from t1;</span><br><span class="line">select id,name,sex from t1;</span><br><span class="line"></span><br><span class="line">select distinct post from emp;</span><br><span class="line">将表中的部门去重</span><br><span class="line">select name,salary*12 as annual_salary from emp;</span><br><span class="line">单表可以进行四则运算</span><br><span class="line">select concat(&apos;名字: &apos;,name) as new_name,concat(&quot;年龄: &quot;,age) as new_age from emp;</span><br><span class="line"></span><br><span class="line">#定义显示格式</span><br><span class="line">#可将查询结果进行一个拼接显示</span><br><span class="line">select concat(name,&quot;:&quot;,age) from emp;</span><br><span class="line">select concat(name,&quot;:&quot;,age,&quot;:&quot;,sex) from emp;</span><br><span class="line">select concat_ws(&quot;:&quot;,name,age,sex) as info from emp;</span><br><span class="line">concat_ws#可以进行一个格式化的操作</span><br></pre></td></tr></table></figure>
<h2 id="where和between和in"><a href="#where和between和in" class="headerlink" title="where和between和in"></a>where和between和in</h2><p><img src="/2019/03/19/数据库笔记2/1553165981228.png" alt="1553165981228"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">where字句中可以使用：</span><br><span class="line"></span><br><span class="line">1. 比较运算符：&gt; &lt; &gt;= &lt;= &lt;&gt; !=</span><br><span class="line">2. between 80 and 100 值在10到20之间</span><br><span class="line">3. in(80,90,100) 值是10或20或30</span><br><span class="line">4. like &apos;egon%&apos;</span><br><span class="line">    pattern可以是%或_，</span><br><span class="line">    %表示任意多字符</span><br><span class="line">    _表示一个字符 </span><br><span class="line">5. 逻辑运算符：在多个条件直接可以使用逻辑运算符 and or not</span><br><span class="line"></span><br><span class="line">select * from emp where id &gt;= 10 and id &lt;=15;</span><br><span class="line"> # 等同于select * from emp where id between 10 and 15;</span><br><span class="line">select * from emp where id = 6 or id = 9 or id = 12; </span><br><span class="line"># 等同于select * from emp where id in (6,9,12);</span><br></pre></td></tr></table></figure>
<h2 id="group-by-分组"><a href="#group-by-分组" class="headerlink" title="group by 分组"></a>group by 分组</h2><h3 id="什么是分组"><a href="#什么是分组" class="headerlink" title="什么是分组"></a>什么是分组</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#3、group by分组</span><br><span class="line"># 什么分组：按照所有记录相同的部分进行归类，一定区分度低的字段</span><br><span class="line"># 为何要分组：当我们要以组为单位进行统计时就必须分组，分组的目的是为了以组为单位进行统计的，再去考虑单条记录毫无意义</span><br><span class="line"># set global sql_mode=&quot;strict_trans_tables,only_full_group_by&quot;;</span><br><span class="line"># 注意:分组之后，只能查到分组的字段以及组内多条记录聚合的成果</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">小窍门：‘每’这个字后面的字段，就是我们分组的依据</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">可以按照任意字段分组，但是分组完毕后，比如group by post，只能查看post字段，如果想查看组内信息，需要借助于聚合函数</span><br></pre></td></tr></table></figure>
<h3 id="ONLY-FULL-GROUP-BY"><a href="#ONLY-FULL-GROUP-BY" class="headerlink" title="ONLY_FULL_GROUP_BY"></a>ONLY_FULL_GROUP_BY</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ONLY_FULL_GROUP_BY的语义就是确定select target list中的所有列的值都是明确语义，简单的说来，在ONLY_FULL_GROUP_BY模式下，target list中的值要么是来自于聚集函数的结果，要么是来自于group by list中的表达式的值。</span><br><span class="line"></span><br><span class="line">设置方式</span><br><span class="line"> set global sql_mode=&apos;ONLY_FULL_GROUP_BY&apos;;</span><br></pre></td></tr></table></figure>
<h3 id="聚合函数-和分组搭配使用"><a href="#聚合函数-和分组搭配使用" class="headerlink" title="聚合函数(和分组搭配使用)"></a>聚合函数(和分组搭配使用)</h3><p><img src="/2019/03/19/数据库笔记2/1553166173976.png" alt="1553166173976"></p>
<h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><p><img src="/2019/03/19/数据库笔记2/1553166187928.png" alt="1553166187928"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT COUNT(*) FROM employee;</span><br><span class="line">    SELECT COUNT(*) FROM employee WHERE depart_id=1;</span><br><span class="line">    SELECT MAX(salary) FROM employee;</span><br><span class="line">    SELECT MIN(salary) FROM employee;</span><br><span class="line">    SELECT AVG(salary) FROM employee;</span><br><span class="line">    SELECT SUM(salary) FROM employee;</span><br><span class="line">    SELECT SUM(salary) FROM employee WHERE depart_id=3;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select post,group_concat(name) from employee group by post;</span><br></pre></td></tr></table></figure>
<h2 id="having-和where的区别"><a href="#having-和where的区别" class="headerlink" title="having 和where的区别"></a>having 和where的区别</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#！！！执行优先级从高到低：where &gt; group by &gt; having </span><br><span class="line">#1. Where 发生在分组group by之前，因而Where中可以有任意字段，但是绝对不能使用聚合函数。</span><br><span class="line"></span><br><span class="line">#2. Having发生在分组group by之后，因而Having中可以使用分组的字段，无法直接取到其他字段,可以使用聚合函数</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553166377983.png" alt="1553166377983"></p>
<h2 id="is-null"><a href="#is-null" class="headerlink" title="is null"></a>is null</h2><h3 id="判断是否是空"><a href="#判断是否是空" class="headerlink" title="判断是否是空"></a>判断是否是空</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT name,post_comment FROM employee </span><br><span class="line">      WHERE post_comment IS NULL;</span><br><span class="line"></span><br><span class="line">  SELECT name,post_comment FROM employee </span><br><span class="line">      WHERE post_comment IS NOT NULL;</span><br><span class="line">      </span><br><span class="line">  SELECT name,post_comment FROM employee </span><br><span class="line">      WHERE post_comment=&apos;&apos;; 注意&apos;&apos;是空字符串，不是null</span><br><span class="line">  ps：</span><br><span class="line">      执行</span><br><span class="line">      update employee set post_comment=&apos;&apos; where id=2;</span><br><span class="line">      再用上条查看，就会有结果了</span><br></pre></td></tr></table></figure>
<h2 id="order-by-排序"><a href="#order-by-排序" class="headerlink" title="order by 排序"></a>order by 排序</h2><h3 id="asc升序-desc降序"><a href="#asc升序-desc降序" class="headerlink" title="asc升序,desc降序"></a>asc升序,desc降序</h3><p><img src="/2019/03/19/数据库笔记2/1553166493892.png" alt="1553166493892"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>; <span class="comment"># 默认asc升序-》从小到大</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>;<span class="comment"># desc降序-》从大到小</span></span><br></pre></td></tr></table></figure>
<h2 id="limit-限制显示的条件限制显示条目"><a href="#limit-限制显示的条件限制显示条目" class="headerlink" title="limit 限制显示的条件限制显示条目"></a>limit 限制显示的条件限制显示条目</h2><p><img src="/2019/03/19/数据库笔记2/1553166656249.png" alt="1553166656249"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#6、limit 限制显示的条件</span><br><span class="line">select * from emp limit 3;</span><br><span class="line"></span><br><span class="line">#薪资最高那个人的详细信息</span><br><span class="line">select * from emp order by salary desc limit 1;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 分页显示</span><br><span class="line">select * from emp limit 0,5; # 从0开始往后取5条</span><br><span class="line">select * from emp limit 5,5; #从5开始往后取5条</span><br></pre></td></tr></table></figure>
<h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#正则表达式</span><br><span class="line">select * from emp where name regexp &quot;^jin.*(g|n)$&quot;;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553166829738.png" alt="1553166829738"></p>
<h1 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h1><h2 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE emp(</span><br><span class="line">    id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    name VARCHAR(20),</span><br><span class="line">    salary DOUBLE(7,2),</span><br><span class="line">    dep_id INT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO emp (name,salary,dep_id) VALUES (&quot;张三&quot;,8000,2),</span><br><span class="line">                                            (&quot;李四&quot;,12000,1),</span><br><span class="line">                                            (&quot;王五&quot;,5000,2),</span><br><span class="line">                                            (&quot;赵六&quot;,8000,3),</span><br><span class="line">                                            (&quot;猪七&quot;,9000,1),</span><br><span class="line">                                            (&quot;周八&quot;,7000,4),</span><br><span class="line">                                            (&quot;蔡九&quot;,7000,2);</span><br><span class="line"></span><br><span class="line">CREATE TABLE dep(</span><br><span class="line">      id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">      name VARCHAR(20)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INSERT INTO dep (name) VALUES (&quot;教学部&quot;),</span><br><span class="line">                              (&quot;销售部&quot;),</span><br><span class="line">                              (&quot;人事部&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="产生结果"><a href="#产生结果" class="headerlink" title="产生结果"></a>产生结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from emp;</span><br><span class="line">+----+--------+----------+--------+</span><br><span class="line">| id | name   | salary   | dep_id |</span><br><span class="line">+----+--------+----------+--------+</span><br><span class="line">|  1 | 张三   |  8000.00 |      2 |</span><br><span class="line">|  2 | 李四   | 12000.00 |      1 |</span><br><span class="line">|  3 | 王五   |  5000.00 |      2 |</span><br><span class="line">|  4 | 赵六   |  8000.00 |      3 |</span><br><span class="line">|  5 | 猪七   |  9000.00 |      1 |</span><br><span class="line">|  6 | 周八   |  7000.00 |      4 |</span><br><span class="line">|  7 | 蔡九   |  7000.00 |      2 |</span><br><span class="line">+----+--------+----------+--------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dep;</span><br><span class="line">+----+-----------+</span><br><span class="line">| id | name      |</span><br><span class="line">+----+-----------+</span><br><span class="line">|  1 | 教学部    |</span><br><span class="line">|  2 | 销售部    |</span><br><span class="line">|  3 | 人事部    |</span><br><span class="line">+----+-----------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h2 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h2><p>条件(2张表有对应关系)</p>
<p>简单粗暴的对应关系</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * from emp,dep;</span><br><span class="line"></span><br><span class="line">select * from emp,dep where emp.dep_id = dep.id;</span><br><span class="line"></span><br><span class="line">select * from emp,dep where emp.dep_id = dep.id and dep.name = &quot;技术&quot;;</span><br></pre></td></tr></table></figure>
<h3 id="select-from-emp-dep"><a href="#select-from-emp-dep" class="headerlink" title="select * from emp,dep;"></a>select * from emp,dep;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from emp,dep;</span><br><span class="line">+----+--------+----------+--------+----+-----------+</span><br><span class="line">| id | name   | salary   | dep_id | id | name      |</span><br><span class="line">+----+--------+----------+--------+----+-----------+</span><br><span class="line">|  1 | 张三   |  8000.00 |      2 |  1 | 教学部    |</span><br><span class="line">|  1 | 张三   |  8000.00 |      2 |  2 | 销售部    |</span><br><span class="line">|  1 | 张三   |  8000.00 |      2 |  3 | 人事部    |</span><br><span class="line">|  2 | 李四   | 12000.00 |      1 |  1 | 教学部    |</span><br><span class="line">|  2 | 李四   | 12000.00 |      1 |  2 | 销售部    |</span><br><span class="line">|  2 | 李四   | 12000.00 |      1 |  3 | 人事部    |</span><br><span class="line">|  3 | 王五   |  5000.00 |      2 |  1 | 教学部    |</span><br><span class="line">|  3 | 王五   |  5000.00 |      2 |  2 | 销售部    |</span><br><span class="line">|  3 | 王五   |  5000.00 |      2 |  3 | 人事部    |</span><br><span class="line">|  4 | 赵六   |  8000.00 |      3 |  1 | 教学部    |</span><br><span class="line">|  4 | 赵六   |  8000.00 |      3 |  2 | 销售部    |</span><br><span class="line">|  4 | 赵六   |  8000.00 |      3 |  3 | 人事部    |</span><br><span class="line">|  5 | 猪七   |  9000.00 |      1 |  1 | 教学部    |</span><br><span class="line">|  5 | 猪七   |  9000.00 |      1 |  2 | 销售部    |</span><br><span class="line">|  5 | 猪七   |  9000.00 |      1 |  3 | 人事部    |</span><br><span class="line">|  6 | 周八   |  7000.00 |      4 |  1 | 教学部    |</span><br><span class="line">|  6 | 周八   |  7000.00 |      4 |  2 | 销售部    |</span><br><span class="line">|  6 | 周八   |  7000.00 |      4 |  3 | 人事部    |</span><br><span class="line">|  7 | 蔡九   |  7000.00 |      2 |  1 | 教学部    |</span><br><span class="line">|  7 | 蔡九   |  7000.00 |      2 |  2 | 销售部    |</span><br><span class="line">|  7 | 蔡九   |  7000.00 |      2 |  3 | 人事部    |</span><br><span class="line">+----+--------+----------+--------+----+-----------+</span><br><span class="line">21 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h2 id="内连接-只取两张表有对应关系的记录"><a href="#内连接-只取两张表有对应关系的记录" class="headerlink" title="内连接: 只取两张表有对应关系的记录"></a>内连接: 只取两张表有对应关系的记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#2、内连接：只取两张表有对应关系的记录</span><br><span class="line">select * from emp inner join dep on emp.dep_id = dep.id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select * from emp inner join dep on emp.dep_id = dep.id</span><br><span class="line">                       where dep.name = &quot;技术&quot;;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553172129044.png" alt="1553172129044"></p>
<h3 id="select-from-emp-inner-join-dep-on-emp-dep-id-dep-id"><a href="#select-from-emp-inner-join-dep-on-emp-dep-id-dep-id" class="headerlink" title="select * from emp inner join dep on emp.dep_id = dep.id;"></a>select * from emp inner join dep on emp.dep_id = dep.id;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+----+--------+----------+--------+----+-----------+</span><br><span class="line">| id | name   | salary   | dep_id | id | name      |</span><br><span class="line">+----+--------+----------+--------+----+-----------+</span><br><span class="line">|  1 | 张三   |  8000.00 |      2 |  2 | 销售部     |</span><br><span class="line">|  2 | 李四   | 12000.00 |      1 |  1 | 教学部     |</span><br><span class="line">|  3 | 王五   |  5000.00 |      2 |  2 | 销售部     |</span><br><span class="line">|  4 | 赵六   |  8000.00 |      3 |  3 | 人事部     |</span><br><span class="line">|  5 | 猪七   |  9000.00 |      1 |  1 | 教学部     |</span><br><span class="line">|  7 | 蔡九   |  7000.00 |      2 |  2 | 销售部     |</span><br><span class="line">+----+--------+----------+--------+----+-----------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>这时，我们就可以利用两张表中所有的字段进行查询了 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 查询李四所在的部门名称</span><br><span class="line"></span><br><span class="line">SELECT emp.name,dep.name FROM  emp INNER JOIN dep ON emp.dep_id=dep.id WHERE emp.name=&quot;李四&quot;;</span><br><span class="line"></span><br><span class="line">-- 查询销售部所有员工姓名以及部门名称</span><br><span class="line"></span><br><span class="line">-- SELECT name FROM  emp WHERE dep_id in (SELECT id FROM dep WHERE name=&quot;销售部&quot;);</span><br><span class="line"></span><br><span class="line">SELECT emp.name,dep.name FROM  emp INNER JOIN dep ON emp.dep_id=dep.id WHERE dep.name=&quot;销售部&quot;;</span><br></pre></td></tr></table></figure>
<h2 id="左连接-在内连接的基础上保留左表没有对应关系的记录"><a href="#左连接-在内连接的基础上保留左表没有对应关系的记录" class="headerlink" title="左连接: 在内连接的基础上保留左表没有对应关系的记录"></a>左连接: 在内连接的基础上保留左表没有对应关系的记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp left join dep on emp.dep_id = dep.id;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553172147156.png" alt="1553172147156"></p>
<h3 id="select-from-emp-left-join-dep-on-emp-dep-id-dep-id"><a href="#select-from-emp-left-join-dep-on-emp-dep-id-dep-id" class="headerlink" title="select * from emp left join dep on emp.dep_id = dep.id;"></a>select * from emp left join dep on emp.dep_id = dep.id;</h3><p>查询结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+----+--------+----------+--------+------+-----------+</span><br><span class="line">| id | name   | salary   | dep_id | id   | name      |</span><br><span class="line">+----+--------+----------+--------+------+-----------+</span><br><span class="line">|  2 | 李四   | 12000.00 |      1 |    1 | 教学部    |</span><br><span class="line">|  5 | 猪七   |  9000.00 |      1 |    1 | 教学部    |</span><br><span class="line">|  1 | 张三   |  8000.00 |      2 |    2 | 销售部    |</span><br><span class="line">|  3 | 王五   |  5000.00 |      2 |    2 | 销售部    |</span><br><span class="line">|  7 | 蔡九   |  7000.00 |      2 |    2 | 销售部    |</span><br><span class="line">|  4 | 赵六   |  8000.00 |      3 |    3 | 人事部    |</span><br><span class="line">|  6 | 周八   |  7000.00 |      4 | NULL | NULL      |</span><br><span class="line">+----+--------+----------+--------+------+-----------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h2 id="右连接-在内连接的基础上保留右表没有对应关系的记录"><a href="#右连接-在内连接的基础上保留右表没有对应关系的记录" class="headerlink" title="右连接: 在内连接的基础上保留右表没有对应关系的记录"></a>右连接: 在内连接的基础上保留右表没有对应关系的记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp right join dep on emp.dep_id = dep.id;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553172157453.png" alt="1553172157453"></p>
<p>select * from emp right join dep on emp.dep_id = dep.id;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM emp RIGHT JOIN dep ON dep.id=emp.dep_id;</span><br><span class="line">+------+--------+----------+--------+----+-----------+</span><br><span class="line">| id   | name   | salary   | dep_id | id | name      |</span><br><span class="line">+------+--------+----------+--------+----+-----------+</span><br><span class="line">|    1 | 张三   |  8000.00 |      2 |  2 | 销售部    |</span><br><span class="line">|    2 | 李四   | 12000.00 |      1 |  1 | 教学部    |</span><br><span class="line">|    3 | 王五   |  5000.00 |      2 |  2 | 销售部    |</span><br><span class="line">|    4 | 赵六   |  8000.00 |      3 |  3 | 人事部    |</span><br><span class="line">|    5 | 猪七   |  9000.00 |      1 |  1 | 教学部    |</span><br><span class="line">|    7 | 蔡九   |  7000.00 |      2 |  2 | 销售部    |</span><br><span class="line">+------+--------+----------+--------+----+-----------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h2 id="全连接：在内连接的基础上保留左、右面表没有对应关系的的记录"><a href="#全连接：在内连接的基础上保留左、右面表没有对应关系的的记录" class="headerlink" title="全连接：在内连接的基础上保留左、右面表没有对应关系的的记录"></a>全连接：在内连接的基础上保留左、右面表没有对应关系的的记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from emp left join dep on emp.dep_id = dep.id</span><br><span class="line">union</span><br><span class="line">select * from emp right join dep on emp.dep_id = dep.id;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553172175393.png" alt="1553172175393"></p>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>就是将一个查询语句的结果用括号括起来当作另外一个查询语句的条件去用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from emp where dep_id in (select id from dep </span><br><span class="line">where name = &quot;技术&quot; or name = &quot;人力资源&quot;);</span><br></pre></td></tr></table></figure>
<p>每个部门最新入职的员工</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 每个部门最新入职的员工</span><br><span class="line">select t1.id,t1.name,t1.hire_date,t1.post,t2.* from emp as t1</span><br><span class="line">inner join</span><br><span class="line">(select post,max(hire_date) as max_date from emp group by post) as t2</span><br><span class="line">#找出每个部门中最大的时间，即最新时间</span><br><span class="line">on t1.post = t2.post</span><br><span class="line">where t1.hire_date = t2.max_date</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553172744768.png" alt="1553172744768"></p>
<h1 id="Mysql–用户相关"><a href="#Mysql–用户相关" class="headerlink" title="Mysql–用户相关"></a>Mysql–用户相关</h1><h2 id="MySQL用户操作"><a href="#MySQL用户操作" class="headerlink" title="MySQL用户操作"></a>MySQL用户操作</h2><h3 id="创建账号"><a href="#创建账号" class="headerlink" title="创建账号"></a>创建账号</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">此处的主机地址 不是服务器地址 而是表示 这个账户可以在那台电脑上登录</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">方法一： CREATE USER语句创建</span><br><span class="line">        CREATE USER &quot;用户名&quot;@&quot;IP地址&quot; IDENTIFIED BY &quot;密码&quot;;</span><br><span class="line"></span><br><span class="line">方法二： INSERT语句创建</span><br><span class="line">        INSERT INTO mysql.user(user,host, password,ssl_cipher,x509_issuer,x509_subject)</span><br><span class="line">        VALUES(‘用户名’,’IP地址’,password(‘密码’),’’,’’,’’);</span><br><span class="line">        FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">方法三： GRANT语句创建</span><br><span class="line">        GRANT SELECT ON *.* TO 用户名@’IP地址’ IDENTIFIED BY ‘密码’;</span><br><span class="line">        FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 2、只创建账号</span><br><span class="line">#create user tom@&quot;客户端的ip&quot; identified by &quot;123&quot;;</span><br><span class="line">create user tom@&quot;192.168.15.%&quot; identified by &quot;123&quot;;</span><br><span class="line">create user tom@&quot;%&quot; identified by &quot;123&quot;;</span><br><span class="line"></span><br><span class="line">#客户端：192.168.15.13               服务端：192.168.15.90</span><br><span class="line"></span><br><span class="line">create user tom@&quot;192.168.15.13 &quot; identified by &quot;123&quot;;</span><br><span class="line">mysql -utom -p&quot;123&quot; -h 192.168.15.90 -P 3306</span><br></pre></td></tr></table></figure>
<h3 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">drop user &quot;tom&quot;@&quot;192.168.15.90&quot;;</span><br><span class="line">drop user &quot;jack&quot;@&quot;192.168.15.90&quot;;</span><br><span class="line">drop user &quot;rose&quot;@&quot;192.168.15.90&quot;;</span><br><span class="line">drop user &quot;lili&quot;@&quot;192.168.15.90&quot;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">方法一：DROP USER语句删除</span><br><span class="line"></span><br><span class="line">       DROP USER &quot;用户名&quot;@&quot;IP地址&quot;;</span><br><span class="line"></span><br><span class="line">方法二：DELETE语句删除</span><br><span class="line"></span><br><span class="line">       DELETE FROM mysql.user </span><br><span class="line">            WHERE user=’用户名’ AND host=’IP地址’;</span><br><span class="line">       FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<h3 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h3><h4 id="root用户修改自己密码："><a href="#root用户修改自己密码：" class="headerlink" title="(root用户修改自己密码：)"></a>(root用户修改自己密码：)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">方法一：</span><br><span class="line">    # mysqladmin -uroot -p123 password &apos;new_password&apos;    //123为旧密码</span><br><span class="line"></span><br><span class="line">方法二：</span><br><span class="line">    UPDATE mysql.user SET password=password(‘new_password’)</span><br><span class="line">           WHERE user=’root’ AND host=’localhost’;</span><br><span class="line">    FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">方法三：</span><br><span class="line">    SET PASSWORD=password(‘new_password’);</span><br><span class="line">    FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<h4 id="root修改其他用户密码："><a href="#root修改其他用户密码：" class="headerlink" title="root修改其他用户密码："></a>root修改其他用户密码：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">方法一：</span><br><span class="line">    SET PASSWORD FOR 用户名@’IP地址’=password(‘new_password’);</span><br><span class="line">    FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">方法二：</span><br><span class="line">    UPDATE mysql.user SET password=password(‘new_password’)</span><br><span class="line">        WHERE user=’用户名’ AND host=’IP地址’;</span><br><span class="line">    FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">方法三：</span><br><span class="line">    GRANT SELECT ON *.* TO user3@’localhost’ IDENTIFIED BY ‘yuan’; </span><br><span class="line">    FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<h4 id="普通用户修改自己密码："><a href="#普通用户修改自己密码：" class="headerlink" title="普通用户修改自己密码："></a>普通用户修改自己密码：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET password=password(‘new_password’);</span><br></pre></td></tr></table></figure>
<h4 id="丢失root用户密码："><a href="#丢失root用户密码：" class="headerlink" title="丢失root用户密码："></a>丢失root用户密码：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/my.cnf</span><br><span class="line">skip-grant-tables</span><br><span class="line"># service mysqld restart</span><br><span class="line"># mysql -uroot</span><br><span class="line">mysql&gt; UPDATE mysql.user SET password=password(‘new_password’)</span><br><span class="line">WHERE user=’root’ AND host=’localhost’;</span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<h4 id="修改用户名："><a href="#修改用户名：" class="headerlink" title="修改用户名："></a>修改用户名：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename user &apos;用户名&apos;@&apos;IP地址&apos; to &apos;新用户名&apos;@&apos;IP地址&apos;;</span><br></pre></td></tr></table></figure>
<h2 id="MySQL权限管理"><a href="#MySQL权限管理" class="headerlink" title="MySQL权限管理"></a>MySQL权限管理</h2><h3 id="1、跟权限有关的几张表"><a href="#1、跟权限有关的几张表" class="headerlink" title="1、跟权限有关的几张表"></a>1、跟权限有关的几张表</h3><p>user-&gt;db-&gt;table_priv-&gt;columns_priv</p>
<p>user是全局帐号的一个操作权限，<br>db 是某一个库文件的操作权限，<br>table_oriv 是某一个表的操作权限，<br>columns_priv 是表字段的操作权限。</p>
<h3 id="创建账号并且授权"><a href="#创建账号并且授权" class="headerlink" title="创建账号并且授权"></a>创建账号并且授权</h3><h4 id="–语法格式："><a href="#–语法格式：" class="headerlink" title="–语法格式："></a>–语法格式：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant 权限列表  on 库名.表名 to 用户名@&apos;客户端主机&apos;  [identified by &apos;密码&apos;  with option参数];</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-- 给该用户授予对数据库db1下的表tb1所有的操作权限</span><br><span class="line">grant all privileges on db1.tb1 TO &apos;用户名&apos;@&apos;IP&apos;  </span><br><span class="line"></span><br><span class="line">-- 给该用户授予对数据库db1下所有表进行查操作的权限</span><br><span class="line">grant select on db1.* TO &apos;用户名&apos;@&apos;IP&apos;   </span><br><span class="line">  </span><br><span class="line">-- 给该用户授予对所有数据库下所有表进行查和增的操作     </span><br><span class="line">grant select,insert on *.* TO &apos;用户名&apos;@&apos;IP&apos;   </span><br><span class="line">    </span><br><span class="line">-- 用户只能在该IP段下才能(通配符%表示任意)对所有数据库下所有表进行查操作</span><br><span class="line">grant select on *.* TO &apos;用户名&apos;@&apos;192.168.1.%&apos;     </span><br><span class="line">  </span><br><span class="line">-- 用户能用户可以在任意IP下(通配符%表示任意)对所有数据库下所有表进行查操作    </span><br><span class="line">grant select on *.* TO &apos;用户名&apos;@&apos;%&apos;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># *.* ===&gt; mysql.user</span><br><span class="line">grant all on *.* to &quot;tom&quot;@&quot;192.168.15.90&quot; identified by &quot;123&quot;;#all代表除了grant以外的所有权限</span><br><span class="line"></span><br><span class="line"># db1.* ===&gt; mysql.db</span><br><span class="line">grant all on db1.* to &quot;jack&quot;@&quot;192.168.15.90&quot; identified by &quot;123&quot;;#all代表除了grant以外的所有权限</span><br><span class="line"></span><br><span class="line"># db1.t1 ===&gt; mysql.tables_priv</span><br><span class="line">grant all on db1.t1 to &quot;rose&quot;@&quot;192.168.15.90&quot; identified by &quot;123&quot;;#all代表除了grant以外的所有权限</span><br><span class="line"></span><br><span class="line"># db1.t1(id) ===&gt; mysql.columns_priv</span><br><span class="line">grant select(id),update(name) on db1.t1 to &quot;lili&quot;@&quot;192.168.15.90&quot; identified by &quot;123&quot;;</span><br></pre></td></tr></table></figure>
<p>View Code</p>
<p><strong>with_option参数：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GRANT OPTION：                                    -- 授权选项</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    MAX_QUERIES_PER_HOUR：                        -- 定义每小时允许执行的查询数</span><br><span class="line">    MAX_UPDATES_PER_HOUR：                        -- 定义每小时允许执行的更新数</span><br><span class="line">    MAX_CONNECTIONS_PER_HOUR：                    -- 定义每小时可以建立的连接数</span><br><span class="line">    MAX_USER_CONNECTIONS：                        -- 定义单个用户同时可以建立的连接数</span><br></pre></td></tr></table></figure>
<p>View Code</p>
<p><strong>示例:</strong> <strong>限制用户每小时的查询数量</strong></p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; grant <span class="keyword">select</span> <span class="keyword">on</span> *.* <span class="keyword">to</span> <span class="string">'用户名'</span>@<span class="string">'IP地址'</span> identified <span class="keyword">by</span> <span class="string">'123456'</span> <span class="keyword">with</span> max_queries_per_hour <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h3 id="查看权限"><a href="#查看权限" class="headerlink" title="查看权限"></a>查看权限</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">grants</span> <span class="keyword">for</span> <span class="string">'用户'</span>@<span class="string">'IP地址'</span></span><br></pre></td></tr></table></figure>
<h3 id="回收权限"><a href="#回收权限" class="headerlink" title="回收权限"></a>回收权限</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--语法：</span></span><br><span class="line">    <span class="keyword">REVOKE</span> 权限列表 <span class="keyword">ON</span> 库名.表名 <span class="keyword">FROM</span> 用户名@‘客户端主机’</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">DELETE</span> <span class="keyword">ON</span> *.*  <span class="keyword">FROM</span> 用户名@’%’;             <span class="comment">-- 回收部分权限</span></span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">FROM</span> 用户名@’%’;             <span class="comment">-- 回收所有权限</span></span><br></pre></td></tr></table></figure>
<h3 id="修改权限之后一点要刷新"><a href="#修改权限之后一点要刷新" class="headerlink" title="修改权限之后一点要刷新"></a>修改权限之后一点要刷新</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure>
<h4 id="注解-flush-privileges："><a href="#注解-flush-privileges：" class="headerlink" title="注解 flush privileges："></a>注解 flush privileges：</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">flush privileges 命令本质上的作用是将当前<span class="keyword">user</span>和privilige表中的用户信息/权限设置从mysql库(MySQL数据库的内置库)中提取到内存里。</span><br><span class="line">MySQL用户数据和权限有修改后，搜索希望在<span class="string">"不重启MySQL服务"</span>的情况下直接生效，那么就需要执行这个命令</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<h1 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">视图是什么?</span><br><span class="line">    本质是一张虚拟的表</span><br><span class="line">    他的数据来自<span class="keyword">select</span>语句</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">有什么用?</span><br><span class="line">    原表安全</span><br><span class="line">    案例:  在一公司中需要一张表保存所有人的薪资信息</span><br><span class="line">           这个表不是所有都能午全看到   老板 财务 可以</span><br><span class="line">           某一个员工 只能看到自己的信息</span><br><span class="line">           所以不能把整个表的信息开发给这个员工</span><br><span class="line"></span><br><span class="line">    功能<span class="number">1</span>,影藏部分数据 开放指定的数据</span><br><span class="line">    功能<span class="number">2</span>,因为视图可以将查询结果保存特性 我可以用视图 来达到减少书写<span class="keyword">sql</span>的次数</span><br><span class="line">        例如:<span class="keyword">select</span> *<span class="keyword">from</span> emp <span class="keyword">where</span> dept_id = (<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> dept <span class="keyword">where</span> <span class="keyword">name</span> = <span class="string">"市场"</span>);</span><br><span class="line">            要查询市场的人</span><br><span class="line">            将查询结果作为一个视图 以后在使用到这个需求 就直接查看视图</span><br><span class="line"></span><br><span class="line">如何使用</span><br><span class="line">    创建视图</span><br><span class="line">    <span class="keyword">create</span> <span class="keyword">view</span> test_view <span class="keyword">as</span> <span class="keyword">select</span> *<span class="keyword">from</span> t1;</span><br><span class="line"></span><br><span class="line">特点:</span><br><span class="line">    1.每次对视图进行的查询 其实都是再次执行了 as 后面的查询语句</span><br><span class="line">    2.可以对视图进行修改  修改会同步到原表</span><br><span class="line">    3.视图是永久存储的  存储的不是数据  而就是一条 as sql语句</span><br><span class="line"></span><br><span class="line">基本不用 因为 你得程序开放的数据  不是开放sql语句  而开放的是查询结果</span><br></pre></td></tr></table></figure>
<h3 id="1-为什么使用视图"><a href="#1-为什么使用视图" class="headerlink" title="1.为什么使用视图"></a>1.为什么使用视图</h3><p>​    为了提高复杂SQL语句的复用性和表操作的安全性（例如：工资字段不想展示给所有能查看该查询结果的人），MySQL提供了视图特性。所谓视图，本质上是一种虚拟表，其内容与真实的表相似，包含一系列带有名称的列和行数据。但是，视图并不在数据库中以存储数据值的形式存在。行和列的数据来自定义视图的查询所引用基本表，并且在具体使用视图时动态生成。<br>视图有如下特点; </p>
<pre><code>1. 视图的列可以来自不同的表，是表的抽象和逻辑意义上建立的新关系。 
2. 视图是由基本表（实表）产生的表（虚表）。 
3. 视图的建立和删除不影响基本表。 
4. 对视图内容的更新（添加、删除和修改）直接影响基本表。 
5. 当视图来自多个基本表时，不允许添加和删除数据。
</code></pre><h3 id="2-创建视图"><a href="#2-创建视图" class="headerlink" title="2.创建视图"></a><strong>2.创建视图</strong></h3><p>在创建视图时，首先要确保拥有CREATE VIEW的权限，并且同时确保对创建视图所引用的表也具有相应的权限。<br><strong>2.1 创建视图的语法形式：</strong>     虽然视图可以被看成是一种虚拟表，但是其在物理上是不存在的，即数据库管理系统没有专门的位置为视图存储数据。根据视图的概念发现其数据来源于查询语句，因此创建视图的语法为：</p>
<p>CREATE VIEW view_name AS 查询语句<br>//说明：和创建表一样，视图名不能和表名、也不能和其他视图名重名。视图的功能实际就是封装了复杂的查询语句。</p>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> view_test;  //选择一个自己创建的库</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_product( //创建表</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span>,</span><br><span class="line">  pname <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">  price <span class="built_in">decimal</span>(<span class="number">8</span>,<span class="number">2</span>)</span><br><span class="line">); </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_product <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'apple'</span>,<span class="number">6.5</span>); //向表中插入数据</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_product <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'orange'</span>,<span class="number">3</span>); //向表中插入数据</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> view_product <span class="keyword">as</span> <span class="keyword">select</span> <span class="keyword">id</span>,pname <span class="keyword">from</span> t_product; //创建视图</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> view_product;</span><br></pre></td></tr></table></figure>
<p>结果为：</p>
<p><img src="/2019/03/19/数据库笔记2/877318-20170731215314052-428578611.png" alt="img"><br>//其实在创建视图时实际代码里写的是一个表查询语句，只不过把这个查询语句封装起来重新起了一个名字，方便可以重复使用。<br>//再者，安全性方面可以隐藏一些不希望看到的字段，比如这里的价格字段。<br>//注意：在SQL语句的命名规范中，视图一般以view_xxx或者v_xxx的样式来命名。视图的查询语句和表的查询语句相同。</p>
<p><strong>2.2 创建各种视图：</strong>     由于视图的功能实际上时封装查询语句，那么是不是任何形式的查询语句都可以封装在视图中呢？ </p>
<p>封装使用聚合函数（SUM、MIN、MAX、COUNT等）查询语句的视图： 示例：<br>首先准备需要用到的两张表及其初始化数据;</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> TABLE t_group(</span><br><span class="line">  id INT <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">  NAME VARCHAR(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> TABLE t_student(</span><br><span class="line">  id INT <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">  NAME VARCHAR(<span class="number">20</span>),</span><br><span class="line">  sex CHAR(<span class="number">1</span>),</span><br><span class="line">  group_id INT,</span><br><span class="line">  FOREIGN <span class="keyword">KEY</span> (group_id) REFERENCES t_group (id)</span><br><span class="line">);</span><br><span class="line">//t_group表中插入数据</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_group (NAME) <span class="keyword">VALUES</span>(<span class="string">'group_1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_group (NAME) <span class="keyword">VALUES</span>(<span class="string">'group_2'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_group (NAME) <span class="keyword">VALUES</span>(<span class="string">'group_3'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_group (NAME) <span class="keyword">VALUES</span>(<span class="string">'group_4'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_group (NAME) <span class="keyword">VALUES</span>(<span class="string">'group_5'</span>);</span><br><span class="line">//t_student表中插入数据</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (NAME,sex,group_id) <span class="keyword">VALUES</span>(<span class="string">'yuan_1'</span>,<span class="string">'M'</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (NAME,sex,group_id) <span class="keyword">VALUES</span>(<span class="string">'yuan_2'</span>,<span class="string">'M'</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (NAME,sex,group_id) <span class="keyword">VALUES</span>(<span class="string">'yuan_3'</span>,<span class="string">'M'</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (NAME,sex,group_id) <span class="keyword">VALUES</span>(<span class="string">'yuan_4'</span>,<span class="string">'W'</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (NAME,sex,group_id) <span class="keyword">VALUES</span>(<span class="string">'yuan_5'</span>,<span class="string">'W'</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (NAME,sex,group_id) <span class="keyword">VALUES</span>(<span class="string">'yuan_6'</span>,<span class="string">'W'</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (NAME,sex,group_id) <span class="keyword">VALUES</span>(<span class="string">'yuan_7'</span>,<span class="string">'M'</span>,<span class="number">3</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (NAME,sex,group_id) <span class="keyword">VALUES</span>(<span class="string">'yuan_8'</span>,<span class="string">'W'</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (NAME,sex,group_id) <span class="keyword">VALUES</span>(<span class="string">'yuan_9'</span>,<span class="string">'W'</span>,<span class="number">4</span>);</span><br><span class="line">================================================================</span><br><span class="line">mysql&gt; <span class="keyword">create</span> <span class="keyword">view</span> view_test2 <span class="keyword">as</span> <span class="keyword">select</span> <span class="built_in">count</span>(name) <span class="keyword">from</span> t_student;</span><br><span class="line">Query OK, 0 rows affected (0.71 sec)</span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> view_test2;</span><br><span class="line">+-------------+</span><br><span class="line">| count(name) |</span><br><span class="line">+-------------+</span><br><span class="line">|      9      |</span><br><span class="line">+-------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>
<p>2.2.3 封装了实现排序功能（ORDER BY）查询语句的视图：</p>
<p>示例：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create view view<span class="emphasis">_test3 as select name from t_</span>student order by id desc;</span><br><span class="line">Query OK, 0 rows affected (0.06 sec)</span><br><span class="line">mysql&gt; select * from view<span class="emphasis">_test3;</span></span><br><span class="line"><span class="emphasis">+--------+</span></span><br><span class="line"><span class="emphasis">| name   |</span></span><br><span class="line"><span class="emphasis">+--------+</span></span><br><span class="line"><span class="emphasis">| yuan_</span>9 |</span><br><span class="line">| yuan<span class="emphasis">_8 |</span></span><br><span class="line"><span class="emphasis">| yuan_</span>7 |</span><br><span class="line">| yuan<span class="emphasis">_6 |</span></span><br><span class="line"><span class="emphasis">| yuan_</span>5 |</span><br><span class="line">| yuan<span class="emphasis">_4 |</span></span><br><span class="line"><span class="emphasis">| yuan_</span>3 |</span><br><span class="line">| yuan<span class="emphasis">_2 |</span></span><br><span class="line"><span class="emphasis">| yuan_</span>1 |</span><br><span class="line"><span class="code">+--------+</span></span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>2.2.4 封装了实现表内连接查询语句的视图：</p>
<p>示例：（第二组学生的姓名）</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create view view<span class="emphasis">_test5 as select s.name from t_</span>student s,t<span class="emphasis">_group g where s.group_</span>id=g.id and g.id=2;</span><br><span class="line">Query OK, 0 rows affected (0.07 sec)</span><br><span class="line">mysql&gt; select * from view<span class="emphasis">_test5;</span></span><br><span class="line"><span class="emphasis">+--------+</span></span><br><span class="line"><span class="emphasis">| name   |</span></span><br><span class="line"><span class="emphasis">+--------+</span></span><br><span class="line"><span class="emphasis">| yuan_</span>3 |</span><br><span class="line">| yuan<span class="emphasis">_4 |</span></span><br><span class="line"><span class="emphasis">| yuan_</span>5 |</span><br><span class="line">| yuan<span class="emphasis">_6 |</span></span><br><span class="line"><span class="emphasis">+-------+</span></span><br><span class="line"><span class="emphasis">4 rows in set (0.00 sec)</span></span><br></pre></td></tr></table></figure>
<p>2.2.6 封装了实现子查询相关查询语句的视图：</p>
<p>示例：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create view view<span class="emphasis">_test7 as select s.name from t_</span>student s where s.id in(select id from t<span class="emphasis">_group);</span></span><br><span class="line"><span class="emphasis">Query OK, 0 rows affected (0.08 sec)</span></span><br><span class="line"><span class="emphasis">mysql&gt; select * from view_</span>test7;</span><br><span class="line"><span class="code">+--------+</span></span><br><span class="line">| name   |</span><br><span class="line"><span class="code">+--------+</span></span><br><span class="line">| yuan<span class="emphasis">_1 |</span></span><br><span class="line"><span class="emphasis">| yuan_</span>2 |</span><br><span class="line">| yuan<span class="emphasis">_3 |</span></span><br><span class="line"><span class="emphasis">| yuan_</span>4 |</span><br><span class="line">| yuan<span class="emphasis">_5 |</span></span><br><span class="line"><span class="emphasis">+--------+</span></span><br><span class="line"><span class="emphasis">5 rows in set (0.00 sec)</span></span><br></pre></td></tr></table></figure>
<p>2.2.7 封装了实现记录联合（UNION和UNION ALL）查询语句的视图：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create view view_test8 as select id,name from t_student union all select id,name from t_group;</span><br><span class="line">Query OK, 0 rows affected (0.08 sec)</span><br><span class="line">mysql&gt; select <span class="symbol">*</span> from view_test8;</span><br><span class="line">+----+---------+</span><br><span class="line">|<span class="string"> id </span>|<span class="string"> name    </span>|</span><br><span class="line">+----+---------+</span><br><span class="line">|<span class="string">  1 </span>|<span class="string"> yuan_1  </span>|</span><br><span class="line">|<span class="string">  2 </span>|<span class="string"> yuan_2  </span>|</span><br><span class="line">|<span class="string">  3 </span>|<span class="string"> yuan_3  </span>|</span><br><span class="line">|<span class="string">  4 </span>|<span class="string"> yuan_4  </span>|</span><br><span class="line">|<span class="string">  5 </span>|<span class="string"> yuan_5  </span>|</span><br><span class="line">|<span class="string">  6 </span>|<span class="string"> yuan_6  </span>|</span><br><span class="line">|<span class="string">  7 </span>|<span class="string"> yuan_7  </span>|</span><br><span class="line">|<span class="string">  8 </span>|<span class="string"> yuan_8  </span>|</span><br><span class="line">|<span class="string">  9 </span>|<span class="string"> yuan_9  </span>|</span><br><span class="line">|<span class="string">  1 </span>|<span class="string"> group_1 </span>|</span><br><span class="line">|<span class="string">  2 </span>|<span class="string"> group_2 </span>|</span><br><span class="line">|<span class="string">  3 </span>|<span class="string"> group_3 </span>|</span><br><span class="line">|<span class="string">  4 </span>|<span class="string"> group_4 </span>|</span><br><span class="line">|<span class="string">  5 </span>|<span class="string"> group_5 </span>|</span><br><span class="line">+----+---------+</span><br><span class="line">14 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>
<h3 id="3-查看视图"><a href="#3-查看视图" class="headerlink" title="3.查看视图"></a>3.查看视图</h3><p><strong>3.1 SHOW TABLES语句查看视图名：</strong> 执行SHOW TABLES 语句时不仅可以显示表的名字，同时也是显示出视图的名字。</p>
<p>示例：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line"><span class="code">+-----------------+</span></span><br><span class="line">| Tables<span class="emphasis">_in_</span>test2 |</span><br><span class="line"><span class="code">+-----------------+</span></span><br><span class="line">| goods           |</span><br><span class="line">| order           |</span><br><span class="line">| orders          |</span><br><span class="line">| person          |</span><br><span class="line">| t<span class="emphasis">_group         |</span></span><br><span class="line"><span class="emphasis">| t_</span>product       |</span><br><span class="line">| t<span class="emphasis">_student       |</span></span><br><span class="line"><span class="emphasis">| view_</span>product    |</span><br><span class="line">| view<span class="emphasis">_test2      |</span></span><br><span class="line"><span class="emphasis">| view_</span>test3      |</span><br><span class="line">| view<span class="emphasis">_test5      |</span></span><br><span class="line"><span class="emphasis">| view_</span>test7      |</span><br><span class="line">| view<span class="emphasis">_test8      |</span></span><br><span class="line"><span class="emphasis">+-----------------+</span></span><br><span class="line"><span class="emphasis">13 rows in set (0.00 sec</span></span><br></pre></td></tr></table></figure>
<p> <strong>3.2 SHOW TABLE STATUS语句查看视图详细信息：</strong> </p>
<p>和SHOW TABLES语句一样，SHOW TABLE STATUS语句不仅会显示表的详细信息，同时也会显示视图的详细信息。</p>
<p>语法如下：<br>SHOW TABLE STATUS [FROM db_name] [LIKE ‘pattern’]<br>//参数db_name用来设置数据库，SHOW TABLES STATUS表示将显示所设置库的表和视图的详细信息。<br>//设置LIKE关键字，可以查看某一个具体表或视图的详细信息。例如： SHOW TABLE STATUS FROM zhaojd LIKE ‘t_group’ \G</p>
<p><strong>3.3 SHOW CREATE VIEW语句查看视图定义信息：</strong></p>
<p>语法为：<br> SHOW CREATE VIEW viewname;</p>
<p><strong>3.4 DESCRIBE | DESC 语句查看视图定义信息：</strong></p>
<p>语法为：<br> DESCRIBE | DESC viewname;</p>
<p><strong>3.5 通过系统表查看视图信息：</strong> 当MySQL安装成功后，会自动创建系统数据库infomation_schema。在该数据库中存在一个包含视图信息的表格，可以通过查看表格views来查看所有视图的相关信息。</p>
<p>示例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use information_schema;</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> views <span class="keyword">where</span> table_name=<span class="string">'view_test7'</span> \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">       TABLE_CATALOG: def</span><br><span class="line">        TABLE_SCHEMA: test2</span><br><span class="line">          TABLE_NAME: view_test7</span><br><span class="line">     VIEW_DEFINITION: <span class="keyword">select</span> <span class="symbol">`s`</span>.<span class="symbol">`NAME`</span> <span class="keyword">AS</span> <span class="symbol">`name`</span> <span class="keyword">from</span> <span class="symbol">`test2`</span>.<span class="symbol">`t_student`</span> <span class="symbol">`s`</span> </span><br><span class="line">   　　　　　　　　　　　 <span class="keyword">where</span> <span class="symbol">`s`</span>.<span class="symbol">`id`</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="symbol">`test2`</span>.<span class="symbol">`t_group`</span>.<span class="symbol">`id`</span> <span class="keyword">from</span> <span class="symbol">`test2`</span>.<span class="symbol">`t_group`</span>)</span><br><span class="line">        CHECK_OPTION: NONE</span><br><span class="line">        IS_UPDATABLE: YES</span><br><span class="line">             DEFINER: root@localhost</span><br><span class="line">       SECURITY_TYPE: DEFINER</span><br><span class="line">CHARACTER_SET_CLIENT: utf8</span><br><span class="line">COLLATION_CONNECTION: utf8_general_ci</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<h3 id="4-删除视图"><a href="#4-删除视图" class="headerlink" title="4.删除视图"></a>4.删除视图</h3><p>在删除视图时首先要确保拥有删除视图的权限。</p>
<p>语法为：<br>DROP VIEW view_name [,view_name] ……<br>//从语法可以看出，DROP VIEW一次可以删除多个视图<br>示例：</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="built_in">drop</span> <span class="built_in">view</span> view_test1,view_test2;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="built_in">rows</span> <span class="built_in">affected</span> (<span class="number">0.01</span> sec)</span><br><span class="line">mysql&gt; <span class="keyword">show</span> tables;</span><br></pre></td></tr></table></figure>
<h3 id="5-修改视图"><a href="#5-修改视图" class="headerlink" title="5.修改视图"></a>5.修改视图</h3><p><strong>5.1 CREATE OR REPLACE VIEW语句修改视图：</strong> 对于已经创建好的表，尤其是已经有大量数据的表，通过先删除，然后再按照新的表定义重新建表的方式来修改表，需要做很多额外的工作，例如数据的重载等。可是对于视图来说，由于是“虚表”，并没有存储数据，所以完全可以通过该方式来修改视图。</p>
<p>实现思路就是：先删除同名的视图，然后再根据新的需求创建新的视图即可。</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> view_name; </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> view_name <span class="keyword">as</span> 查询语句;</span><br></pre></td></tr></table></figure>
<p>但是如果每次修改视图，都是先删除视图，然后再次创建一个同名的视图，则显得非常麻烦。于是MySQL提供了更方便的实现替换的创建视图的语法，完整语法为：</p>
<p>CREATE OR REPLACE VIEW view_name as 查询语句；</p>
<p> <strong>5.2 ALTER语句修改视图：</strong></p>
<p>语法为：</p>
<p>ALTER VIEW view_name as 查询语句;</p>
<h3 id="6-利用视图操作基本表"><a href="#6-利用视图操作基本表" class="headerlink" title="6.利用视图操作基本表"></a><strong>6.利用视图操作基本表</strong></h3><p>再MySQL中可以通常视图检索基本表数据，这是视图最基本的应用，除此之后还可以通过视图修改基本表中的数据。<br><strong>6.1检索（查询）数据：</strong>     通过视图查询数据，与通过表进行查询完全相同，只不过通过视图查询表更安全，更简单实用。只需要把表名换成视图名即可。<br><strong>6.2利用视图操作基本表数据：</strong>     由于视图是“虚表”，所以对视图数据进行的更新操作，实际上是对其基本表数据进行的更新操作。在具体更新视图数据时，需要注意以下两点; </p>
<pre><code>1. 对视图数据进行添加、删除直接影响基本表。 
2. 视图来自于多个基本表时，不允许添加、删除数据。 
视图中的添加数据操作、删除数据操作、更新数据操作的语法同表完全相同。只是将表名换成视图名即可。
</code></pre><p><img src="/2019/03/19/数据库笔记2/1553228331508.png" alt="1553228331508"></p>
<h1 id="Mysql–内部"><a href="#Mysql–内部" class="headerlink" title="Mysql–内部"></a>Mysql–内部</h1><h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><h3 id="什么是触发器？"><a href="#什么是触发器？" class="headerlink" title="什么是触发器？"></a>什么是触发器？</h3><p>触发器是数据库的一个程序，他是用来监听着数据表的某个行为，一旦数据表的这个行为发生了，马上执行相应的sql语句  </p>
<h3 id="触发器的语法结构："><a href="#触发器的语法结构：" class="headerlink" title="触发器的语法结构："></a>触发器的语法结构：</h3><p>create trigger 触发器的名称触发器事件 on 监听的表名 for each row 行为发生后执行的sql语句 </p>
<p>注意：行为发生后执行的sql语句可以是一句SQL语句，或者用 BEGIN 和 END 包含的多条语句。</p>
<p>触发器事件两个点：</p>
<ul>
<li>触发器事件发生的时间—–是在监听的表的行为 after before 常用的是after</li>
<li>触发器执行的内容：增删改</li>
</ul>
<p><img src="/2019/03/19/数据库笔记2/1553189172349.png" alt="1553189172349"></p>
<p><img src="/2019/03/19/数据库笔记2/1553189217089.png" alt="1553189217089"></p>
<h3 id="建立一个表"><a href="#建立一个表" class="headerlink" title="建立一个表"></a>建立一个表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> cmd (</span><br><span class="line">        <span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> auto_increment,</span><br><span class="line">        <span class="keyword">USER</span> <span class="built_in">CHAR</span> (<span class="number">32</span>),</span><br><span class="line">        priv <span class="built_in">CHAR</span> (<span class="number">10</span>),</span><br><span class="line">        cmd <span class="built_in">CHAR</span> (<span class="number">64</span>),</span><br><span class="line">        sub_time datetime, <span class="comment">#提交时间</span></span><br><span class="line">        <span class="keyword">success</span> enum (<span class="string">'yes'</span>, <span class="string">'no'</span>) <span class="comment">#0代表执行失败</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="建立一个要被触发的表"><a href="#建立一个要被触发的表" class="headerlink" title="建立一个要被触发的表"></a>建立一个要被触发的表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> errlog (</span><br><span class="line">        <span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> auto_increment,</span><br><span class="line">        err_id <span class="built_in">int</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="建立触发器"><a href="#建立触发器" class="headerlink" title="建立触发器"></a>建立触发器</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$  <span class="comment">#把;变换成$$,让下面的代码完整运行</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_after_insert_cmd <span class="keyword">AFTER</span> <span class="keyword">INSERT</span> <span class="keyword">ON</span> cmd <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">if</span> NEW.success = <span class="string">'no'</span> <span class="keyword">then</span>   <span class="comment"># NEW(新的信息,也就是插入cmd的信息)</span></span><br><span class="line">                <span class="keyword">insert</span> <span class="keyword">into</span> errlog(err_id) <span class="keyword">values</span>(NEW.id);  <span class="comment"># 插入语法.当上面的条件成立</span></span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">END</span> $$  <span class="comment"># 制造触发器完毕</span></span><br><span class="line">delimiter ; <span class="comment"># 将符号还原成;</span></span><br></pre></td></tr></table></figure>
<h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> cmd (</span><br><span class="line">        <span class="keyword">USER</span>,</span><br><span class="line">        priv,</span><br><span class="line">        cmd,</span><br><span class="line">        sub_time,</span><br><span class="line">        <span class="keyword">success</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">        (<span class="string">'egon'</span>,<span class="string">'0755'</span>,<span class="string">'ls -l /etc'</span>,<span class="keyword">NOW</span>(),<span class="string">'yes'</span>),</span><br><span class="line">        (<span class="string">'egon'</span>,<span class="string">'0755'</span>,<span class="string">'cat /etc/passwd'</span>,<span class="keyword">NOW</span>(),<span class="string">'no'</span>),</span><br><span class="line">        (<span class="string">'egon'</span>,<span class="string">'0755'</span>,<span class="string">'useradd xxx'</span>,<span class="keyword">NOW</span>(),<span class="string">'no'</span>),</span><br><span class="line">        (<span class="string">'egon'</span>,<span class="string">'0755'</span>,<span class="string">'ps aux'</span>,<span class="keyword">NOW</span>(),<span class="string">'yes'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="删除触发器"><a href="#删除触发器" class="headerlink" title="删除触发器"></a>删除触发器</h3><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> tri_after_insert_cmd;</span><br></pre></td></tr></table></figure>
<p>我们常用的操作数据库语言SQL语句在执行的时候需要要先编译，然后执行，而存储过程（Stored Procedure）是一组为了完成特定功能的SQL语句集，经编译后存储在数据库中，用户通过指定存储过程的名字并给定参数（如果该存储过程带有参数）来调用执行它。</p>
<h3 id="触发器案例研究"><a href="#触发器案例研究" class="headerlink" title="触发器案例研究"></a>触发器案例研究</h3><p>一旦生成订单，对应的库存表要减去相应的数据 </p>
<h4 id="1）建两张表-：一个商品goods表-一个订单order表"><a href="#1）建两张表-：一个商品goods表-一个订单order表" class="headerlink" title="(1）建两张表 ：一个商品goods表 一个订单order表"></a>(1）建两张表 ：一个商品goods表 一个订单order表</h4><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-- </span>创建表</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">create table goods( goods<span class="emphasis">_id int primary key auto_</span>increment,</span><br><span class="line"><span class="code">                    goods_name varchar(64),</span></span><br><span class="line"><span class="code">                    shop_price decimal(10,2),</span></span><br><span class="line"><span class="code">                    goods_number int)charset=utf8;</span></span><br><span class="line"></span><br><span class="line">create table orders(goods<span class="emphasis">_id int primary key auto_</span>increment,</span><br><span class="line"><span class="code">                    goods_name varchar(64),</span></span><br><span class="line"><span class="code">                    buy_number int)charset=utf8;</span></span><br><span class="line"><span class="bullet">-- </span>插入数据</span><br><span class="line"></span><br><span class="line">insert into goods values(null,<span class="emphasis">'nokiaN85'</span>,2000,35),</span><br><span class="line"><span class="code">                        (null,'iphone4S',4500,30),</span></span><br><span class="line"><span class="code">                        (null,'Lnmia',5000,40),</span></span><br><span class="line"><span class="code">                        (null,'samsung',4200,20); </span></span><br><span class="line"></span><br><span class="line">mysql&gt; select*from goods;</span><br><span class="line"><span class="code">+---------------+</span>-------------------<span class="code">+-------------------+</span>----------------------+</span><br><span class="line">| goods<span class="emphasis">_id      | goods_</span>name        | shop<span class="emphasis">_price        | goods_</span>number         |</span><br><span class="line"><span class="code">+---------------+</span>-------------------<span class="code">+-------------------+</span>----------------------+</span><br><span class="line">|        1      | nokiaN85          |    2000.00        |           35         |</span><br><span class="line">|        2      | iphone4S          |    4500.00        |           30         |</span><br><span class="line">|        3      | Lnmia             |    5000.00        |           40         |</span><br><span class="line">|        4      | samsung           |    4200.00        |           20         |</span><br><span class="line"><span class="code">+---------------+</span>-------------------<span class="code">+-------------------+</span>----------------------+</span><br></pre></td></tr></table></figure>
<h4 id="2-创建触发器"><a href="#2-创建触发器" class="headerlink" title="(2)创建触发器"></a>(2)创建触发器</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> alter_goods_number <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">on</span> orders <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line">               <span class="keyword">update</span> goods <span class="keyword">set</span> goods_number=goods_number<span class="number">-5</span> <span class="keyword">where</span> goods_id=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'nokiaN85'</span>,<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>*<span class="keyword">from</span> goods;</span><br></pre></td></tr></table></figure>
<h3 id="new和old的使用"><a href="#new和old的使用" class="headerlink" title="new和old的使用"></a>new和old的使用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在 <span class="keyword">INSERT</span> 型触发器中，<span class="keyword">NEW</span> 用来表示将要（<span class="keyword">BEFORE</span>）或已经（<span class="keyword">AFTER</span>）插入的新数据；</span><br><span class="line">在 <span class="keyword">UPDATE</span> 型触发器中，<span class="keyword">OLD</span> 用来表示将要或已经被修改的原数据，<span class="keyword">NEW</span> 用来表示将要或已经修改为的新数据；</span><br><span class="line">在 <span class="keyword">DELETE</span> 型触发器中，<span class="keyword">OLD</span> 用来表示将要或已经被删除的原数据；</span><br></pre></td></tr></table></figure>
<h4 id="关键词new-的使用"><a href="#关键词new-的使用" class="headerlink" title="关键词new 的使用"></a>关键词new 的使用</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> alter_goods_number <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">on</span> orders <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line">      <span class="keyword">update</span> goods <span class="keyword">set</span> goods_number=goods_number-new.buy_number </span><br><span class="line">      <span class="keyword">where</span> <span class="keyword">where</span> goods_id=new.goods_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'samsung'</span>,<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<h4 id="关键词old-的使用："><a href="#关键词old-的使用：" class="headerlink" title="关键词old 的使用："></a>关键词old 的使用：</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> back_goods_number <span class="keyword">after</span> <span class="keyword">delete</span> <span class="keyword">on</span> orders <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">update</span> goods <span class="keyword">set</span> goods_number=goods_number+old.buy_number  </span><br><span class="line">   <span class="keyword">where</span> goods_id=old.goods_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> orders <span class="keyword">where</span> goods_id=<span class="number">7</span>;</span><br></pre></td></tr></table></figure>
<h4 id="更新-update将之前下的订单撤销，再重新下订单"><a href="#更新-update将之前下的订单撤销，再重新下订单" class="headerlink" title="更新 (update将之前下的订单撤销，再重新下订单)"></a>更新 (update将之前下的订单撤销，再重新下订单)</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> update_goods_number <span class="keyword">after</span> <span class="keyword">update</span> <span class="keyword">on</span> orders <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line">       <span class="keyword">update</span> goods <span class="keyword">set</span> goods_number=goods_number+old.buy_number-new.buy_number </span><br><span class="line">       <span class="keyword">where</span> <span class="keyword">where</span> goods_id=new.goods_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> orders <span class="keyword">set</span> buy_number = <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<h3 id="查看触发器"><a href="#查看触发器" class="headerlink" title="查看触发器"></a>查看触发器</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TRIGGERS</span> [<span class="keyword">FROM</span> schema_name];</span><br></pre></td></tr></table></figure>
<p>其中，schema_name 即 Schema 的名称，在 MySQL 中 Schema 和 Database 是一样的，也就是说，可以指定数据库名，这样就 不必先USE database_name了 </p>
<h3 id="删除触发器-1"><a href="#删除触发器-1" class="headerlink" title="删除触发器"></a>删除触发器</h3><p>和删除数据库、删除表格一样，删除触发器的语法如下：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TRIGGER [<span class="string">IF EXISTS</span>][<span class="symbol">schema_name.</span>]trigger_name</span><br></pre></td></tr></table></figure>
<h3 id="触发器的执行顺序"><a href="#触发器的执行顺序" class="headerlink" title="触发器的执行顺序"></a>触发器的执行顺序</h3><p>我们建立的数据库一般都是 InnoDB 数据库，其上建立的表是事务性表，也就是事务安全的。这时，若SQL语句或触发器执行失败，MySQL 会回滚事务，有：</p>
<p>①如果 BEFORE 触发器执行失败，SQL 无法正确执行。<br>②SQL 执行失败时，AFTER 型触发器不会触发。<br>③AFTER 类型的触发器执行失败，SQL 会回滚。</p>
<h2 id="一、存储过程"><a href="#一、存储过程" class="headerlink" title="一、存储过程"></a>一、存储过程</h2><h3 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h3><p><img src="/2019/03/19/数据库笔记2/1553176568981.png" alt="1553176568981"></p>
<h3 id="存储过程（Stored-Procedure）是"><a href="#存储过程（Stored-Procedure）是" class="headerlink" title="　　存储过程（Stored Procedure）是"></a>　　存储过程（Stored Procedure）是</h3><p>在大型数据库系统中，一组为了完成特定功能的SQL语句集，经编译后存储在数据库中，用户<br>通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来执行它。而我们常用的操作数据库语言SQL语句在执行的时<br>候需要要先编译，然后执行，所以执行的效率没有存储过程高。</p>
<h3 id="存储过程优点如下："><a href="#存储过程优点如下：" class="headerlink" title="　　存储过程优点如下："></a>　　存储过程优点如下：</h3><p>重复使用。存储过程可以重复使用，从而可以减少数据库开发人员的工作量。提高性能。存储过程在创建的时候在进行了编译，将来使用的时候不再重新翻译。一般的SQL语句每执行一次就需要编译一次，所以使用存储过程提高了效率。减少网络流量。存储过程位于服务器上，调用的时候只需要传递存储过程的名称以及参数就可以了，因此降低了网络传输的数据量。安全性。参数化的存储过程可以防止SQL注入式攻击，而且可以将Grant、Deny以及Revoke权限应用于存储过程。</p>
<h3 id="存储过程简单语法："><a href="#存储过程简单语法：" class="headerlink" title="　　存储过程简单语法："></a>　　存储过程简单语法：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE 存储过程名称(</span><br><span class="line"></span><br><span class="line">　　    输入输出类型 变量名称 类型,</span><br><span class="line">       ...　　</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">　　-- 声明， 语句要完成的操作，增删改查。。。</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
<h2 id="二、参数介绍示例"><a href="#二、参数介绍示例" class="headerlink" title="二、参数介绍示例"></a>二、参数介绍示例</h2><h3 id="无参存储过程"><a href="#无参存储过程" class="headerlink" title="无参存储过程"></a>无参存储过程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># 无参</span><br><span class="line">delimiter $$</span><br><span class="line">create procedure p1()</span><br><span class="line">BEGIN</span><br><span class="line">    select * from blog;</span><br><span class="line">END $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line">create table s1(</span><br><span class="line">id int,</span><br><span class="line">name varchar(20),</span><br><span class="line">gender char(6),</span><br><span class="line">email varchar(50)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">call db5.s1;</span><br><span class="line"></span><br><span class="line">delimiter $$</span><br><span class="line">create procedure p2()</span><br><span class="line">BEGIN</span><br><span class="line">    declare n int default 1;</span><br><span class="line">    while (n &lt; 100) do</span><br><span class="line">        insert into s1 values(n,concat(&apos;egon&apos;,n),</span><br><span class="line">        &apos;male&apos;,concat(&apos;egon&apos;,n,&apos;@163.com&apos;));</span><br><span class="line">        set n=n+1;</span><br><span class="line">    end while;</span><br><span class="line">END $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line">call p2()</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553190683630.png" alt="1553190683630"></p>
<h3 id="有参存储过程"><a href="#有参存储过程" class="headerlink" title="有参存储过程"></a>有参存储过程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$</span><br><span class="line">create procedure p3(</span><br><span class="line">    in n int,</span><br><span class="line">    out res int</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">    select * from blog where id &gt; n;</span><br><span class="line">    set res = 0;</span><br><span class="line">END $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"># 直接在mysql中调用：</span><br><span class="line"></span><br><span class="line">mysql&gt; set @x=111;</span><br><span class="line">mysql&gt; call p3(3,@x);</span><br><span class="line">mysql&gt; select @x;</span><br><span class="line">+------+</span><br><span class="line">| @x   |</span><br><span class="line">+------+</span><br><span class="line">|    0 |</span><br><span class="line">+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553191558675.png" alt="1553191558675"></p>
<p>只带IN（输入参数）的存储过程</p>
<p> 　　表示该参数的值必须在调用存储过程时指定，在存储过程中修改该参数的值不能被返回，为默认值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE IF EXISTS proc_person_findById;</span><br><span class="line"></span><br><span class="line">-- 创建存储过程</span><br><span class="line"> CREATE PROCEDURE proc_person_findById(</span><br><span class="line">   in n int</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">     SELECT * FROM person where id=n;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">-- 定义变量</span><br><span class="line">SET @n=2;</span><br><span class="line">-- 调用存储过程</span><br><span class="line">CALL proc_person_findById(@n);</span><br></pre></td></tr></table></figure>
<p>View Code</p>
<p>3、只带OUT（输出参数）的存储过程</p>
<p>　　该值可在存储过程内部被改变，并可返回。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER !</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE Procdure_out(</span><br><span class="line">  OUT n INT(11)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">BEGIN</span><br><span class="line">    SELECT COUNT(*) INTO n FROM person;</span><br><span class="line">END!</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">CALL Procdure_out(@n);</span><br><span class="line"></span><br><span class="line">SELECT @n AS &quot;总数&quot;;</span><br></pre></td></tr></table></figure>
<p>View Code</p>
<p>4、带IN（输入参数）和OUT（输出参数）,调用时指定，并且可被改变和返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER !</span><br><span class="line"></span><br><span class="line">DROP PROCEDURE IF EXISTS proc_person_findInfoById; </span><br><span class="line"></span><br><span class="line">-- 创建存储过程</span><br><span class="line">CREATE PROCEDURE proc_person_findInfoById(</span><br><span class="line">    IN n INT(11), </span><br><span class="line">    OUT pusername VARCHAR(255), </span><br><span class="line">    OUT page INT(11)</span><br><span class="line">)</span><br><span class="line">BEGIN </span><br><span class="line">     SELECT username, age INTO pusername, page FROM person WHERE id=n;</span><br><span class="line">END!</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">-- 定义变量</span><br><span class="line">SET @id=1;</span><br><span class="line">-- 调用存储过程</span><br><span class="line">CALL proc_person_findInfoById(@id,@username, @age);</span><br><span class="line">SELECT @username as &apos;用户名&apos;, @age &apos;年龄&apos;;</span><br></pre></td></tr></table></figure>
<p>View Code</p>
<p>5、带INOUT（输入输出）参数的存储过程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER !</span><br><span class="line"></span><br><span class="line">DROP PROCEDURE IF EXISTS proc_person_findInfoById; </span><br><span class="line"></span><br><span class="line">-- 创建存储过程</span><br><span class="line">CREATE PROCEDURE proc_person_findInfoById(</span><br><span class="line">    INOUT n INT</span><br><span class="line">)</span><br><span class="line">BEGIN </span><br><span class="line">     SELECT age INTO n FROM person WHERE id=n;</span><br><span class="line">END!</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">-- 定义变量</span><br><span class="line">SET @id=2;</span><br><span class="line">-- 调用存储过程</span><br><span class="line">CALL proc_person_findInfoById(@age);</span><br><span class="line">SELECT @age &apos;年龄&apos;;</span><br></pre></td></tr></table></figure>
<p>View Code</p>
<p>注意：关于输入输出参数</p>
<p>IN为输入， 定义参数时，可以不加，不加则默认为输入参数。OUT为输出，定义参数时，必须加上。INOUT为输入和输出，必须加上。表示该参数可以输入也可在处理后存放结果进行输出。</p>
<h3 id="pymysql调用存储过程"><a href="#pymysql调用存储过程" class="headerlink" title="pymysql调用存储过程"></a>pymysql调用存储过程</h3><p>cursor.callproc(‘p4’,(3,111))<br>调用pymysql里的callproc方法,只有在这端的连接上才能查询到那个变量</p>
<pre><code>#set @_p4_0 = 3; set @_p4_1 = 111
</code></pre><p>print(cursor.fetchall())<br>cursor.execute(‘select @_p4_1;’)<br>print(cursor.fetchone())</p>
<p><img src="/2019/03/19/数据库笔记2/1553192221910.png" alt="1553192221910"></p>
<p><img src="/2019/03/19/数据库笔记2/1553192419145.png" alt="1553192419145"></p>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p><img src="/2019/03/19/数据库笔记2/1553224301567.png" alt="1553224301567"></p>
<p><img src="/2019/03/19/数据库笔记2/1553224315213.png" alt="1553224315213"></p>
<h1 id="pymysql模块"><a href="#pymysql模块" class="headerlink" title="pymysql模块"></a>pymysql模块</h1><h2 id="连接msyql"><a href="#连接msyql" class="headerlink" title="连接msyql"></a>连接msyql</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">client = pymysql.connect(</span><br><span class="line">    ip=<span class="string">'127.0.0.1'</span>,  <span class="comment"># IP</span></span><br><span class="line">    port=<span class="number">3306</span>,  <span class="comment"># 端口</span></span><br><span class="line">    user=<span class="string">'root'</span>,  <span class="comment"># 账号</span></span><br><span class="line">    password=<span class="string">'123'</span>,  <span class="comment"># 密码</span></span><br><span class="line">    database=<span class="string">'db6'</span>,  <span class="comment"># 库</span></span><br><span class="line">    charset=<span class="string">'utf8'</span>  <span class="comment"># 字符编码</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">cursor = client.cursor(pymysql.cursors.DictCursor)  <span class="comment"># 拿到游标,将拿到的信息转换成字典</span></span><br><span class="line">user_info = [</span><br><span class="line">    (<span class="number">3</span>, <span class="string">"alex"</span>),</span><br><span class="line">    (<span class="number">4</span>, <span class="string">"lxx"</span>),</span><br><span class="line">    (<span class="number">5</span>, <span class="string">"yxx"</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="user-info插入列表里的数据增"><a href="#user-info插入列表里的数据增" class="headerlink" title="user_info插入列表里的数据增"></a>user_info插入列表里的数据增</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> user <span class="keyword">in</span> user_info:</span><br><span class="line">   sql = <span class="string">'insert into t1 values(%s,"%s");'</span> % (user[<span class="number">0</span>], user[<span class="number">1</span>])</span><br><span class="line">   res = cursor.execute(sql)  <span class="comment"># 拼接sql语句</span></span><br></pre></td></tr></table></figure>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql=<span class="string">'insert into t1 values(%s,%s);'</span></span><br><span class="line">cursor.executemany(sql,userinfo)</span><br></pre></td></tr></table></figure>
<h2 id="删除一条信息"><a href="#删除一条信息" class="headerlink" title="删除一条信息"></a>删除一条信息</h2><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cursor.execute('<span class="keyword">delete</span> <span class="keyword">from</span> t1 <span class="keyword">where</span> id=<span class="number">3</span>;')</span><br></pre></td></tr></table></figure>
<h2 id="更改信息"><a href="#更改信息" class="headerlink" title="更改信息"></a>更改信息</h2><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cursor.execute("<span class="keyword">update</span> moneyTable <span class="keyword">set</span> money = money - <span class="number">50</span> <span class="keyword">where</span> name = <span class="string">'小明'</span><span class="string">")</span></span><br><span class="line"><span class="string">    #如果小花的账户出问题了 无法更新数据 那就需要回滚</span></span><br><span class="line"><span class="string">   cursor.execute("</span><span class="keyword">update</span> moneyTable <span class="keyword">set</span> money = money + <span class="number">50</span> <span class="keyword">where</span> name = <span class="string">'小花'</span><span class="string">")</span></span><br></pre></td></tr></table></figure>
<h2 id="查询语句"><a href="#查询语句" class="headerlink" title="查询语句"></a>查询语句</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">user_name = <span class="built_in">input</span>(<span class="string">'请输入账号名:'</span>).strip()</span><br><span class="line">user_password = <span class="built_in">input</span>(<span class="string">'请输入密码:'</span>).strip()</span><br><span class="line"></span><br><span class="line">sql = <span class="string">'select id from user where name=%s and pwd=%s;'</span></span><br><span class="line">rows = <span class="built_in">cursor</span>.<span class="keyword">execute</span>(sql, (user_name, user_password))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> row<span class="variable">s:</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="string">'登陆成功'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">'账号或者密码错误'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="查询语句把结果拿到"><a href="#查询语句把结果拿到" class="headerlink" title="查询语句把结果拿到"></a>查询语句把结果拿到</h2><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sql = '<span class="built_in">select</span> id from user <span class="built_in">where</span> id&gt;<span class="number">3</span>;'</span><br><span class="line">rows = cursor.execute(sql)</span><br><span class="line"><span class="keyword">print</span>(cursor.<span class="built_in">fetchall</span>())  <span class="meta"># 全部拿到,拿过一次第二次拿就没有</span></span><br><span class="line"><span class="keyword">print</span>(cursor.<span class="built_in">fetchone</span>())  <span class="meta"># 拿一条信息</span></span><br><span class="line">cursor.scroll(<span class="number">-1</span>) <span class="meta"># 游标回退1</span></span><br><span class="line"><span class="keyword">print</span>(cursor.<span class="built_in">fetchmany</span>(<span class="number">2</span>))  <span class="meta"># 拿2条信息</span></span><br></pre></td></tr></table></figure>
<h2 id="控制指针-有2种方式-这样就可以实现重复读取信息"><a href="#控制指针-有2种方式-这样就可以实现重复读取信息" class="headerlink" title="控制指针,有2种方式(这样就可以实现重复读取信息)"></a>控制指针,有2种方式(这样就可以实现重复读取信息)</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cursor</span>.scroll(<span class="number">0</span>, <span class="keyword">mode</span>=<span class="string">'absolute'</span>)  # 绝对位置移动(从行首开始)</span><br><span class="line"><span class="built_in">cursor</span>.scroll(<span class="number">3</span>, <span class="keyword">mode</span>=<span class="string">'relative'</span>)  # 相对当前位置移动(相对当前的位置往后移动<span class="number">3</span>条信息)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">cursor</span>.<span class="keyword">execute</span>(sql)</span><br><span class="line">    <span class="built_in">cursor</span>.<span class="keyword">execute</span>(sql)</span><br><span class="line">    <span class="built_in">cursor</span>.<span class="keyword">execute</span>(sql)</span><br><span class="line">    client.commit()</span><br><span class="line">except Exception <span class="keyword">as</span> <span class="keyword">e</span>:</span><br><span class="line">    client.rollback()  # 回溯, 如果上面的sql语句出现了错误那么就会回溯到没有插入数据的时候</span><br><span class="line"></span><br><span class="line">client.commit()  # 要想成功执行SQL语句,必须调用commit插入到数据库</span><br><span class="line"><span class="built_in">cursor</span>.<span class="keyword">close</span>()  # 关闭MYSQL客户端</span><br><span class="line">client.<span class="keyword">close</span>()  # 关闭连接</span><br></pre></td></tr></table></figure>
<h2 id="sql注入问题"><a href="#sql注入问题" class="headerlink" title="sql注入问题"></a>sql注入问题</h2><h3 id="–注入"><a href="#–注入" class="headerlink" title="–注入"></a>–注入</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">最终产生的sql  select <span class="number">*f</span>rom<span class="built_in"> user </span>where<span class="built_in"> user </span>= <span class="string">'yy'</span> -- <span class="string">' and pwd = '</span>987657890<span class="string">';</span></span><br><span class="line"><span class="string">-- 用于mysql注释  意思是 后面的内容忽略掉</span></span><br></pre></td></tr></table></figure>
<h3 id="or注入"><a href="#or注入" class="headerlink" title="or注入"></a>or注入</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"<span class="keyword">select</span> *<span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">user</span> = <span class="string">'axxax'</span> <span class="keyword">or</span> <span class="number">1</span>=<span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>只能避免  黑客 从你的客户端软件注入 sql</p>
<h3 id="黑客模拟客户端发送真正请求"><a href="#黑客模拟客户端发送真正请求" class="headerlink" title="黑客模拟客户端发送真正请求"></a>黑客模拟客户端发送真正请求</h3><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">但是无法避免  中间人攻击(在你的客户端和服务器中间加一个中转服务器)</span><br><span class="line"><span class="meta"># 这样就绕过了客户端的输入限制   此时 只能将 sql合法性验证放在服务器端</span></span><br></pre></td></tr></table></figure>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结:"></a>总结:</h3><p> python如何避免sql注入? 把你的slq(用户输入的)参数 放execute函数的arg参数中  让pymysql 自动帮你屏蔽注入攻击</p>
<h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><h2 id="索引-1"><a href="#索引-1" class="headerlink" title="索引:"></a>索引:</h2><p>本质都是通过不断地缩小想要获取数据的范围来筛选出最终想要的结果，同时把随机的事件变成顺序的事件，也就是说，有了这种索引机制，我们可以总是用同一种查找方式来锁定数据。</p>
<p>对于Innodb，主键毫无疑问是一个聚集索引。但是当一个表没有主键，或者没有一个索引，Innodb会如何处理呢。请看如下规则:</p>
<ul>
<li>如果一个主键被定义了，那么这个主键就是作为聚集索引。</li>
<li>如果没有主键被定义，那么该表的第一个唯一非空索引被作为聚集索引。</li>
<li><p>如果没有主键也没有合适的唯一索引，那么innodb内部会生成一个隐藏的主键作为聚集索引，这个隐藏的主键是一个6个字节的列，该列的值会随着数据的插入自增。</p>
<p>解释：什么叫索引项的排序方式和表中数据记录排序方式一致呢？ 我们把一本字典看做是数据库的表，那么字典的拼音目录就是聚集索引，它按照A-Z排列。实际存储的字也是按A-Z排列的。这就是索引项的排序方式和表中数据记录排序方式一致。 </p>
</li>
</ul>
<h2 id="二-索引语法"><a href="#二-索引语法" class="headerlink" title="二 索引语法"></a>二 索引语法</h2><h3 id="创建索引"><a href="#创建索引" class="headerlink" title="创建索引"></a>创建索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建表时</span></span><br><span class="line"><span class="comment">--语法：</span></span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名 (</span><br><span class="line">                字段名<span class="number">1</span>  数据类型 [完整性约束条件…],</span><br><span class="line">                字段名<span class="number">2</span>  数据类型 [完整性约束条件…],</span><br><span class="line">                [<span class="keyword">UNIQUE</span>]   <span class="keyword">INDEX</span> | <span class="keyword">KEY</span></span><br><span class="line">                [索引名]  (字段名[(长度)]  [<span class="keyword">ASC</span> |<span class="keyword">DESC</span>])</span><br><span class="line">                );</span><br><span class="line"></span><br><span class="line"><span class="comment">--------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--创建普通索引示例：</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp1 (</span><br><span class="line">        <span class="keyword">id</span> <span class="built_in">INT</span>,</span><br><span class="line">        <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) ,</span><br><span class="line">        <span class="keyword">resume</span> <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">        <span class="keyword">INDEX</span> index_emp_name (<span class="keyword">name</span>)</span><br><span class="line">    <span class="comment">--KEY index_dept_name (dept_name)</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--创建唯一索引示例：</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp2 (</span><br><span class="line">        <span class="keyword">id</span> <span class="built_in">INT</span>,</span><br><span class="line">        <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) ,</span><br><span class="line">        bank_num <span class="built_in">CHAR</span>(<span class="number">18</span>) <span class="keyword">UNIQUE</span> ,</span><br><span class="line">        <span class="keyword">resume</span> <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">        <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> index_emp_name (<span class="keyword">name</span>)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建全文索引示例：</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp3 (</span><br><span class="line">        <span class="keyword">id</span> <span class="built_in">INT</span>,</span><br><span class="line">        <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) ,</span><br><span class="line">        <span class="keyword">resume</span> <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">        FULLTEXT <span class="keyword">INDEX</span> index_resume (<span class="keyword">resume</span>)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建多列索引示例：</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp4 (</span><br><span class="line">        <span class="keyword">id</span> <span class="built_in">INT</span>,</span><br><span class="line">        <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) ,</span><br><span class="line">        <span class="keyword">resume</span> <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">        <span class="keyword">INDEX</span> index_name_resume (<span class="keyword">name</span>,<span class="keyword">resume</span>)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">---------------------------------</span></span><br><span class="line">复制代码</span><br><span class="line">添加和删除索引</span><br><span class="line">复制代码</span><br><span class="line"><span class="comment">---添加索引</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">---CREATE在已存在的表上创建索引</span></span><br><span class="line">      <span class="keyword">CREATE</span>  [<span class="keyword">UNIQUE</span>]  <span class="keyword">INDEX</span>  索引名</span><br><span class="line">              <span class="keyword">ON</span> 表名 (字段名[(长度)]  [<span class="keyword">ASC</span> |<span class="keyword">DESC</span>]) ;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">---ALTER TABLE在已存在的表上创建索引</span></span><br><span class="line">    </span><br><span class="line">      <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span>  [<span class="keyword">UNIQUE</span>] <span class="keyword">INDEX</span></span><br><span class="line">                    索引名 (字段名[(长度)]  [<span class="keyword">ASC</span> |<span class="keyword">DESC</span>]) ;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">     <span class="keyword">CREATE</span> <span class="keyword">INDEX</span> index_emp_name <span class="keyword">on</span> emp1(<span class="keyword">name</span>);</span><br><span class="line">     <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp2 <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> index_bank_num(band_num);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除索引</span></span><br><span class="line">    </span><br><span class="line">    语法：<span class="keyword">DROP</span> <span class="keyword">INDEX</span> 索引名 <span class="keyword">on</span> 表名</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">INDEX</span> index_emp_name <span class="keyword">on</span> emp1;</span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">INDEX</span> bank_num <span class="keyword">on</span> emp2;</span><br></pre></td></tr></table></figure>
<h2 id="添加和删除索引"><a href="#添加和删除索引" class="headerlink" title="添加和删除索引"></a>添加和删除索引</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---添加索引</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">---CREATE在已存在的表上创建索引</span></span><br><span class="line">      <span class="keyword">CREATE</span>  [<span class="keyword">UNIQUE</span>]  <span class="keyword">INDEX</span>  索引名</span><br><span class="line">              <span class="keyword">ON</span> 表名 (字段名[(长度)]  [<span class="keyword">ASC</span> |<span class="keyword">DESC</span>]) ;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">---ALTER TABLE在已存在的表上创建索引</span></span><br><span class="line">    </span><br><span class="line">      <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span>  [<span class="keyword">UNIQUE</span>] <span class="keyword">INDEX</span></span><br><span class="line">                    索引名 (字段名[(长度)]  [<span class="keyword">ASC</span> |<span class="keyword">DESC</span>]) ;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">     <span class="keyword">CREATE</span> <span class="keyword">INDEX</span> index_emp_name <span class="keyword">on</span> emp1(<span class="keyword">name</span>);</span><br><span class="line">     <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp2 <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> index_bank_num(band_num);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除索引</span></span><br><span class="line">    </span><br><span class="line">    语法：<span class="keyword">DROP</span> <span class="keyword">INDEX</span> 索引名 <span class="keyword">on</span> 表名</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">INDEX</span> index_emp_name <span class="keyword">on</span> emp1;</span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">INDEX</span> bank_num <span class="keyword">on</span> emp2;</span><br></pre></td></tr></table></figure>
<h2 id="三-索引测试实验"><a href="#三-索引测试实验" class="headerlink" title="三 索引测试实验"></a>三 索引测试实验</h2><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">--创建表</span><br><span class="line"><span class="keyword">create</span> table Indexdb.t1(id int,name varchar(<span class="number">20</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--存储过程</span><br><span class="line"></span><br><span class="line">delimiter $$</span><br><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">autoinsert</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"><span class="title">BEGIN</span></span></span><br><span class="line"><span class="function"><span class="title">declare</span> <span class="title">i</span> <span class="title">int</span> <span class="title">default</span> 1;</span></span><br><span class="line"><span class="keyword">while</span>(i&lt;<span class="number">500000</span>)<span class="keyword">do</span></span><br><span class="line">insert <span class="keyword">into</span> Indexdb.t1 values(i,<span class="string">'yuan'</span>);</span><br><span class="line"><span class="keyword">set</span> i=i+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">while</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line">--调用函数</span><br><span class="line">call autoinsert();</span><br><span class="line"></span><br><span class="line">-- 花费时间比较：</span><br><span class="line">-- 创建索引前</span><br><span class="line">   <span class="keyword">select</span> * <span class="keyword">from</span> Indexdb.t1 <span class="keyword">where</span> id=<span class="number">300000</span>;--<span class="number">0.32</span>s</span><br><span class="line">-- 添加索引 </span><br><span class="line">   <span class="keyword">create</span> <span class="keyword">index</span> index_id <span class="keyword">on</span> Indexdb.t1(id);</span><br><span class="line">-- 创建索引后</span><br><span class="line">   <span class="keyword">select</span> * <span class="keyword">from</span> Indexdb.t1 <span class="keyword">where</span> id=<span class="number">300000</span>;--<span class="number">0.00</span>s</span><br></pre></td></tr></table></figure>
<p>table</p>
<p> <img src="/2019/03/19/数据库笔记2/1553241983517.png" alt="1553241983517"></p>
<p><img src="/2019/03/19/数据库笔记2/1553229877558.png" alt="1553229877558"></p>
<p><img src="/2019/03/19/数据库笔记2/1553238138427.png" alt="1553238138427"></p>
<p><img src="/2019/03/19/数据库笔记2/1553238271498.png" alt="1553238271498"></p>
<p><img src="/2019/03/19/数据库笔记2/1553239843193.png" alt="1553239843193"></p>
<p><img src="/2019/03/19/数据库笔记2/1553240354720.png" alt="1553240354720"></p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">索引遵循：最左前缀匹配原则</span><br><span class="line">应该对哪些字段做索引：</span><br><span class="line"><span class="meta">#1、应该对数据量较小字段做索引</span></span><br><span class="line"><span class="meta">#2、应该对区分度高的字段做索引</span></span><br><span class="line"><span class="meta">#3、索引字段不要参与运算</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/19/数据库笔记2/1553240612030.png" alt="1553240612030"></p>
<p><img src="/2019/03/19/数据库笔记2/1553240753508.png" alt="1553240753508"></p>
<h3 id="全部搞索引插入就会变慢"><a href="#全部搞索引插入就会变慢" class="headerlink" title="全部搞索引插入就会变慢"></a>全部搞索引插入就会变慢</h3><h1 id="基本函数"><a href="#基本函数" class="headerlink" title="基本函数"></a>基本函数</h1><h3 id="1、数学函数"><a href="#1、数学函数" class="headerlink" title="1、数学函数"></a>1、数学函数</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">ABS</span><span class="params">(x)</span></span>   返回x的绝对值</span><br><span class="line"><span class="function"><span class="title">BIN</span><span class="params">(x)</span></span>   返回x的二进制（OCT返回八进制，HEX返回十六进制）</span><br><span class="line"><span class="function"><span class="title">CEILING</span><span class="params">(x)</span></span>   返回大于x的最小整数值</span><br><span class="line"><span class="function"><span class="title">EXP</span><span class="params">(x)</span></span>   返回值e（自然对数的底）的x次方</span><br><span class="line"><span class="function"><span class="title">FLOOR</span><span class="params">(x)</span></span>   返回小于x的最大整数值</span><br><span class="line"><span class="function"><span class="title">GREATEST</span><span class="params">(x1,x2,...,xn)</span></span>返回集合中最大的值</span><br><span class="line"><span class="function"><span class="title">LEAST</span><span class="params">(x1,x2,...,xn)</span></span>      返回集合中最小的值</span><br><span class="line"><span class="function"><span class="title">LN</span><span class="params">(x)</span></span>                    返回x的自然对数</span><br><span class="line"><span class="function"><span class="title">LOG</span><span class="params">(x,y)</span></span>返回x的以y为底的对数</span><br><span class="line"><span class="function"><span class="title">MOD</span><span class="params">(x,y)</span></span>                 返回x/y的模（余数）</span><br><span class="line"><span class="function"><span class="title">PI</span><span class="params">()</span></span>返回pi的值（圆周率）</span><br><span class="line"><span class="function"><span class="title">RAND</span><span class="params">()</span></span>返回０到１内的随机值,可以通过提供一个参数(种子)使RAND()随机数生成器生成一个指定的值。</span><br><span class="line"><span class="function"><span class="title">ROUND</span><span class="params">(x,y)</span></span>返回参数x的四舍五入的有y位小数的值</span><br><span class="line"><span class="function"><span class="title">SIGN</span><span class="params">(x)</span></span> 返回代表数字x的符号的值</span><br><span class="line"><span class="function"><span class="title">SQRT</span><span class="params">(x)</span></span> 返回一个数的平方根</span><br><span class="line"><span class="function"><span class="title">TRUNCATE</span><span class="params">(x,y)</span></span>            返回数字x截短为y位小数的结果</span><br></pre></td></tr></table></figure>
<h3 id="2、聚合函数"><a href="#2、聚合函数" class="headerlink" title="2、聚合函数"></a>2、聚合函数</h3><p>常用于GROUP BY从句的SELECT查询中</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">AVG</span><span class="params">(col)</span></span>返回指定列的平均值</span><br><span class="line"><span class="function"><span class="title">COUNT</span><span class="params">(col)</span></span>返回指定列中非NULL值的个数</span><br><span class="line"><span class="function"><span class="title">MIN</span><span class="params">(col)</span></span>返回指定列的最小值</span><br><span class="line"><span class="function"><span class="title">MAX</span><span class="params">(col)</span></span>返回指定列的最大值</span><br><span class="line"><span class="function"><span class="title">SUM</span><span class="params">(col)</span></span>返回指定列的所有值之和</span><br><span class="line"><span class="function"><span class="title">GROUP_CONCAT</span><span class="params">(col)</span></span> 返回由属于一组的列值连接组合而成的结果</span><br></pre></td></tr></table></figure>
<h3 id="3、字符串函数"><a href="#3、字符串函数" class="headerlink" title="3、字符串函数"></a>3、字符串函数</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">ASCII</span><span class="params">(char)</span></span>返回字符的ASCII码值</span><br><span class="line"><span class="function"><span class="title">BIT_LENGTH</span><span class="params">(str)</span></span>返回字符串的比特长度</span><br><span class="line"><span class="function"><span class="title">CONCAT</span><span class="params">(s1,s2...,sn)</span></span>将s1,s2...,sn连接成字符串</span><br><span class="line"><span class="function"><span class="title">CONCAT_WS</span><span class="params">(sep,s1,s2...,sn)</span></span>将s1,s2...,sn连接成字符串，并用sep字符间隔</span><br><span class="line"><span class="function"><span class="title">INSERT</span><span class="params">(str,x,y,instr)</span></span> 将字符串str从第x位置开始，y个字符长的子串替换为字符串instr，返回结果</span><br><span class="line"><span class="function"><span class="title">FIND_IN_SET</span><span class="params">(str,list)</span></span>分析逗号分隔的list列表，如果发现str，返回str在list中的位置</span><br><span class="line"><span class="function"><span class="title">LCASE</span><span class="params">(str)</span></span>或LOWER(str) 返回将字符串str中所有字符改变为小写后的结果</span><br><span class="line"><span class="function"><span class="title">LEFT</span><span class="params">(str,x)</span></span>返回字符串str中最左边的x个字符</span><br><span class="line"><span class="function"><span class="title">LENGTH</span><span class="params">(s)</span></span>返回字符串str中的字符数</span><br><span class="line"><span class="function"><span class="title">LTRIM</span><span class="params">(str)</span></span> 从字符串str中切掉开头的空格</span><br><span class="line"><span class="function"><span class="title">POSITION</span><span class="params">(substr,str)</span></span> 返回子串substr在字符串str中第一次出现的位置</span><br><span class="line"><span class="function"><span class="title">QUOTE</span><span class="params">(str)</span></span> 用反斜杠转义str中的单引号</span><br><span class="line"><span class="function"><span class="title">REPEAT</span><span class="params">(str,srchstr,rplcstr)</span></span>返回字符串str重复x次的结果</span><br><span class="line"><span class="function"><span class="title">REVERSE</span><span class="params">(str)</span></span> 返回颠倒字符串str的结果</span><br><span class="line"><span class="function"><span class="title">RIGHT</span><span class="params">(str,x)</span></span> 返回字符串str中最右边的x个字符</span><br><span class="line"><span class="function"><span class="title">RTRIM</span><span class="params">(str)</span></span> 返回字符串str尾部的空格</span><br><span class="line"><span class="function"><span class="title">STRCMP</span><span class="params">(s1,s2)</span></span>比较字符串s1和s2</span><br><span class="line"><span class="function"><span class="title">TRIM</span><span class="params">(str)</span></span>去除字符串首部和尾部的所有空格</span><br><span class="line"><span class="function"><span class="title">UCASE</span><span class="params">(str)</span></span>或UPPER(str) 返回将字符串str中所有字符转变为大写后的结果</span><br></pre></td></tr></table></figure>
<h3 id="4、日期和时间函数"><a href="#4、日期和时间函数" class="headerlink" title="4、日期和时间函数"></a>4、日期和时间函数</h3><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CURDATE()或CURRENT_DATE() 返回当前的日期</span><br><span class="line">CURTIME()或CURRENT_TIME() 返回当前的时间</span><br><span class="line">DATE_ADD(<span class="built_in">date</span>,INTERVAL <span class="built_in">int</span> keyword)返回日期<span class="built_in">date</span>加上间隔时间<span class="built_in">int</span>的结果(<span class="built_in">int</span>必须按照关键字进行格式化),如：SELECTDATE_ADD(CURRENT_DATE,INTERVAL <span class="number">6</span> <span class="built_in">MONTH</span>);</span><br><span class="line">DATE_FORMAT(<span class="built_in">date</span>,fmt)  依照指定的fmt格式格式化日期<span class="built_in">date</span>值</span><br><span class="line">DATE_SUB(<span class="built_in">date</span>,INTERVAL <span class="built_in">int</span> keyword)返回日期<span class="built_in">date</span>加上间隔时间<span class="built_in">int</span>的结果(<span class="built_in">int</span>必须按照关键字进行格式化),如：SELECTDATE_SUB(CURRENT_DATE,INTERVAL <span class="number">6</span> <span class="built_in">MONTH</span>);</span><br><span class="line">DAYOFWEEK(<span class="built_in">date</span>)   返回<span class="built_in">date</span>所代表的一星期中的第几天(<span class="number">1</span>~<span class="number">7</span>)</span><br><span class="line">DAYOFMONTH(<span class="built_in">date</span>)  返回<span class="built_in">date</span>是一个月的第几天(<span class="number">1</span>~<span class="number">31</span>)</span><br><span class="line">DAYOFYEAR(<span class="built_in">date</span>)   返回<span class="built_in">date</span>是一年的第几天(<span class="number">1</span>~<span class="number">366</span>)</span><br><span class="line">DAYNAME(<span class="built_in">date</span>)   返回<span class="built_in">date</span>的星期名，如：<span class="keyword">SELECT</span> DAYNAME(CURRENT_DATE);</span><br><span class="line">FROM_UNIXTIME(ts,fmt)  根据指定的fmt格式，格式化UNIX时间戳ts</span><br><span class="line"><span class="built_in">HOUR</span>(<span class="built_in">time</span>)   返回<span class="built_in">time</span>的小时值(<span class="number">0</span>~<span class="number">23</span>)</span><br><span class="line"><span class="built_in">MINUTE</span>(<span class="built_in">time</span>)   返回<span class="built_in">time</span>的分钟值(<span class="number">0</span>~<span class="number">59</span>)</span><br><span class="line"><span class="built_in">MONTH</span>(<span class="built_in">date</span>)   返回<span class="built_in">date</span>的月份值(<span class="number">1</span>~<span class="number">12</span>)</span><br><span class="line"><span class="built_in">MONTHNAME</span>(<span class="built_in">date</span>)   返回<span class="built_in">date</span>的月份名，如：<span class="keyword">SELECT</span> <span class="built_in">MONTHNAME</span>(CURRENT_DATE);</span><br><span class="line"><span class="built_in">NOW</span>()    返回当前的日期和时间</span><br><span class="line">QUARTER(<span class="built_in">date</span>)   返回<span class="built_in">date</span>在一年中的季度(<span class="number">1</span>~<span class="number">4</span>)，如<span class="keyword">SELECT</span> QUARTER(CURRENT_DATE);</span><br><span class="line">WEEK(<span class="built_in">date</span>)   返回日期<span class="built_in">date</span>为一年中第几周(<span class="number">0</span>~<span class="number">53</span>)</span><br><span class="line"><span class="built_in">YEAR</span>(<span class="built_in">date</span>)   返回日期<span class="built_in">date</span>的年份(<span class="number">1000</span>~<span class="number">9999</span>)</span><br></pre></td></tr></table></figure>
<h3 id="5、格式化函数"><a href="#5、格式化函数" class="headerlink" title="5、格式化函数"></a>5、格式化函数</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">DATE_FORMAT</span><span class="params">(date,fmt)</span></span>  依照字符串fmt格式化日期date值</span><br><span class="line"><span class="function"><span class="title">FORMAT</span><span class="params">(x,y)</span></span>   把x格式化为以逗号隔开的数字序列，y是结果的小数位数</span><br><span class="line"><span class="function"><span class="title">INET_ATON</span><span class="params">(ip)</span></span>   返回IP地址的数字表示</span><br><span class="line"><span class="function"><span class="title">INET_NTOA</span><span class="params">(num)</span></span>   返回数字所代表的IP地址</span><br><span class="line"><span class="function"><span class="title">TIME_FORMAT</span><span class="params">(time,fmt)</span></span>  依照字符串fmt格式化时间time值</span><br><span class="line">其中最简单的是FORMAT()函数，它可以把大的数值格式化为以逗号间隔的易读的序列。</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FORMAT</span>(<span class="number">34234.34323432</span>,<span class="number">3</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATE_FORMAT</span>(<span class="keyword">NOW</span>(),<span class="string">'%W,%D %M %Y %r'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATE_FORMAT</span>(<span class="keyword">NOW</span>(),<span class="string">'%Y-%m-%d'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATE_FORMAT</span>(<span class="number">19990330</span>,<span class="string">'%Y-%m-%d'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATE_FORMAT</span>(<span class="keyword">NOW</span>(),<span class="string">'%h:%i %p'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">INET_ATON</span>(<span class="string">'10.122.89.47'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">INET_NTOA</span>(<span class="number">175790383</span>);</span><br></pre></td></tr></table></figure>
<h1 id="学生选课系统表练习"><a href="#学生选课系统表练习" class="headerlink" title="学生选课系统表练习"></a>学生选课系统表练习</h1><h3 id="设计表关系"><a href="#设计表关系" class="headerlink" title="设计表关系"></a>设计表关系</h3><p><img src="https://images2015.cnblogs.com/blog/425762/201608/425762-20160803224643778-2071849037.png" alt="img"></p>
<h3 id="创建表和插入数据"><a href="#创建表和插入数据" class="headerlink" title="创建表和插入数据"></a>创建表和插入数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/*</span><br><span class="line">Navicat MySQL Data Transfer</span><br><span class="line"></span><br><span class="line">Source Server         : localhost_3306</span><br><span class="line">Source Server Version : 50719</span><br><span class="line">Source Host           : localhost:3306</span><br><span class="line">Source Database       : oldbo</span><br><span class="line"></span><br><span class="line">Target Server Type    : MYSQL</span><br><span class="line">Target Server Version : 50719</span><br><span class="line">File Encoding         : 65001</span><br><span class="line"></span><br><span class="line">Date: 2017-07-26 15:46:16</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">SET FOREIGN_KEY_CHECKS=0;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for class</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS class;</span><br><span class="line">CREATE TABLE class (</span><br><span class="line">  cid int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  caption varchar(32) NOT NULL,</span><br><span class="line">  PRIMARY KEY (cid)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of class</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO class VALUES (&apos;1&apos;, &apos;三年二班&apos;);</span><br><span class="line">INSERT INTO class VALUES (&apos;2&apos;, &apos;三年三班&apos;);</span><br><span class="line">INSERT INTO class VALUES (&apos;3&apos;, &apos;一年二班&apos;);</span><br><span class="line">INSERT INTO class VALUES (&apos;4&apos;, &apos;二年九班&apos;);</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for course</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS course;</span><br><span class="line">CREATE TABLE course (</span><br><span class="line">  cid int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  cname varchar(32) NOT NULL,</span><br><span class="line">  teacher_id int(11) NOT NULL,</span><br><span class="line">  PRIMARY KEY (cid),</span><br><span class="line">  KEY fk_course_teacher (teacher_id),</span><br><span class="line">  CONSTRAINT fk_course_teacher FOREIGN KEY (teacher_id) REFERENCES teacher (tid)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of course</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO course VALUES (&apos;1&apos;, &apos;生物&apos;, &apos;1&apos;);</span><br><span class="line">INSERT INTO course VALUES (&apos;2&apos;, &apos;物理&apos;, &apos;2&apos;);</span><br><span class="line">INSERT INTO course VALUES (&apos;3&apos;, &apos;体育&apos;, &apos;3&apos;);</span><br><span class="line">INSERT INTO course VALUES (&apos;4&apos;, &apos;美术&apos;, &apos;2&apos;);</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for score</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS score;</span><br><span class="line">CREATE TABLE score (</span><br><span class="line">  sid int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  student_id int(11) NOT NULL,</span><br><span class="line">  course_id int(11) NOT NULL,</span><br><span class="line">  num int(11) NOT NULL,</span><br><span class="line">  PRIMARY KEY (sid),</span><br><span class="line">  KEY fk_score_student (student_id),</span><br><span class="line">  KEY fk_score_course (course_id),</span><br><span class="line">  CONSTRAINT fk_score_course FOREIGN KEY (course_id) REFERENCES course (cid),</span><br><span class="line">  CONSTRAINT fk_score_student FOREIGN KEY (student_id) REFERENCES student (sid)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=53 DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of score</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO score VALUES (&apos;1&apos;, &apos;1&apos;, &apos;1&apos;, &apos;10&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;2&apos;, &apos;1&apos;, &apos;2&apos;, &apos;9&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;5&apos;, &apos;1&apos;, &apos;4&apos;, &apos;66&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;6&apos;, &apos;2&apos;, &apos;1&apos;, &apos;8&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;8&apos;, &apos;2&apos;, &apos;3&apos;, &apos;68&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;9&apos;, &apos;2&apos;, &apos;4&apos;, &apos;99&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;10&apos;, &apos;3&apos;, &apos;1&apos;, &apos;77&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;11&apos;, &apos;3&apos;, &apos;2&apos;, &apos;66&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;12&apos;, &apos;3&apos;, &apos;3&apos;, &apos;87&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;13&apos;, &apos;3&apos;, &apos;4&apos;, &apos;99&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;14&apos;, &apos;4&apos;, &apos;1&apos;, &apos;79&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;15&apos;, &apos;4&apos;, &apos;2&apos;, &apos;11&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;16&apos;, &apos;4&apos;, &apos;3&apos;, &apos;67&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;17&apos;, &apos;4&apos;, &apos;4&apos;, &apos;100&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;18&apos;, &apos;5&apos;, &apos;1&apos;, &apos;79&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;19&apos;, &apos;5&apos;, &apos;2&apos;, &apos;11&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;20&apos;, &apos;5&apos;, &apos;3&apos;, &apos;67&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;21&apos;, &apos;5&apos;, &apos;4&apos;, &apos;100&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;22&apos;, &apos;6&apos;, &apos;1&apos;, &apos;9&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;23&apos;, &apos;6&apos;, &apos;2&apos;, &apos;100&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;24&apos;, &apos;6&apos;, &apos;3&apos;, &apos;67&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;25&apos;, &apos;6&apos;, &apos;4&apos;, &apos;100&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;26&apos;, &apos;7&apos;, &apos;1&apos;, &apos;9&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;27&apos;, &apos;7&apos;, &apos;2&apos;, &apos;100&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;28&apos;, &apos;7&apos;, &apos;3&apos;, &apos;67&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;29&apos;, &apos;7&apos;, &apos;4&apos;, &apos;88&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;30&apos;, &apos;8&apos;, &apos;1&apos;, &apos;9&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;31&apos;, &apos;8&apos;, &apos;2&apos;, &apos;100&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;32&apos;, &apos;8&apos;, &apos;3&apos;, &apos;67&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;33&apos;, &apos;8&apos;, &apos;4&apos;, &apos;88&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;34&apos;, &apos;9&apos;, &apos;1&apos;, &apos;91&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;35&apos;, &apos;9&apos;, &apos;2&apos;, &apos;88&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;36&apos;, &apos;9&apos;, &apos;3&apos;, &apos;67&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;37&apos;, &apos;9&apos;, &apos;4&apos;, &apos;22&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;38&apos;, &apos;10&apos;, &apos;1&apos;, &apos;90&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;39&apos;, &apos;10&apos;, &apos;2&apos;, &apos;77&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;40&apos;, &apos;10&apos;, &apos;3&apos;, &apos;43&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;41&apos;, &apos;10&apos;, &apos;4&apos;, &apos;87&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;42&apos;, &apos;11&apos;, &apos;1&apos;, &apos;90&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;43&apos;, &apos;11&apos;, &apos;2&apos;, &apos;77&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;44&apos;, &apos;11&apos;, &apos;3&apos;, &apos;43&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;45&apos;, &apos;11&apos;, &apos;4&apos;, &apos;87&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;46&apos;, &apos;12&apos;, &apos;1&apos;, &apos;90&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;47&apos;, &apos;12&apos;, &apos;2&apos;, &apos;77&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;48&apos;, &apos;12&apos;, &apos;3&apos;, &apos;43&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;49&apos;, &apos;12&apos;, &apos;4&apos;, &apos;87&apos;);</span><br><span class="line">INSERT INTO score VALUES (&apos;52&apos;, &apos;13&apos;, &apos;3&apos;, &apos;87&apos;);</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for student</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS student;</span><br><span class="line">CREATE TABLE student (</span><br><span class="line">  sid int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  gender char(1) NOT NULL,</span><br><span class="line">  class_id int(11) NOT NULL,</span><br><span class="line">  sname varchar(32) NOT NULL,</span><br><span class="line">  PRIMARY KEY (sid),</span><br><span class="line">  KEY fk_class (class_id),</span><br><span class="line">  CONSTRAINT fk_class FOREIGN KEY (class_id) REFERENCES class (cid)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of student</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO student VALUES (&apos;1&apos;, &apos;男&apos;, &apos;1&apos;, &apos;理解&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;2&apos;, &apos;女&apos;, &apos;1&apos;, &apos;钢蛋&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;3&apos;, &apos;男&apos;, &apos;1&apos;, &apos;张三&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;4&apos;, &apos;男&apos;, &apos;1&apos;, &apos;张一&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;5&apos;, &apos;女&apos;, &apos;1&apos;, &apos;张二&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;6&apos;, &apos;男&apos;, &apos;1&apos;, &apos;张四&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;7&apos;, &apos;女&apos;, &apos;2&apos;, &apos;铁锤&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;8&apos;, &apos;男&apos;, &apos;2&apos;, &apos;李三&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;9&apos;, &apos;男&apos;, &apos;2&apos;, &apos;李一&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;10&apos;, &apos;女&apos;, &apos;2&apos;, &apos;李二&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;11&apos;, &apos;男&apos;, &apos;2&apos;, &apos;李四&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;12&apos;, &apos;女&apos;, &apos;3&apos;, &apos;如花&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;13&apos;, &apos;男&apos;, &apos;3&apos;, &apos;刘三&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;14&apos;, &apos;男&apos;, &apos;3&apos;, &apos;刘一&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;15&apos;, &apos;女&apos;, &apos;3&apos;, &apos;刘二&apos;);</span><br><span class="line">INSERT INTO student VALUES (&apos;16&apos;, &apos;男&apos;, &apos;3&apos;, &apos;刘四&apos;);</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for teacher</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS teacher;</span><br><span class="line">CREATE TABLE teacher (</span><br><span class="line">  tid int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  tname varchar(32) NOT NULL,</span><br><span class="line">  PRIMARY KEY (tid)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of teacher</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO teacher VALUES (&apos;1&apos;, &apos;张磊老师&apos;);</span><br><span class="line">INSERT INTO teacher VALUES (&apos;2&apos;, &apos;李平老师&apos;);</span><br><span class="line">INSERT INTO teacher VALUES (&apos;3&apos;, &apos;刘海燕老师&apos;);</span><br><span class="line">INSERT INTO teacher VALUES (&apos;4&apos;, &apos;朱云海老师&apos;);</span><br><span class="line">INSERT INTO teacher VALUES (&apos;5&apos;, &apos;李杰老师&apos;);</span><br><span class="line">SET FOREIGN_KEY_CHECKS=1;</span><br></pre></td></tr></table></figure>
<h3 id="查询条件"><a href="#查询条件" class="headerlink" title="查询条件"></a>查询条件</h3><p>1、查询所有的课程的名称以及对应的任课老师姓名 </p>
<p>2、查询学生表中男女生各有多少人 </p>
<p>3、查询物理成绩等于100的学生的姓名 </p>
<p>4、查询平均成绩大于八十分的同学的姓名和平均成绩</p>
<p>5、查询所有学生的学号，姓名，选课数，总成绩 </p>
<p>6、 查询姓李老师的个数 </p>
<p>7、 查询没有报李平老师课的学生姓名 </p>
<p>8、 查询物理课程比生物课程高的学生的学号 </p>
<p>9、 查询没有同时选修物理课程和体育课程的学生姓名 </p>
<p>10、查询挂科超过两门(包括两门)的学生姓名和班级 </p>
<p>11 、查询选修了所有课程的学生姓名 </p>
<p>12、查询李平老师教的课程的所有成绩记录  </p>
<p>13、查询全部学生都选修了的课程号和课程名 </p>
<p>14、查询每门课程被选修的次数 </p>
<p>15、查询之选修了一门课程的学生姓名和学号 </p>
<p>16、查询所有学生考出的成绩并按从高到低排序（成绩去重） </p>
<p>17、查询平均成绩大于85的学生姓名和平均成绩 </p>
<p>18、查询生物成绩不及格的学生姓名和对应生物分数 </p>
<p>19、查询在所有选修了李平老师课程的学生中，这些课程(李平老师的课程，不是所有课程)平均成绩最高的学生姓名</p>
<h3 id="答案"><a href="#答案" class="headerlink" title="答案"></a>答案</h3><p>1、</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT cname,tname FROM course LEFT JOIN teacher on course.teacher_id=teacher.tid</span><br></pre></td></tr></table></figure>
<p>2、</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT gender 性别 ,COUNT(gender) 人数 <span class="keyword">from</span> student<span class="built_in"> GROUP </span>BY gender;</span><br></pre></td></tr></table></figure>
<p>3、</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">sid</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> student_id <span class="keyword">from</span> score <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> course</span><br><span class="line"></span><br><span class="line">              <span class="keyword">ON</span>  score.course_id=course.cid <span class="keyword">WHERE</span> <span class="keyword">num</span>=<span class="number">100</span> <span class="keyword">AND</span> course.cname=<span class="string">"物理"</span>);</span><br></pre></td></tr></table></figure>
<p>4、SELECT sname 姓名,平均成绩 from student RIGHT JOIN</p>
<p>​          (SELECT student_id,avg(num) 平均成绩</p>
<p>​          from score  GROUP BY student_id</p>
<p>​          HAVING avg(num)&gt;80) as A</p>
<p>​          on student.sid=A.student_id;</p>
<p>5、SELECT  student_id 学号,sname 姓名,COUNT(course_id) 课程数,SUM(num) 总分 FROM score</p>
<p>​                  LEFT JOIN student ON score.student_id=student.sid GROUP BY student_id;</p>
<p>7、SELECT * FROM student</p>
<p>​                    WHERE sid not in</p>
<p>​                   (SELECT student_id FROM score WHERE course_id in</p>
<p>​                   (SELECT cid FROM course LEFT JOIN teacher ON teacher.tid=course.teacher_id</p>
<p>​                    WHERE tname like “李平%”))</p>
<p>8、SELECT * FROM</p>
<p>​        (SELECT * FROM score LEFT JOIN course</p>
<p>​                ON score.course_id=course.cid WHERE cname=”生物”) as A</p>
<p>​    INNER JOIN</p>
<p>​        (SELECT * FROM score LEFT JOIN course</p>
<p>​                ON score.course_id=course.cid WHERE cname=”物理”) as B</p>
<p>​    ON A.student_id=B.student_id</p>
<p>​    WHERE a.num&lt;b.num</p>
<p>9、SELECT sname from student</p>
<p>​                 WHERE sid NOT IN (SELECT student_id FROM score LEFT JOIN course</p>
<p>​                 ON score.course_id=course.cid</p>
<p>​                 WHERE cname=’体育’  OR cname=’物理’</p>
<p>​                 GROUP BY student_id</p>
<p>​                 HAVING COUNT(course_id)&gt;1) ;</p>
<p>10、SELECT sname,gender from student</p>
<p>​                          WHERE sid in (SELECT student_id from score WHERE num&lt;60</p>
<p>​                          GROUP BY student_id</p>
<p>​                          HAVING COUNT(student_id)&gt;1);</p>
<p>11、SELECT sid 学号,sname 姓名 from student</p>
<p>​                WHERE sid in (SELECT student_id FROM score</p>
<p>​                GROUP BY student_id</p>
<p>​                HAVING COUNT(student_id)!= (SELECT COUNT(cid) FROM course))</p>
<p>12、SELECT * FROM score</p>
<p>​                WHERE course_id NOT IN (SELECT cid from teacher INNER JOIN course</p>
<p>​                on teacher.tid=course.teacher_id</p>
<p>​                WHERE teacher.tname LIKE “李平%”);</p>
<p>13、SELECT course_id from score</p>
<p>​                GROUP BY course_id</p>
<p>​                HAVING COUNT(course_id)=(SELECT COUNT(sid) FROM student)</p>
<p>14、–  SELECT course_id,COUNT(course_id) from score GROUP BY course_id</p>
<p>​       SELECT cname,COUNT(course_id) FROM score LEFT JOIN course</p>
<p>​                        ON score.course_id=course.cid GROUP BY course_id</p>
<p>15、SELECT sid,sname FROM student </p>
<p>​                    WHERE sid in (SELECT student_id from score</p>
<p>​                    GROUP BY student_id</p>
<p>​            HAVING COUNT(sid)=1);</p>
<p>16、SELECT DISTINCT num FROM score ORDER BY num DESC；</p>
<p>17、SELECT sname from student</p>
<p>​                    WHERE sid in (SELECT student_id FROM score</p>
<p>​                    GROUP BY student_id </p>
<p>​                    HAVING AVG(num)&gt;85)</p>
<p>​       注意：用这种方式我们无法查看对应的平均成绩，所以不得不使用连表：</p>
<p>​       SELECT sname,AVG(num) FROM student LEFT JOIN score</p>
<p>​                    ON student.sid=score.student_id</p>
<p>​                    GROUP BY student_id HAVING AVG(num)&gt;85;</p>
<p>18、SELECT sname 姓名,num 生物成绩 FROM score</p>
<p>​                 LEFT JOIN course ON score.course_id=course.cid</p>
<p>​                 LEFT JOIN student ON score.student_id=student.sid</p>
<p>​                 WHERE score.num&lt;60 AND cname=”生物”；</p>
<p>19、 SELECT student_id,avg(num),sname FROM score</p>
<p>​                 LEFT JOIN student ON score.student_id=student.sid</p>
<p>​                     WHERE course_id in (SELECT cid FROM course</p>
<p>​                     LEFT JOIN teacher ON teacher.tid=course.teacher_id WHERE tname LIKE “李平%”)</p>
<p>​                     GROUP BY student_id</p>
<p>​                 ORDER BY AVG(num) DESC</p>
<p>​                 LIMIT 1</p>

      
    </div>

    

    
    
    

    
      <div>
        <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center;">
  <img id="wechat_subscriber_qcode" src="/images/gongzhonghao.jpg" alt="李江洋 wechat" style="width: 200px; max-width: 100%;">
  <div>添加微信，实地看房</div>
</div>

      </div>
    

    
      
    
    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>欢迎联系我，带您实地看房</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById(&quot;QR&quot;); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="李江洋 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="李江洋 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/mysql/" rel="tag"># mysql</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/03/19/数据库的基本概念/" rel="next" title="数据库的基本概念">
                <i class="fa fa-chevron-left"></i> 数据库的基本概念
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/03/19/网络编程总/" rel="prev" title="网络编程总">
                网络编程总 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="李江洋">
            
              <p class="site-author-name" itemprop="name">李江洋</p>
              <p class="site-description motion-element" itemprop="description">记录学习的技能和遇到的问题</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">180</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">23</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">41</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3lvdXJuYW1l" title="GitHub &rarr; https://github.com/yourname"><i class="fa fa-fw fa-github"></i>GitHub</span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="bWFpbHRvOjEzMjgwNDQzOTJAcXEuY29t" title="E-Mail &rarr; mailto:1328044392@qq.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</span>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL2V4YW1wbGUuY29t" title="http://example.com">Title</span>
                  </li>
                
              </ul>
            </div>
          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#mysql安装"><span class="nav-number">1.</span> <span class="nav-text">mysql安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql"><span class="nav-number">1.1.</span> <span class="nav-text">mysql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#linux-mysql数据库安装"><span class="nav-number">1.2.</span> <span class="nav-text">linux mysql数据库安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#如何安装数据库"><span class="nav-number">1.2.1.</span> <span class="nav-text">如何安装数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编译安装MySQL"><span class="nav-number">1.2.2.</span> <span class="nav-text">编译安装MySQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL二进制安装"><span class="nav-number">1.2.3.</span> <span class="nav-text">MySQL二进制安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用systemd管理MySQL"><span class="nav-number">1.2.4.</span> <span class="nav-text">使用systemd管理MySQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#给root用户设置密码"><span class="nav-number">1.2.5.</span> <span class="nav-text">给root用户设置密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#01-误删除root用户解决方法"><span class="nav-number">1.2.6.</span> <span class="nav-text">01.误删除root用户解决方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#02-客户端与服务器模型"><span class="nav-number">1.2.7.</span> <span class="nav-text">02.客户端与服务器模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#03-MySQL服务器构成"><span class="nav-number">1.2.8.</span> <span class="nav-text">03.MySQL服务器构成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#04-MySQL的结构"><span class="nav-number">1.2.9.</span> <span class="nav-text">04.MySQL的结构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#windows-mysql数据库安装"><span class="nav-number">1.3.</span> <span class="nav-text">windows mysql数据库安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#直接解压"><span class="nav-number">1.3.1.</span> <span class="nav-text">直接解压</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在本地设置MYSQL账号"><span class="nav-number">1.4.</span> <span class="nav-text">在本地设置MYSQL账号</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建my-ini文件"><span class="nav-number">1.4.1.</span> <span class="nav-text">创建my.ini文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将模式设置为严格模式"><span class="nav-number">1.5.</span> <span class="nav-text">将模式设置为严格模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注意"><span class="nav-number">1.5.1.</span> <span class="nav-text">注意</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将MYSQL设置为后台自动运行"><span class="nav-number">1.6.</span> <span class="nav-text">将MYSQL设置为后台自动运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库服务器中存放的是"><span class="nav-number">1.7.</span> <span class="nav-text">数据库服务器中存放的是</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#破解mysql密码-跳过配置文件"><span class="nav-number">1.8.</span> <span class="nav-text">破解mysql密码,跳过配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-关闭mysql"><span class="nav-number">1.8.1.</span> <span class="nav-text">1 关闭mysql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-重新启动"><span class="nav-number">1.8.2.</span> <span class="nav-text">2 重新启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-输入命令"><span class="nav-number">1.8.3.</span> <span class="nav-text">3 输入命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-关闭MySQL-正常启动"><span class="nav-number">1.8.4.</span> <span class="nav-text">4 关闭MySQL,正常启动</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#账号的创建-了解知识点"><span class="nav-number">1.9.</span> <span class="nav-text">账号的创建(了解知识点)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#跟权限有关的几张表"><span class="nav-number">1.9.1.</span> <span class="nav-text">跟权限有关的几张表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#只创建账号"><span class="nav-number">1.9.2.</span> <span class="nav-text">只创建账号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建账号并且授权（只有root账号才能为其他账号授权grant）"><span class="nav-number">1.9.3.</span> <span class="nav-text">创建账号并且授权（只有root账号才能为其他账号授权grant）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除账号"><span class="nav-number">1.9.4.</span> <span class="nav-text">删除账号</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MYSQL原生态SQL语句"><span class="nav-number">2.</span> <span class="nav-text">MYSQL原生态SQL语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#注释"><span class="nav-number">2.1.</span> <span class="nav-text">注释</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#SQL语句规范第一条"><span class="nav-number">2.1.0.0.0.1.</span> <span class="nav-text">SQL语句规范第一条:</span></a></li></ol></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#库-create-drop-alter-show"><span class="nav-number">2.2.</span> <span class="nav-text">库(create/drop/alter/show)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建规则"><span class="nav-number">2.2.1.</span> <span class="nav-text">创建规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#增"><span class="nav-number">2.2.2.</span> <span class="nav-text">增</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除"><span class="nav-number">2.2.3.</span> <span class="nav-text">删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#改"><span class="nav-number">2.2.4.</span> <span class="nav-text">改</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查"><span class="nav-number">2.2.5.</span> <span class="nav-text">查</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#查所有库"><span class="nav-number">2.2.5.1.</span> <span class="nav-text">查所有库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查已经创建的库"><span class="nav-number">2.2.5.2.</span> <span class="nav-text">查已经创建的库</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表的操作首先要选择库文件"><span class="nav-number">2.3.</span> <span class="nav-text">表的操作首先要选择库文件</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#进入库中"><span class="nav-number">2.3.0.0.0.1.</span> <span class="nav-text">进入库中</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表-create-drop-truncate-alter-show-desc"><span class="nav-number">2.4.</span> <span class="nav-text">表(create/drop;truncate/alter/show;desc)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#增："><span class="nav-number">2.4.1.</span> <span class="nav-text">增：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#不需要切换"><span class="nav-number">2.4.1.1.</span> <span class="nav-text">不需要切换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#需要切换use"><span class="nav-number">2.4.1.2.</span> <span class="nav-text">需要切换use</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删：-彻底"><span class="nav-number">2.4.2.</span> <span class="nav-text">删：(彻底)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删-注意：只是清空表内内容，表结构还在"><span class="nav-number">2.4.3.</span> <span class="nav-text">删:( 注意：只是清空表内内容，表结构还在)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#改："><span class="nav-number">2.4.4.</span> <span class="nav-text">改：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-添加属性-字段"><span class="nav-number">2.4.4.1.</span> <span class="nav-text">1.添加属性(字段)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-删除属性-字段"><span class="nav-number">2.4.4.2.</span> <span class="nav-text">2.删除属性(字段)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-改表属性的数据类型-字段"><span class="nav-number">2.4.4.3.</span> <span class="nav-text">3.改表属性的数据类型(字段)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-覆盖修改表中的某个属性-字段"><span class="nav-number">2.4.4.4.</span> <span class="nav-text">4.覆盖修改表中的某个属性(字段)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-改表的字符编码"><span class="nav-number">2.4.4.5.</span> <span class="nav-text">5.改表的字符编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-修改表名"><span class="nav-number">2.4.4.6.</span> <span class="nav-text">6.修改表名</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查："><span class="nav-number">2.4.5.</span> <span class="nav-text">查：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-查所有的表"><span class="nav-number">2.4.5.1.</span> <span class="nav-text">1.查所有的表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-查创建的表"><span class="nav-number">2.4.5.2.</span> <span class="nav-text">2.查创建的表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-查表结构"><span class="nav-number">2.4.5.3.</span> <span class="nav-text">3.查表结构</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拷贝"><span class="nav-number">2.4.6.</span> <span class="nav-text">拷贝</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看当前所在库"><span class="nav-number">2.4.7.</span> <span class="nav-text">查看当前所在库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#记录-insert-delete-update-select"><span class="nav-number">2.5.</span> <span class="nav-text">记录(insert/delete/update/select)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#增：-1"><span class="nav-number">2.5.1.</span> <span class="nav-text">增：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删：use"><span class="nav-number">2.5.2.</span> <span class="nav-text">删：use</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#不use"><span class="nav-number">2.5.2.1.</span> <span class="nav-text">不use</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#改-没有条件就全删"><span class="nav-number">2.5.3.</span> <span class="nav-text">改: 没有条件就全删</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查：-1"><span class="nav-number">2.5.4.</span> <span class="nav-text">查：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#查所有"><span class="nav-number">2.5.4.1.</span> <span class="nav-text">查所有</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查一个单个属性"><span class="nav-number">2.5.4.2.</span> <span class="nav-text">查一个单个属性</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#创建表的完整语法"><span class="nav-number">3.</span> <span class="nav-text">创建表的完整语法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据类型"><span class="nav-number">3.1.</span> <span class="nav-text">数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-整形"><span class="nav-number">3.1.1.</span> <span class="nav-text">1 整形</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#默认为有符号，即数字前有正负号"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">默认为有符号，即数字前有正负号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#强调："><span class="nav-number">3.1.1.2.</span> <span class="nav-text">强调：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-浮点型"><span class="nav-number">3.1.2.</span> <span class="nav-text">2.浮点型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#三种格式的精度不一样"><span class="nav-number">3.1.2.1.</span> <span class="nav-text">三种格式的精度不一样</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#格式"><span class="nav-number">3.1.2.2.</span> <span class="nav-text">格式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-日期类型"><span class="nav-number">3.1.3.</span> <span class="nav-text">3 日期类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#year"><span class="nav-number">3.1.3.1.</span> <span class="nav-text">year</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#date-time-datetime"><span class="nav-number">3.1.3.2.</span> <span class="nav-text">date time datetime</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#timestamp"><span class="nav-number">3.1.3.3.</span> <span class="nav-text">timestamp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实际场景"><span class="nav-number">3.1.3.4.</span> <span class="nav-text">实际场景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实列"><span class="nav-number">3.1.3.5.</span> <span class="nav-text">实列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#timestamp与datetime的区别"><span class="nav-number">3.1.3.6.</span> <span class="nav-text">timestamp与datetime的区别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-字符类型"><span class="nav-number">3.1.4.</span> <span class="nav-text">4.字符类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#设置"><span class="nav-number">3.1.4.1.</span> <span class="nav-text">设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注意点"><span class="nav-number">3.1.4.2.</span> <span class="nav-text">注意点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-枚举与集合类型"><span class="nav-number">3.1.5.</span> <span class="nav-text">5 枚举与集合类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#先创建"><span class="nav-number">3.1.5.1.</span> <span class="nav-text">先创建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#枚举enum-多选一"><span class="nav-number">3.1.5.2.</span> <span class="nav-text">枚举enum:多选一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#集合set-多选多"><span class="nav-number">3.1.5.3.</span> <span class="nav-text">集合set: 多选多</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#concat-字符串相加"><span class="nav-number">3.1.5.4.</span> <span class="nav-text">concat(字符串相加)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表的约束"><span class="nav-number">3.2.</span> <span class="nav-text">表的约束</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#not-null与default"><span class="nav-number">3.2.1.</span> <span class="nav-text">not null与default</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#unique-key唯一"><span class="nav-number">3.2.2.</span> <span class="nav-text">unique key唯一</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建方法"><span class="nav-number">3.2.2.1.</span> <span class="nav-text">创建方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#联合唯一"><span class="nav-number">3.2.2.2.</span> <span class="nav-text">联合唯一</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#primary-key-主键"><span class="nav-number">3.2.3.</span> <span class="nav-text">primary key(主键)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#注意点-1"><span class="nav-number">3.2.3.1.</span> <span class="nav-text">注意点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#写法"><span class="nav-number">3.2.3.2.</span> <span class="nav-text">写法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#foreign-key"><span class="nav-number">3.2.4.</span> <span class="nav-text">foreign key</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#注意-1"><span class="nav-number">3.2.4.1.</span> <span class="nav-text">注意</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#创建表2个相互关联的表"><span class="nav-number">3.2.4.2.</span> <span class="nav-text">创建表2个相互关联的表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#插入2个相互关联表的数据"><span class="nav-number">3.2.4.3.</span> <span class="nav-text">插入2个相互关联表的数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除表"><span class="nav-number">3.2.4.4.</span> <span class="nav-text">删除表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#找两张表的关系的窍门"><span class="nav-number">3.2.4.5.</span> <span class="nav-text">找两张表的关系的窍门</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#一对一"><span class="nav-number">3.2.4.6.</span> <span class="nav-text">一对一:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#补充存储引擎"><span class="nav-number">3.2.5.</span> <span class="nav-text">补充存储引擎</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#单表查询"><span class="nav-number">4.</span> <span class="nav-text">单表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#准备的表和数据"><span class="nav-number">4.1.</span> <span class="nav-text">准备的表和数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#产生"><span class="nav-number">4.1.1.</span> <span class="nav-text">产生</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#练习单表查询"><span class="nav-number">4.1.2.</span> <span class="nav-text">练习单表查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#步骤"><span class="nav-number">4.2.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单表查询的完整语法"><span class="nav-number">4.3.</span> <span class="nav-text">单表查询的完整语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#语法级别关键字排序"><span class="nav-number">4.3.1.</span> <span class="nav-text">语法级别关键字排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关键字的执行顺序"><span class="nav-number">4.3.2.</span> <span class="nav-text">关键字的执行顺序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单表简单的查询语法"><span class="nav-number">4.4.</span> <span class="nav-text">单表简单的查询语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#where和between和in"><span class="nav-number">4.5.</span> <span class="nav-text">where和between和in</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#group-by-分组"><span class="nav-number">4.6.</span> <span class="nav-text">group by 分组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是分组"><span class="nav-number">4.6.1.</span> <span class="nav-text">什么是分组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ONLY-FULL-GROUP-BY"><span class="nav-number">4.6.2.</span> <span class="nav-text">ONLY_FULL_GROUP_BY</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#聚合函数-和分组搭配使用"><span class="nav-number">4.6.3.</span> <span class="nav-text">聚合函数(和分组搭配使用)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用法"><span class="nav-number">4.6.4.</span> <span class="nav-text">用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#having-和where的区别"><span class="nav-number">4.7.</span> <span class="nav-text">having 和where的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#is-null"><span class="nav-number">4.8.</span> <span class="nav-text">is null</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#判断是否是空"><span class="nav-number">4.8.1.</span> <span class="nav-text">判断是否是空</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#order-by-排序"><span class="nav-number">4.9.</span> <span class="nav-text">order by 排序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#asc升序-desc降序"><span class="nav-number">4.9.1.</span> <span class="nav-text">asc升序,desc降序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#limit-限制显示的条件限制显示条目"><span class="nav-number">4.10.</span> <span class="nav-text">limit 限制显示的条件限制显示条目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正则表达式"><span class="nav-number">4.11.</span> <span class="nav-text">正则表达式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#多表查询"><span class="nav-number">5.</span> <span class="nav-text">多表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建表"><span class="nav-number">5.1.</span> <span class="nav-text">创建表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#产生结果"><span class="nav-number">5.1.1.</span> <span class="nav-text">产生结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#笛卡尔积"><span class="nav-number">5.2.</span> <span class="nav-text">笛卡尔积</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#select-from-emp-dep"><span class="nav-number">5.2.1.</span> <span class="nav-text">select * from emp,dep;</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#内连接-只取两张表有对应关系的记录"><span class="nav-number">5.3.</span> <span class="nav-text">内连接: 只取两张表有对应关系的记录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#select-from-emp-inner-join-dep-on-emp-dep-id-dep-id"><span class="nav-number">5.3.1.</span> <span class="nav-text">select * from emp inner join dep on emp.dep_id = dep.id;</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#左连接-在内连接的基础上保留左表没有对应关系的记录"><span class="nav-number">5.4.</span> <span class="nav-text">左连接: 在内连接的基础上保留左表没有对应关系的记录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#select-from-emp-left-join-dep-on-emp-dep-id-dep-id"><span class="nav-number">5.4.1.</span> <span class="nav-text">select * from emp left join dep on emp.dep_id = dep.id;</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#右连接-在内连接的基础上保留右表没有对应关系的记录"><span class="nav-number">5.5.</span> <span class="nav-text">右连接: 在内连接的基础上保留右表没有对应关系的记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#全连接：在内连接的基础上保留左、右面表没有对应关系的的记录"><span class="nav-number">5.6.</span> <span class="nav-text">全连接：在内连接的基础上保留左、右面表没有对应关系的的记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子查询"><span class="nav-number">5.7.</span> <span class="nav-text">子查询</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mysql–用户相关"><span class="nav-number">6.</span> <span class="nav-text">Mysql–用户相关</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL用户操作"><span class="nav-number">6.1.</span> <span class="nav-text">MySQL用户操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建账号"><span class="nav-number">6.1.1.</span> <span class="nav-text">创建账号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除用户"><span class="nav-number">6.1.2.</span> <span class="nav-text">删除用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改密码"><span class="nav-number">6.1.3.</span> <span class="nav-text">修改密码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#root用户修改自己密码："><span class="nav-number">6.1.3.1.</span> <span class="nav-text">(root用户修改自己密码：)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#root修改其他用户密码："><span class="nav-number">6.1.3.2.</span> <span class="nav-text">root修改其他用户密码：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#普通用户修改自己密码："><span class="nav-number">6.1.3.3.</span> <span class="nav-text">普通用户修改自己密码：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#丢失root用户密码："><span class="nav-number">6.1.3.4.</span> <span class="nav-text">丢失root用户密码：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#修改用户名："><span class="nav-number">6.1.3.5.</span> <span class="nav-text">修改用户名：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL权限管理"><span class="nav-number">6.2.</span> <span class="nav-text">MySQL权限管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、跟权限有关的几张表"><span class="nav-number">6.2.1.</span> <span class="nav-text">1、跟权限有关的几张表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建账号并且授权"><span class="nav-number">6.2.2.</span> <span class="nav-text">创建账号并且授权</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#–语法格式："><span class="nav-number">6.2.2.1.</span> <span class="nav-text">–语法格式：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看权限"><span class="nav-number">6.2.3.</span> <span class="nav-text">查看权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#回收权限"><span class="nav-number">6.2.4.</span> <span class="nav-text">回收权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改权限之后一点要刷新"><span class="nav-number">6.2.5.</span> <span class="nav-text">修改权限之后一点要刷新</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#注解-flush-privileges："><span class="nav-number">6.2.5.1.</span> <span class="nav-text">注解 flush privileges：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#视图"><span class="nav-number">7.</span> <span class="nav-text">视图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-为什么使用视图"><span class="nav-number">7.0.1.</span> <span class="nav-text">1.为什么使用视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-创建视图"><span class="nav-number">7.0.2.</span> <span class="nav-text">2.创建视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-查看视图"><span class="nav-number">7.0.3.</span> <span class="nav-text">3.查看视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-删除视图"><span class="nav-number">7.0.4.</span> <span class="nav-text">4.删除视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-修改视图"><span class="nav-number">7.0.5.</span> <span class="nav-text">5.修改视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-利用视图操作基本表"><span class="nav-number">7.0.6.</span> <span class="nav-text">6.利用视图操作基本表</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mysql–内部"><span class="nav-number">8.</span> <span class="nav-text">Mysql–内部</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#触发器"><span class="nav-number">8.1.</span> <span class="nav-text">触发器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是触发器？"><span class="nav-number">8.1.1.</span> <span class="nav-text">什么是触发器？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#触发器的语法结构："><span class="nav-number">8.1.2.</span> <span class="nav-text">触发器的语法结构：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#建立一个表"><span class="nav-number">8.1.3.</span> <span class="nav-text">建立一个表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#建立一个要被触发的表"><span class="nav-number">8.1.4.</span> <span class="nav-text">建立一个要被触发的表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#建立触发器"><span class="nav-number">8.1.5.</span> <span class="nav-text">建立触发器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#插入数据"><span class="nav-number">8.1.6.</span> <span class="nav-text">插入数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除触发器"><span class="nav-number">8.1.7.</span> <span class="nav-text">删除触发器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#触发器案例研究"><span class="nav-number">8.1.8.</span> <span class="nav-text">触发器案例研究</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）建两张表-：一个商品goods表-一个订单order表"><span class="nav-number">8.1.8.1.</span> <span class="nav-text">(1）建两张表 ：一个商品goods表 一个订单order表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-创建触发器"><span class="nav-number">8.1.8.2.</span> <span class="nav-text">(2)创建触发器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#new和old的使用"><span class="nav-number">8.1.9.</span> <span class="nav-text">new和old的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#关键词new-的使用"><span class="nav-number">8.1.9.1.</span> <span class="nav-text">关键词new 的使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#关键词old-的使用："><span class="nav-number">8.1.9.2.</span> <span class="nav-text">关键词old 的使用：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#更新-update将之前下的订单撤销，再重新下订单"><span class="nav-number">8.1.9.3.</span> <span class="nav-text">更新 (update将之前下的订单撤销，再重新下订单)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看触发器"><span class="nav-number">8.1.10.</span> <span class="nav-text">查看触发器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除触发器-1"><span class="nav-number">8.1.11.</span> <span class="nav-text">删除触发器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#触发器的执行顺序"><span class="nav-number">8.1.12.</span> <span class="nav-text">触发器的执行顺序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一、存储过程"><span class="nav-number">8.2.</span> <span class="nav-text">一、存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方案"><span class="nav-number">8.2.1.</span> <span class="nav-text">方案</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#存储过程（Stored-Procedure）是"><span class="nav-number">8.2.2.</span> <span class="nav-text">　　存储过程（Stored Procedure）是</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#存储过程优点如下："><span class="nav-number">8.2.3.</span> <span class="nav-text">　　存储过程优点如下：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#存储过程简单语法："><span class="nav-number">8.2.4.</span> <span class="nav-text">　　存储过程简单语法：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、参数介绍示例"><span class="nav-number">8.3.</span> <span class="nav-text">二、参数介绍示例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#无参存储过程"><span class="nav-number">8.3.1.</span> <span class="nav-text">无参存储过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#有参存储过程"><span class="nav-number">8.3.2.</span> <span class="nav-text">有参存储过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pymysql调用存储过程"><span class="nav-number">8.3.3.</span> <span class="nav-text">pymysql调用存储过程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#事务"><span class="nav-number">9.</span> <span class="nav-text">事务</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pymysql模块"><span class="nav-number">10.</span> <span class="nav-text">pymysql模块</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#连接msyql"><span class="nav-number">10.1.</span> <span class="nav-text">连接msyql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#user-info插入列表里的数据增"><span class="nav-number">10.2.</span> <span class="nav-text">user_info插入列表里的数据增</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方法一"><span class="nav-number">10.2.1.</span> <span class="nav-text">方法一</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法二"><span class="nav-number">10.2.2.</span> <span class="nav-text">方法二</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除一条信息"><span class="nav-number">10.3.</span> <span class="nav-text">删除一条信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#更改信息"><span class="nav-number">10.4.</span> <span class="nav-text">更改信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查询语句"><span class="nav-number">10.5.</span> <span class="nav-text">查询语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查询语句把结果拿到"><span class="nav-number">10.6.</span> <span class="nav-text">查询语句把结果拿到</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#控制指针-有2种方式-这样就可以实现重复读取信息"><span class="nav-number">10.7.</span> <span class="nav-text">控制指针,有2种方式(这样就可以实现重复读取信息)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sql注入问题"><span class="nav-number">10.8.</span> <span class="nav-text">sql注入问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#–注入"><span class="nav-number">10.8.1.</span> <span class="nav-text">–注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#or注入"><span class="nav-number">10.8.2.</span> <span class="nav-text">or注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#黑客模拟客户端发送真正请求"><span class="nav-number">10.8.3.</span> <span class="nav-text">黑客模拟客户端发送真正请求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number">10.8.4.</span> <span class="nav-text">总结:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#索引"><span class="nav-number">11.</span> <span class="nav-text">索引</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#索引-1"><span class="nav-number">11.1.</span> <span class="nav-text">索引:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二-索引语法"><span class="nav-number">11.2.</span> <span class="nav-text">二 索引语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建索引"><span class="nav-number">11.2.1.</span> <span class="nav-text">创建索引</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#添加和删除索引"><span class="nav-number">11.3.</span> <span class="nav-text">添加和删除索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三-索引测试实验"><span class="nav-number">11.4.</span> <span class="nav-text">三 索引测试实验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#全部搞索引插入就会变慢"><span class="nav-number">11.4.1.</span> <span class="nav-text">全部搞索引插入就会变慢</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#基本函数"><span class="nav-number">12.</span> <span class="nav-text">基本函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、数学函数"><span class="nav-number">12.0.1.</span> <span class="nav-text">1、数学函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、聚合函数"><span class="nav-number">12.0.2.</span> <span class="nav-text">2、聚合函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、字符串函数"><span class="nav-number">12.0.3.</span> <span class="nav-text">3、字符串函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、日期和时间函数"><span class="nav-number">12.0.4.</span> <span class="nav-text">4、日期和时间函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、格式化函数"><span class="nav-number">12.0.5.</span> <span class="nav-text">5、格式化函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#学生选课系统表练习"><span class="nav-number">13.</span> <span class="nav-text">学生选课系统表练习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#设计表关系"><span class="nav-number">13.0.1.</span> <span class="nav-text">设计表关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建表和插入数据"><span class="nav-number">13.0.2.</span> <span class="nav-text">创建表和插入数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查询条件"><span class="nav-number">13.0.3.</span> <span class="nav-text">查询条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#答案"><span class="nav-number">13.0.4.</span> <span class="nav-text">答案</span></a></li></ol></li></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李江洋</span>

  

  
</div>


  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> 强力驱动 v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0Lm9yZw==">NexT.Pisces</span> v7.0.1</div>






  <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/7.1.2/mermaid.min.js"></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({theme: 'forest'});
    }
  </script>


        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>






















  
  
  <script id="ribbon" size="300" alpha="0.6" zindex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>





  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/bootstrap.js?v=7.0.1"></script>


  
  
  
  <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>


<script>
  var disqus_config = function() {
    this.page.url = "https://ljyabc.github.io/2019/03/19/数据库笔记2/";
    this.page.identifier = "2019/03/19/数据库笔记2/";
    this.page.title = '数据库笔记2';
    };
  function loadComments() {
    var d = document, s = d.createElement('script');
    s.src = 'https://.disqus.com/embed.js';
    s.setAttribute('data-timestamp', '' + +new Date());
    (d.head || d.body).appendChild(s);
  }
  
    loadComments();
  
</script>





  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  
  <script src="/js/src/exturl.js?v=7.0.1"></script>


  

  

   <!-- 代码块复制功能 -->
  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
</body>
</html>
